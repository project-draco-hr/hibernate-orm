{
  if (!settings.isScrollableResultSetsEnabled()) {
    throw new AssertionFailure("scrollable result sets are not enabled");
  }
  StatementPreparation prep=new QueryStatementPreparation(sql){
    @Override public PreparedStatement doPrepare() throws SQLException {
      return isCallable ? proxiedConnection.prepareCall(getSql(),scrollMode.toResultSetType(),ResultSet.CONCUR_READ_ONLY) : proxiedConnection.prepareStatement(getSql(),scrollMode.toResultSetType(),ResultSet.CONCUR_READ_ONLY);
    }
  }
;
  return prep.prepareAndPostProcess();
}
