{
  return new AccessCallback(){
    public IntegralDataTypeHolder getNextValue(){
      accessCounter++;
      try {
        PreparedStatement st=session.getJDBCContext().getConnectionManager().prepareSelectStatement(sql);
        try {
          ResultSet rs=st.executeQuery();
          try {
            rs.next();
            IntegralDataTypeHolder value=IdentifierGeneratorHelper.getIntegralDataTypeHolder(numberType);
            value.initialize(rs,1);
            LOG.debugf("Sequence value obtained: %s",value.makeValue());
            return value;
          }
  finally {
            try {
              rs.close();
            }
 catch (            Throwable ignore) {
            }
          }
        }
  finally {
          st.close();
        }
      }
 catch (      SQLException sqle) {
        throw session.getFactory().getSQLExceptionHelper().convert(sqle,"could not get next sequence value",sql);
      }
    }
  }
;
}
