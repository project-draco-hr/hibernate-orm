{
  LOG.debugf("Executing batch size: %s",batchPosition);
  try {
    for (    Map.Entry<String,PreparedStatement> entry : getStatements().entrySet()) {
      try {
        final PreparedStatement statement=entry.getValue();
        final int[] rowCounts;
        try {
          transactionContext().startBatchExecution();
          rowCounts=statement.executeBatch();
        }
  finally {
          transactionContext().endBatchExecution();
        }
        checkRowCounts(rowCounts,statement);
      }
 catch (      SQLException e) {
        abortBatch();
        throw sqlExceptionHelper().convert(e,"could not execute batch",entry.getKey());
      }
    }
  }
 catch (  RuntimeException re) {
    LOG.unableToExecuteBatch(re.getMessage());
    throw re;
  }
 finally {
    batchPosition=0;
  }
}
