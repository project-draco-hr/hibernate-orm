{
  try {
    String configLoc=ConfigurationHelper.getString(INFINISPAN_CONFIG_RESOURCE_PROP,properties,DEF_INFINISPAN_CONFIG_RESOURCE);
    ClassLoader ctxClassLoader=Thread.currentThread().getContextClassLoader();
    InputStream is=FileLookupFactory.newInstance().lookupFileStrict(configLoc,ctxClassLoader);
    ParserRegistry parserRegistry=new ParserRegistry(ctxClassLoader);
    ConfigurationBuilderHolder holder=parserRegistry.parse(is);
    String globalStats=extractProperty(INFINISPAN_GLOBAL_STATISTICS_PROP,properties);
    if (globalStats != null)     holder.getGlobalConfigurationBuilder().globalJmxStatistics().enabled(Boolean.parseBoolean(globalStats));
    return new DefaultCacheManager(holder,true);
  }
 catch (  IOException e) {
    throw new CacheException("Unable to create default cache manager",e);
  }
}
