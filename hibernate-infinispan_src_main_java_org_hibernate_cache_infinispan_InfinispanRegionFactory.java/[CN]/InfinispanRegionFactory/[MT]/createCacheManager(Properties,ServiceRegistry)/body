{
  if (properties.containsKey(INFINISPAN_USE_SYNCHRONIZATION_PROP)) {
    log.warn("Property '" + INFINISPAN_USE_SYNCHRONIZATION_PROP + "' is deprecated; 2LC with transactional cache must always use synchronizations.");
  }
  ConfigurationBuilderHolder cfgHolder;
  String configFile=ConfigurationHelper.extractPropertyValue(INFINISPAN_CONFIG_RESOURCE_PROP,properties);
  if (configFile != null) {
    cfgHolder=loadConfiguration(serviceRegistry,configFile);
  }
 else {
    cfgHolder=defaultConfiguration;
  }
  String globalStatsStr=extractProperty(INFINISPAN_GLOBAL_STATISTICS_PROP,properties);
  if (globalStatsStr != null) {
    globalStats=Boolean.parseBoolean(globalStatsStr);
  }
  if (globalStats != null) {
    cfgHolder.getGlobalConfigurationBuilder().globalJmxStatistics().enabled(globalStats);
  }
  return createCacheManager(cfgHolder);
}
