{
  TreeMap generators=new TreeMap();
  String defaultCatalog=properties.getProperty(Environment.DEFAULT_CATALOG);
  String defaultSchema=properties.getProperty(Environment.DEFAULT_SCHEMA);
  for (  PersistentClass pc : classes.values()) {
    if (!pc.isInherited()) {
      IdentifierGenerator ig=pc.getIdentifier().createIdentifierGenerator(getIdentifierGeneratorFactory(),dialect,defaultCatalog,defaultSchema,(RootClass)pc);
      if (ig instanceof PersistentIdentifierGenerator) {
        generators.put(((PersistentIdentifierGenerator)ig).generatorKey(),ig);
      }
 else       if (ig instanceof IdentifierGeneratorAggregator) {
        ((IdentifierGeneratorAggregator)ig).registerPersistentGenerators(generators);
      }
    }
  }
  for (  Collection collection : collections.values()) {
    if (collection.isIdentified()) {
      IdentifierGenerator ig=((IdentifierCollection)collection).getIdentifier().createIdentifierGenerator(getIdentifierGeneratorFactory(),dialect,defaultCatalog,defaultSchema,null);
      if (ig instanceof PersistentIdentifierGenerator) {
        generators.put(((PersistentIdentifierGenerator)ig).generatorKey(),ig);
      }
    }
  }
  return generators.values().iterator();
}
