{
  LOG.debugf("Preparing to build session factory with filters : %s",filterDefinitions);
  secondPassCompile();
  if (!metadataSourceQueue.isEmpty())   LOG.incompleteMappingMetadataCacheProcessing();
  enableLegacyHibernateValidator();
  enableBeanValidation();
  enableHibernateSearch();
  validate();
  Environment.verifyProperties(properties);
  Properties copy=new Properties();
  copy.putAll(properties);
  ConfigurationHelper.resolvePlaceHolders(copy);
  Settings settings=buildSettings(copy,serviceRegistry.getService(JdbcServices.class));
  return new SessionFactoryImpl(this,mapping,serviceRegistry,settings,getInitializedEventListeners(),sessionFactoryObserver);
}
