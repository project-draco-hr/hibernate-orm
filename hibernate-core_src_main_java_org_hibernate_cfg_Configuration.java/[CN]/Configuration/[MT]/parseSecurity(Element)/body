{
  final String nodeContextId=secNode.attributeValue("context");
  final String explicitContextId=getProperty(AvailableSettings.JACC_CONTEXT_ID);
  if (explicitContextId == null) {
    setProperty(AvailableSettings.JACC_CONTEXT_ID,nodeContextId);
    LOG.jaccContextId(nodeContextId);
  }
 else {
    if (!nodeContextId.equals(explicitContextId)) {
      throw new HibernateException("Non-matching JACC context ids");
    }
  }
  jaccPermissionDeclarations=new JaccPermissionDeclarations(nodeContextId);
  Iterator grantElements=secNode.elementIterator();
  while (grantElements.hasNext()) {
    final Element grantElement=(Element)grantElements.next();
    final String elementName=grantElement.getName();
    if ("grant".equals(elementName)) {
      jaccPermissionDeclarations.addPermissionDeclaration(new GrantedPermission(grantElement.attributeValue("role"),grantElement.attributeValue("entity-name"),grantElement.attributeValue("actions")));
    }
  }
}
