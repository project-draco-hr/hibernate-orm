{
  try {
    List errors=new ArrayList<SAXParseException>();
    Document document=xmlHelper.createSAXReader(resourceName,errors,entityResolver).read(new InputSource(stream));
    if (errors.size() != 0) {
      throw new MappingException("invalid configuration",(Throwable)errors.get(0));
    }
    doConfigure(document);
  }
 catch (  DocumentException e) {
    throw new HibernateException("Could not parse configuration: " + resourceName,e);
  }
 finally {
    try {
      stream.close();
    }
 catch (    IOException ioe) {
      LOG.unableToCloseInputStreamForResource(resourceName,ioe);
    }
  }
  return this;
}
