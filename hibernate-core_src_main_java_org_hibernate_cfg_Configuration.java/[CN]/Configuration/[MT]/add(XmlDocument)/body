{
  if (inSecondPass || !isOrmXml(metadataXml)) {
    metadataSourceQueue.add(metadataXml);
  }
 else {
    final MetadataProvider metadataProvider=((MetadataProviderInjector)reflectionManager).getMetadataProvider();
    JPAMetadataProvider jpaMetadataProvider=(JPAMetadataProvider)metadataProvider;
    List<String> classNames=jpaMetadataProvider.getXMLContext().addDocument(metadataXml.getDocumentTree());
    for (    String className : classNames) {
      try {
        metadataSourceQueue.add(reflectionManager.classForName(className,this.getClass()));
      }
 catch (      ClassNotFoundException e) {
        throw new AnnotationException("Unable to load class defined in XML: " + className,e);
      }
    }
    jpaMetadataProvider.getXMLContext().applyDiscoveredAttributeConverters(this);
  }
}
