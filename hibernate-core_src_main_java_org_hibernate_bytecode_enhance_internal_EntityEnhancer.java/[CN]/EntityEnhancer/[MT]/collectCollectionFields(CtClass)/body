{
  final List<CtField> collectionList=new LinkedList<CtField>();
  for (  CtField ctField : managedCtClass.getDeclaredFields()) {
    if (Modifier.isStatic(ctField.getModifiers()) || ctField.getName().startsWith("$$_hibernate_")) {
      continue;
    }
    if (enhancementContext.isPersistentField(ctField)) {
      if (PersistentAttributesHelper.isAssignable(ctField,Collection.class.getName()) || PersistentAttributesHelper.isAssignable(ctField,Map.class.getName())) {
        collectionList.add(ctField);
      }
    }
  }
  for (  CtField ctField : managedCtClass.getDeclaredFields()) {
    if (!ctField.getDeclaringClass().hasAnnotation(MappedSuperclass.class) || Modifier.isStatic(ctField.getModifiers())) {
      continue;
    }
    if (enhancementContext.isPersistentField(ctField)) {
      if (PersistentAttributesHelper.isAssignable(ctField,Collection.class.getName()) || PersistentAttributesHelper.isAssignable(ctField,Map.class.getName())) {
        collectionList.add(ctField);
      }
    }
  }
  return collectionList;
}
