{
  final Properties jndiProperties=new Properties();
  for (  Map.Entry entry : (Set<Map.Entry>)configurationValues.entrySet()) {
    if (!String.class.isInstance(entry.getKey())) {
      continue;
    }
    final String propertyName=(String)entry.getKey();
    final Object propertyValue=entry.getValue();
    if (propertyName.startsWith(Environment.JNDI_PREFIX)) {
      if (Environment.JNDI_CLASS.equals(propertyName)) {
        if (propertyValue != null) {
          jndiProperties.put(Context.INITIAL_CONTEXT_FACTORY,propertyValue);
        }
      }
 else       if (Environment.JNDI_URL.equals(propertyName)) {
        if (propertyValue != null) {
          jndiProperties.put(Context.PROVIDER_URL,propertyValue);
        }
      }
 else {
        final String passThruPropertyname=propertyName.substring(Environment.JNDI_PREFIX.length() + 1);
        jndiProperties.put(passThruPropertyname,propertyValue);
      }
    }
  }
  return jndiProperties;
}
