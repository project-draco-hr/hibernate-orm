{
  StandardServiceRegistry serviceRegistry=new StandardServiceRegistryBuilder().applySetting(AvailableSettings.DIALECT,SequenceDialect.class.getName()).build();
  try {
    Properties props=buildGeneratorPropertiesBase(serviceRegistry);
    props.setProperty(SequenceStyleGenerator.OPT_PARAM,StandardOptimizerDescriptor.NONE.getExternalName());
    props.setProperty(SequenceStyleGenerator.INCREMENT_PARAM,"20");
    SequenceStyleGenerator generator=new SequenceStyleGenerator();
    generator.configure(StandardBasicTypes.LONG,props,serviceRegistry);
    assertClassAssignability(SequenceStructure.class,generator.getDatabaseStructure().getClass());
    assertClassAssignability(NoopOptimizer.class,generator.getOptimizer().getClass());
    assertEquals(1,generator.getOptimizer().getIncrementSize());
    assertEquals(1,generator.getDatabaseStructure().getIncrementSize());
    props=buildGeneratorPropertiesBase(serviceRegistry);
    props.setProperty(SequenceStyleGenerator.OPT_PARAM,StandardOptimizerDescriptor.HILO.getExternalName());
    props.setProperty(SequenceStyleGenerator.INCREMENT_PARAM,"20");
    generator=new SequenceStyleGenerator();
    generator.configure(StandardBasicTypes.LONG,props,serviceRegistry);
    assertClassAssignability(SequenceStructure.class,generator.getDatabaseStructure().getClass());
    assertClassAssignability(HiLoOptimizer.class,generator.getOptimizer().getClass());
    assertEquals(20,generator.getOptimizer().getIncrementSize());
    assertEquals(20,generator.getDatabaseStructure().getIncrementSize());
    props=buildGeneratorPropertiesBase(serviceRegistry);
    props.setProperty(SequenceStyleGenerator.OPT_PARAM,StandardOptimizerDescriptor.POOLED.getExternalName());
    props.setProperty(SequenceStyleGenerator.INCREMENT_PARAM,"20");
    generator=new SequenceStyleGenerator();
    generator.configure(StandardBasicTypes.LONG,props,serviceRegistry);
    assertClassAssignability(TableStructure.class,generator.getDatabaseStructure().getClass());
    assertClassAssignability(PooledOptimizer.class,generator.getOptimizer().getClass());
    assertEquals(20,generator.getOptimizer().getIncrementSize());
    assertEquals(20,generator.getDatabaseStructure().getIncrementSize());
  }
  finally {
    StandardServiceRegistryBuilder.destroy(serviceRegistry);
  }
}
