{
  if (delayedCompletionHandling) {
    delayedCompletionHandling=false;
    doAfterCompletion(false);
    throw new HibernateException("Transaction was rolled back in a different thread!");
  }
}
