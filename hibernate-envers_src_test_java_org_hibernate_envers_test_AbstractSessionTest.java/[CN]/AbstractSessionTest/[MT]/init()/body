{
  config=new Configuration();
  URL url=Thread.currentThread().getContextClassLoader().getResource(getHibernateConfigurationFileName());
  config.configure(new File(url.toURI()));
  String auditStrategy=getAuditStrategy();
  if (auditStrategy != null && !"".equals(auditStrategy)) {
    config.setProperty("org.hibernate.envers.audit_strategy",auditStrategy);
  }
  config.setProperty(GlobalConfiguration.OVERRIDE_USING_MODIFIED_FLAG_PROPERTY,"true");
  config.setProperty(GlobalConfiguration.USING_MODIFIED_FLAG_PROPERTY,"true");
  this.initMappings();
  serviceRegistry=ServiceRegistryBuilder.buildServiceRegistry(config.getProperties());
  sessionFactory=config.buildSessionFactory(serviceRegistry);
}
