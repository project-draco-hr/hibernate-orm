{
  config=new Configuration();
  if (createSchema()) {
    config.setProperty(Environment.HBM2DDL_AUTO,"create-drop");
  }
  String auditStrategy=getAuditStrategy();
  if (auditStrategy != null && !"".equals(auditStrategy)) {
    config.setProperty("org.hibernate.envers.audit_strategy",auditStrategy);
  }
  this.initMappings();
  serviceRegistry=ServiceRegistryBuilder.buildServiceRegistry(config.getProperties());
  sessionFactory=config.buildSessionFactory(serviceRegistry);
}
