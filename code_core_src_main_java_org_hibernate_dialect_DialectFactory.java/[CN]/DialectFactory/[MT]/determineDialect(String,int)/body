{
  if (databaseName == null) {
    throw new HibernateException("Hibernate Dialect must be explicitly set");
  }
  DatabaseDialectMapper mapper=(DatabaseDialectMapper)MAPPERS.get(databaseName);
  if (mapper == null) {
    throw new HibernateException("Hibernate Dialect must be explicitly set for database: " + databaseName);
  }
  String dialectName=mapper.getDialectClass(databaseMajorVersion);
  return buildDialect(dialectName);
}
