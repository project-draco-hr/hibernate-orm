{
  String toEntityName;
  Serializable id;
  if (value instanceof HibernateProxy) {
    final HibernateProxy hibernateProxy=(HibernateProxy)value;
    toEntityName=session.bestGuessEntityName(value);
    id=hibernateProxy.getHibernateLazyInitializer().getIdentifier();
    value=EntityTools.getTargetFromProxy(session.getFactory(),hibernateProxy);
  }
 else {
    toEntityName=session.guessEntityName(value);
    final IdMapper idMapper=enversService.getEntitiesConfigurations().get(toEntityName).getIdMapper();
    id=(Serializable)idMapper.mapToIdFromEntity(value);
  }
  final Set<String> toPropertyNames=enversService.getEntitiesConfigurations().getToPropertyNames(fromEntityName,relDesc.getFromPropertyName(),toEntityName);
  final String toPropertyName=toPropertyNames.iterator().next();
  auditProcess.addWorkUnit(new CollectionChangeWorkUnit(session,toEntityName,toPropertyName,enversService,id,value));
}
