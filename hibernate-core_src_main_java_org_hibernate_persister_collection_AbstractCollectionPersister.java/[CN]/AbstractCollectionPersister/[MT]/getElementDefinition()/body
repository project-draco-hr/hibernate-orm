{
  return new CollectionElementDefinition(){
    @Override public CollectionDefinition getCollectionDefinition(){
      return AbstractCollectionPersister.this;
    }
    @Override public Type getType(){
      return getElementType();
    }
    @Override public EntityDefinition toEntityDefinition(){
      if (getType().isComponentType()) {
        throw new IllegalStateException("Cannot treat composite collection element type as entity");
      }
      return getElementPersister();
    }
    @Override public CompositionElementDefinition toCompositeElementDefinition(){
      final String propertyName=role.substring(entityName.length() + 1);
      final int propertyIndex=ownerPersister.getEntityMetamodel().getPropertyIndex(propertyName);
      if (!getType().isComponentType()) {
        throw new IllegalStateException("Cannot treat entity collection element type as composite");
      }
      return new CompositionElementDefinition(){
        @Override public String getName(){
          return "";
        }
        @Override public Type getType(){
          return getElementType();
        }
        @Override public AttributeSource getSource(){
          return getOwnerEntityPersister();
        }
        @Override public Iterable<AttributeDefinition> getAttributes(){
          return CompositionSingularSubAttributesHelper.getCompositionElementSubAttributes(this);
        }
        @Override public CollectionDefinition getCollectionDefinition(){
          return AbstractCollectionPersister.this;
        }
      }
;
    }
  }
;
}
