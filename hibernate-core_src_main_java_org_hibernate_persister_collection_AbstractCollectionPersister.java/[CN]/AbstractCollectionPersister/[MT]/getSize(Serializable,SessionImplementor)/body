{
  try {
    PreparedStatement st=session.getJDBCContext().getConnectionManager().prepareSelectStatement(sqlSelectSizeString);
    try {
      getKeyType().nullSafeSet(st,key,1,session);
      ResultSet rs=st.executeQuery();
      try {
        return rs.next() ? rs.getInt(1) - baseIndex : 0;
      }
  finally {
        rs.close();
      }
    }
  finally {
      st.close();
    }
  }
 catch (  SQLException sqle) {
    throw getFactory().getSQLExceptionHelper().convert(sqle,"could not retrieve collection size: " + MessageHelper.collectionInfoString(this,key,getFactory()),sqlSelectSizeString);
  }
}
