{
  if (log.isDebugEnabled()) {
    log.debugf("Building Return [isResultSet=%s, updateCount=%s, extendedReturn=%s",isResultSet(),getUpdateCount(),hasExtendedReturns(currentReturnState));
  }
  if (isResultSet()) {
    return new ResultSetReturnImpl(extractCurrentResults());
  }
 else   if (getUpdateCount() >= 0) {
    return new UpdateCountReturnImpl(updateCount);
  }
 else   if (hasExtendedReturns(currentReturnState)) {
    return buildExtendedReturn(currentReturnState);
  }
  throw new NoMoreReturnsException();
}
