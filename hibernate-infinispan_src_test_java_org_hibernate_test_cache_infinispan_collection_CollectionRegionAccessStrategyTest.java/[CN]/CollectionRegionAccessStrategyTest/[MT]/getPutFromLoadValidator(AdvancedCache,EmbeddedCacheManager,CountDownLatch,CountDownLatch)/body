{
  PutFromLoadValidator.removeFromCache(cache);
  InfinispanRegionFactory regionFactory=new InfinispanRegionFactory();
  regionFactory.setCacheManager(cm);
  regionFactory.start(CacheTestUtil.sfOptionsForStart(),new Properties());
  return new PutFromLoadValidator(cache,regionFactory,cm){
    @Override public Lock acquirePutFromLoadLock(    SharedSessionContractImplementor session,    Object key,    long txTimestamp){
      Lock lock=super.acquirePutFromLoadLock(session,key,txTimestamp);
      try {
        removeLatch.countDown();
        assertFalse(pferLatch.await(2,TimeUnit.SECONDS));
      }
 catch (      InterruptedException e) {
        log.debug("Interrupted");
        Thread.currentThread().interrupt();
      }
catch (      Exception e) {
        log.error("Error",e);
        throw new RuntimeException("Error",e);
      }
      return lock;
    }
  }
;
}
