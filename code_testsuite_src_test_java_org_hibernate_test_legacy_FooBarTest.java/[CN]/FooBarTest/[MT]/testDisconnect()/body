{
  Session s=openSession();
  Foo foo=new Foo();
  Foo foo2=new Foo();
  s.save(foo);
  s.save(foo2);
  foo2.setFoo(foo);
  s.flush();
  s.connection().commit();
  s.disconnect();
  s.reconnect();
  s.delete(foo);
  foo2.setFoo(null);
  s.flush();
  s.connection().commit();
  s.disconnect();
  s.reconnect();
  s.delete(foo2);
  s.flush();
  s.connection().commit();
  s.close();
}
