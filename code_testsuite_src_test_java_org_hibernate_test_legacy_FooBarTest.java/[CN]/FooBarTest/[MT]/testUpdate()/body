{
  Session s=openSession();
  Foo foo=new Foo();
  s.save(foo);
  s.flush();
  s.connection().commit();
  s.close();
  foo=(Foo)SerializationHelper.deserialize(SerializationHelper.serialize(foo));
  s=openSession();
  FooProxy foo2=(FooProxy)s.load(Foo.class,foo.getKey());
  foo2.setString("dirty");
  foo2.setBoolean(new Boolean(false));
  foo2.setBytes(new byte[]{1,2,3});
  foo2.setDate(null);
  foo2.setShort(new Short("69"));
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  foo2.setString("dirty again");
  s.update(foo2);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  foo2.setString("dirty again 2");
  s.update(foo2);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  Foo foo3=new Foo();
  s.load(foo3,foo.getKey());
  assertTrue("update",foo2.equalsFoo(foo3));
  s.delete(foo3);
  s.delete("from Glarch");
  s.flush();
  s.connection().commit();
  s.close();
}
