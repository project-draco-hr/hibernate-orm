{
  EntityManager em=getOrCreateEntityManager();
  em.getTransaction().begin();
  B b=new B();
  A a=new A();
  a.setB(b);
  try {
    em.persist(a);
    em.flush();
    em.getTransaction().commit();
    fail("should have raised an IllegalStateException");
  }
 catch (  IllegalStateException ex) {
  }
  em.close();
}
