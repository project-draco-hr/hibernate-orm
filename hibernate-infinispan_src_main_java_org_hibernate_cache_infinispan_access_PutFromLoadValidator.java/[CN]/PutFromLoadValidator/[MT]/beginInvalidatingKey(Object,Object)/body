{
  PendingPutMap pending=new PendingPutMap(null);
  PendingPutMap prev=pendingPuts.putIfAbsent(key,pending);
  if (prev != null) {
    pending=prev;
  }
  if (pending.acquireLock(60,TimeUnit.SECONDS)) {
    try {
      long now=System.currentTimeMillis();
      pending.invalidate(now,expirationPeriod);
      pending.addInvalidator(lockOwner,now,expirationPeriod);
    }
  finally {
      pending.releaseLock();
    }
    if (trace) {
      log.tracef("beginInvalidatingKey(%s#%s, %s) ends with %s",cache.getName(),key,lockOwner,pending);
    }
    return true;
  }
 else {
    log.tracef("beginInvalidatingKey(%s#%s, %s) failed to acquire lock",cache.getName(),key);
    return false;
  }
}
