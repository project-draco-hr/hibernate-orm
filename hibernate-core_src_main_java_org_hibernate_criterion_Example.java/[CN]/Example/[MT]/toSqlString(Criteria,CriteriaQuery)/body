{
  StringBuffer buf=new StringBuffer().append('(');
  EntityPersister meta=criteriaQuery.getFactory().getEntityPersister(criteriaQuery.getEntityName(criteria));
  String[] propertyNames=meta.getPropertyNames();
  Type[] propertyTypes=meta.getPropertyTypes();
  Object[] propertyValues=meta.getPropertyValues(entity);
  for (int i=0; i < propertyNames.length; i++) {
    Object propertyValue=propertyValues[i];
    String propertyName=propertyNames[i];
    boolean isPropertyIncluded=i != meta.getVersionProperty() && isPropertyIncluded(propertyValue,propertyName,propertyTypes[i]);
    if (isPropertyIncluded) {
      if (propertyTypes[i].isComponentType()) {
        appendComponentCondition(propertyName,propertyValue,(CompositeType)propertyTypes[i],criteria,criteriaQuery,buf);
      }
 else {
        appendPropertyCondition(propertyName,propertyValue,criteria,criteriaQuery,buf);
      }
    }
  }
  if (buf.length() == 1)   buf.append("1=1");
  return buf.append(')').toString();
}
