{
  boolean isJta=session.getFactory().getTransactionManager() != null;
  if (isJta) {
    new JtaDelegate(session).delegateWork(work,true);
  }
 else {
    new JdbcDelegate(session).delegateWork(work,true);
  }
}
