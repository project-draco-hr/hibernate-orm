{
  Session s=openSession();
  s.getTransaction().begin();
  VersionedCascadeOne one=new VersionedCascadeOne();
  assertNull(one.getManies());
  s.save(one);
  assertNull(one.getManies());
  EntityEntry eeOne=getEntityEntry(s,one);
  assertNull(eeOne.getLoadedValue("manies"));
  s.flush();
  assertNull(one.getManies());
  assertNull(eeOne.getLoadedValue("manies"));
  s.getTransaction().commit();
  s.close();
  final String role=VersionedCascadeOne.class.getName() + ".manies";
  s=openSession();
  s.getTransaction().begin();
  one=(VersionedCascadeOne)s.merge(one);
  assertNull(one.getManies());
  eeOne=getEntityEntry(s,one);
  AbstractPersistentCollection maniesEEOneStateOrig=(AbstractPersistentCollection)eeOne.getLoadedValue("manies");
  assertNotNull(maniesEEOneStateOrig);
  assertEquals(role,maniesEEOneStateOrig.getRole());
  assertEquals(one.getId(),maniesEEOneStateOrig.getKey());
  assertSame(s,maniesEEOneStateOrig.getSession());
  CollectionEntry ceManiesOrig=getCollectionEntry(s,maniesEEOneStateOrig);
  assertNotNull(ceManiesOrig);
  assertEquals(role,ceManiesOrig.getRole());
  assertSame(sessionFactory().getCollectionPersister(role),ceManiesOrig.getLoadedPersister());
  assertEquals(one.getId(),ceManiesOrig.getKey());
  s.flush();
  assertSame(eeOne,getEntityEntry(s,one));
  assertNull(one.getManies());
  assertNull(getCollectionEntry(s,maniesEEOneStateOrig));
  assertNull(ceManiesOrig.getRole());
  assertNull(ceManiesOrig.getLoadedPersister());
  assertNull(ceManiesOrig.getKey());
  assertNull(maniesEEOneStateOrig.getKey());
  assertNull(maniesEEOneStateOrig.getRole());
  assertNull(eeOne.getLoadedValue("manies"));
  assertNull(maniesEEOneStateOrig.getSession());
  s.getTransaction().commit();
  s.close();
}
