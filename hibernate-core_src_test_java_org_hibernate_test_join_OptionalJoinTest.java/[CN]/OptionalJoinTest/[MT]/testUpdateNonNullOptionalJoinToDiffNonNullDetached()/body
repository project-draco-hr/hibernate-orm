{
  Session s=openSession();
  Transaction t=s.beginTransaction();
  Thing thing=new Thing();
  thing.setName("one");
  s.save(thing);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  List things=s.createQuery("from Thing").list();
  assertEquals(1,things.size());
  thing=(Thing)things.get(0);
  assertEquals("one",thing.getName());
  assertEquals("ONE",thing.getNameUpper());
  t.commit();
  s.close();
  thing.setName("one_changed");
  s=openSession();
  t=s.beginTransaction();
  s.update(thing);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  things=s.createQuery("from Thing").list();
  assertEquals(1,things.size());
  thing=(Thing)things.get(0);
  assertEquals("one_changed",thing.getName());
  assertEquals("ONE_CHANGED",thing.getNameUpper());
  s.delete(thing);
  t.commit();
  s.close();
}
