{
  Session s=openSession();
  Category c=new Category();
  List list=new ArrayList();
  c.setSubcategories(list);
  list.add(new Category());
  c.setName("root");
  Serializable id=s.save(c);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  c=(Category)s.load(Category.class,id);
  s.refresh(c);
  s.flush();
  assertTrue(c.getSubcategories().size() == 1);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  c=(Category)s.load(Category.class,id);
  assertTrue(c.getSubcategories().size() == 1);
  s.delete(c);
  s.flush();
  s.connection().commit();
  s.close();
}
