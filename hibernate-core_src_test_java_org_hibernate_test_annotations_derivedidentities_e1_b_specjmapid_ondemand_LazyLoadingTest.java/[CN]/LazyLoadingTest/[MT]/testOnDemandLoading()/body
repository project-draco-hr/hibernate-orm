{
  Session s;
  Transaction tx;
  s=openSession();
  tx=s.beginTransaction();
  CustomerDemand cust=new CustomerDemand("John","Doe","123456","1.0",new BigDecimal(1),new BigDecimal(1),new BigDecimal(5));
  cust.setCredit("GOOD");
  s.persist(cust);
  ItemDemand item=new ItemDemand();
  item.setId("007");
  item.setName("widget");
  item.setDescription("FooBar");
  cust.addInventory(item,1,new BigDecimal(500));
  s.persist(item);
  s.persist(cust);
  s.flush();
  CustomerInventoryDemand eager=cust.getInventories().get(0);
  Integer lazyId=cust.getId();
  tx.commit();
  s.close();
  s=openSession();
  CustomerDemand lazyCustomer=(CustomerDemand)s.get(CustomerDemand.class,lazyId);
  assertNotNull(lazyCustomer);
  s.clear();
  List<CustomerInventoryDemand> inventories=lazyCustomer.getInventories();
  assertNotNull(inventories);
  assertTrue(inventories.contains(eager));
  assertEquals(1,inventories.size());
  assertEquals(cust.getCredit(),lazyCustomer.getCredit());
  CustomerInventoryDemand inv=inventories.get(0);
  assertNotNull(inv);
  assertEquals(inv.getQuantity(),1);
  assertEquals(inv.getVehicle().getDescription(),"FooBar");
  s.close();
}
