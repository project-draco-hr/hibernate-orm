{
  persistentClass.setAbstract(annotatedClass.isAbstract());
  persistentClass.setClassName(annotatedClass.getName());
  persistentClass.setJpaEntityName(name);
  persistentClass.setEntityName(annotatedClass.getName());
  bindDiscriminatorValue();
  persistentClass.setLazy(lazy);
  if (proxyClass != null) {
    persistentClass.setProxyInterfaceName(proxyClass.getName());
  }
  persistentClass.setDynamicInsert(dynamicInsert);
  persistentClass.setDynamicUpdate(dynamicUpdate);
  if (persistentClass instanceof RootClass) {
    RootClass rootClass=(RootClass)persistentClass;
    boolean mutable=true;
    if (annotatedClass.isAnnotationPresent(Immutable.class)) {
      mutable=false;
    }
 else {
      org.hibernate.annotations.Entity entityAnn=annotatedClass.getAnnotation(org.hibernate.annotations.Entity.class);
      if (entityAnn != null) {
        mutable=entityAnn.mutable();
      }
    }
    rootClass.setMutable(mutable);
    rootClass.setExplicitPolymorphism(isExplicitPolymorphism(polymorphismType));
    if (StringHelper.isNotEmpty(where))     rootClass.setWhere(where);
    if (cacheConcurrentStrategy != null) {
      rootClass.setCacheConcurrencyStrategy(cacheConcurrentStrategy);
      rootClass.setCacheRegionName(cacheRegion);
      rootClass.setLazyPropertiesCacheable(cacheLazyProperty);
    }
    rootClass.setNaturalIdCacheRegionName(naturalIdCacheRegion);
    boolean forceDiscriminatorInSelects=forceDiscriminator == null ? context.getBuildingOptions().shouldImplicitlyForceDiscriminatorInSelect() : forceDiscriminator;
    rootClass.setForceDiscriminator(forceDiscriminatorInSelects);
    if (insertableDiscriminator != null) {
      rootClass.setDiscriminatorInsertable(insertableDiscriminator);
    }
  }
 else {
    if (explicitHibernateEntityAnnotation) {
      LOG.entityAnnotationOnNonRoot(annotatedClass.getName());
    }
    if (annotatedClass.isAnnotationPresent(Immutable.class)) {
      LOG.immutableAnnotationOnNonRoot(annotatedClass.getName());
    }
  }
  persistentClass.setOptimisticLockStyle(getVersioning(optimisticLockType));
  persistentClass.setSelectBeforeUpdate(selectBeforeUpdate);
  Persister persisterAnn=annotatedClass.getAnnotation(Persister.class);
  Class persister=null;
  if (persisterAnn != null) {
    persister=persisterAnn.impl();
  }
 else {
    org.hibernate.annotations.Entity entityAnn=annotatedClass.getAnnotation(org.hibernate.annotations.Entity.class);
    if (entityAnn != null && !BinderHelper.isEmptyAnnotationValue(entityAnn.persister())) {
      try {
        persister=context.getClassLoaderAccess().classForName(entityAnn.persister());
      }
 catch (      ClassLoadingException e) {
        throw new AnnotationException("Could not find persister class: " + entityAnn.persister(),e);
      }
    }
  }
  if (persister != null) {
    persistentClass.setEntityPersisterClass(persister);
  }
  persistentClass.setBatchSize(batchSize);
  SQLInsert sqlInsert=annotatedClass.getAnnotation(SQLInsert.class);
  SQLUpdate sqlUpdate=annotatedClass.getAnnotation(SQLUpdate.class);
  SQLDelete sqlDelete=annotatedClass.getAnnotation(SQLDelete.class);
  SQLDeleteAll sqlDeleteAll=annotatedClass.getAnnotation(SQLDeleteAll.class);
  Loader loader=annotatedClass.getAnnotation(Loader.class);
  if (sqlInsert != null) {
    persistentClass.setCustomSQLInsert(sqlInsert.sql().trim(),sqlInsert.callable(),ExecuteUpdateResultCheckStyle.fromExternalName(sqlInsert.check().toString().toLowerCase(Locale.ROOT)));
  }
  if (sqlUpdate != null) {
    persistentClass.setCustomSQLUpdate(sqlUpdate.sql(),sqlUpdate.callable(),ExecuteUpdateResultCheckStyle.fromExternalName(sqlUpdate.check().toString().toLowerCase(Locale.ROOT)));
  }
  if (sqlDelete != null) {
    persistentClass.setCustomSQLDelete(sqlDelete.sql(),sqlDelete.callable(),ExecuteUpdateResultCheckStyle.fromExternalName(sqlDelete.check().toString().toLowerCase(Locale.ROOT)));
  }
  if (sqlDeleteAll != null) {
    persistentClass.setCustomSQLDelete(sqlDeleteAll.sql(),sqlDeleteAll.callable(),ExecuteUpdateResultCheckStyle.fromExternalName(sqlDeleteAll.check().toString().toLowerCase(Locale.ROOT)));
  }
  if (loader != null) {
    persistentClass.setLoaderName(loader.namedQuery());
  }
  final JdbcEnvironment jdbcEnvironment=context.getMetadataCollector().getDatabase().getJdbcEnvironment();
  if (annotatedClass.isAnnotationPresent(Synchronize.class)) {
    Synchronize synchronizedWith=annotatedClass.getAnnotation(Synchronize.class);
    String[] tables=synchronizedWith.value();
    for (    String table : tables) {
      persistentClass.addSynchronizedTable(context.getBuildingOptions().getPhysicalNamingStrategy().toPhysicalTableName(jdbcEnvironment.getIdentifierHelper().toIdentifier(table),jdbcEnvironment).render(jdbcEnvironment.getDialect()));
    }
  }
  if (annotatedClass.isAnnotationPresent(Subselect.class)) {
    Subselect subselect=annotatedClass.getAnnotation(Subselect.class);
    this.subselect=subselect.value();
  }
  if (annotatedClass.isAnnotationPresent(Tuplizers.class)) {
    for (    Tuplizer tuplizer : annotatedClass.getAnnotation(Tuplizers.class).value()) {
      EntityMode mode=EntityMode.parse(tuplizer.entityMode());
      persistentClass.addTuplizer(mode,tuplizer.impl().getName());
    }
  }
  if (annotatedClass.isAnnotationPresent(Tuplizer.class)) {
    Tuplizer tuplizer=annotatedClass.getAnnotation(Tuplizer.class);
    EntityMode mode=EntityMode.parse(tuplizer.entityMode());
    persistentClass.addTuplizer(mode,tuplizer.impl().getName());
  }
  for (  Filter filter : filters) {
    String filterName=filter.name();
    String cond=filter.condition();
    if (BinderHelper.isEmptyAnnotationValue(cond)) {
      FilterDefinition definition=context.getMetadataCollector().getFilterDefinition(filterName);
      cond=definition == null ? null : definition.getDefaultFilterCondition();
      if (StringHelper.isEmpty(cond)) {
        throw new AnnotationException("no filter condition found for filter " + filterName + " in "+ this.name);
      }
    }
    persistentClass.addFilter(filterName,cond,filter.deduceAliasInjectionPoints(),toAliasTableMap(filter.aliases()),toAliasEntityMap(filter.aliases()));
  }
  LOG.debugf("Import with entity name %s",name);
  try {
    context.getMetadataCollector().addImport(name,persistentClass.getEntityName());
    String entityName=persistentClass.getEntityName();
    if (!entityName.equals(name)) {
      context.getMetadataCollector().addImport(entityName,entityName);
    }
  }
 catch (  MappingException me) {
    throw new AnnotationException("Use of the same entity name twice: " + name,me);
  }
  processNamedEntityGraphs();
}
