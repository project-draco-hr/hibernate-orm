{
  if (userSuppliedConnection != null) {
    this.logicalConnection=new LogicalConnectionProvidedImpl(userSuppliedConnection);
    this.isUserSuppliedConnection=true;
  }
 else {
    this.logicalConnection=new LogicalConnectionManagedImpl(owner.getJdbcConnectionAccess(),owner.getJdbcSessionContext());
    this.isUserSuppliedConnection=false;
  }
  this.connectionReleaseMode=determineConnectionReleaseMode(owner.getJdbcConnectionAccess(),isUserSuppliedConnection,owner.getJdbcSessionContext().getConnectionReleaseMode());
  this.owner=owner;
  this.exceptionHelper=owner.getJdbcSessionContext().getServiceRegistry().getService(JdbcServices.class).getSqlExceptionHelper();
}
