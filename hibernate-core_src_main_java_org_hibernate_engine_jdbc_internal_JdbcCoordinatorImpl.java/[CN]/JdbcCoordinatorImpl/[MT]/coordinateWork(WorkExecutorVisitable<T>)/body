{
  Connection connection=getLogicalConnection().getDistinctConnectionProxy();
  try {
    T result=work.accept(new WorkExecutor<T>(),connection);
    getLogicalConnection().afterStatementExecution();
    return result;
  }
 catch (  SQLException e) {
    throw sqlExceptionHelper().convert(e,"error executing work");
  }
 finally {
    try {
      if (!connection.isClosed()) {
        connection.close();
      }
    }
 catch (    SQLException e) {
      LOG.debug("Error closing connection proxy",e);
    }
  }
}
