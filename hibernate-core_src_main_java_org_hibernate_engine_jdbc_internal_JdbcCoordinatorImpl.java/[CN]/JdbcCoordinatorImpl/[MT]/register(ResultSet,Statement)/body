{
  if (statement == null) {
    try {
      statement=resultSet.getStatement();
    }
 catch (    SQLException e) {
      throw exceptionHelper.convert(e,"unable to access statement from resultset");
    }
  }
  if (statement != null) {
    LOG.tracev("Registering result set [{0}]",resultSet);
    final Set<ResultSet> resultSets=xref.get(statement);
    if (resultSets == null) {
      LOG.unregisteredStatement();
    }
    if (resultSets == null || resultSets == EMPTY_RESULTSET) {
      xref.put(statement,new HashSet<ResultSet>());
    }
 else {
      resultSets.add(resultSet);
    }
  }
 else {
    unassociatedResultSets.add(resultSet);
  }
}
