{
  Session s=openSession();
  Transaction t=s.beginTransaction();
  C1 c1=new C1();
  D d=new D();
  d.setAmount(213.34f);
  c1.setAddress("foo bar");
  c1.setCount(23432);
  c1.setName("c1");
  c1.setBName("a funny name");
  c1.setD(d);
  s.save(c1);
  d.setId(c1.getId());
  s.save(d);
  assertTrue(s.createQuery("from C2 c where 1=1 or 1=1").list().size() == 0);
  t.commit();
  s.close();
  getSessions().evict(A.class);
  s=openSession();
  t=s.beginTransaction();
  c1=(C1)s.get(A.class,c1.getId());
  assertTrue(c1.getAddress().equals("foo bar") && (c1.getCount() == 23432) && c1.getName().equals("c1")&& c1.getD().getAmount() > 213.3f);
  assertEquals("a funny name",c1.getBName());
  t.commit();
  s.close();
  getSessions().evict(A.class);
  s=openSession();
  t=s.beginTransaction();
  c1=(C1)s.get(B.class,c1.getId());
  assertTrue(c1.getAddress().equals("foo bar") && (c1.getCount() == 23432) && c1.getName().equals("c1")&& c1.getD().getAmount() > 213.3f);
  assertEquals("a funny name",c1.getBName());
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  c1=(C1)s.load(C1.class,c1.getId());
  assertTrue(c1.getAddress().equals("foo bar") && (c1.getCount() == 23432) && c1.getName().equals("c1")&& c1.getD().getAmount() > 213.3f);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  List bs=s.createQuery("from B").list();
  for (int i=0; i < bs.size(); i++) {
    C1 b=(C1)bs.get(i);
    s.delete(b);
    s.delete(b.getD());
  }
  t.commit();
  s.close();
}
