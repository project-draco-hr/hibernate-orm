{
  StringBuffer buf=new StringBuffer(tableName.length() + 10);
  if (comment != null) {
    buf.append("/* ").append(comment).append(" */ ");
  }
  buf.append("delete from ").append(tableName);
  if (where != null || primaryKeyColumnNames != null || versionColumnName != null) {
    buf.append(" where ");
  }
  boolean conditionsAppended=false;
  if (primaryKeyColumnNames != null) {
    buf.append(StringHelper.join("=? and ",primaryKeyColumnNames)).append("=?");
    conditionsAppended=true;
  }
  if (where != null) {
    if (conditionsAppended) {
      buf.append(" and ");
    }
    buf.append(where);
    conditionsAppended=true;
  }
  if (versionColumnName != null) {
    if (conditionsAppended) {
      buf.append(" and ");
    }
    buf.append(versionColumnName).append("=?");
  }
  return buf.toString();
}
