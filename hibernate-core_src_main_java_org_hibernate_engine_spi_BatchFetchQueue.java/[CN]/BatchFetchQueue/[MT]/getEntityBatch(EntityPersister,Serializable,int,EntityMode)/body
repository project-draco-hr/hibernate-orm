{
  Serializable[] ids=new Serializable[batchSize];
  ids[0]=id;
  int i=1;
  int end=-1;
  boolean checkForEnd=false;
  LinkedHashSet<EntityKey> set=batchLoadableEntityKeys.get(persister.getEntityName());
  if (set != null) {
    for (    EntityKey key : set) {
      if (checkForEnd && i == end) {
        return ids;
      }
      if (persister.getIdentifierType().isEqual(id,key.getIdentifier())) {
        end=i;
      }
 else {
        if (!isCached(key,persister)) {
          ids[i++]=key.getIdentifier();
        }
      }
      if (i == batchSize) {
        i=1;
        if (end != -1) {
          checkForEnd=true;
        }
      }
    }
  }
  return ids;
}
