{
  Session s=openSession();
  Transaction t=s.beginTransaction();
  Thing thing=new Thing();
  thing.setName("one");
  s.save(thing);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  List things=s.createQuery("from Thing").list();
  assertEquals(1,things.size());
  thing=(Thing)things.get(0);
  assertEquals("one",thing.getName());
  t.commit();
  s.close();
  thing.setName(null);
  s=openSession();
  t=s.beginTransaction();
  s.merge(thing);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  things=s.createQuery("from Thing").list();
  assertEquals(1,things.size());
  thing=(Thing)things.get(0);
  assertNull(thing.getName());
  s.delete(thing);
  t.commit();
  s.close();
}
