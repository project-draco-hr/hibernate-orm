{
  XClass xclass=annotatedClass;
  while (xclass != null && !Object.class.getName().equals(xclass.getName())) {
    if (xclass.isAnnotationPresent(Entity.class) || xclass.isAnnotationPresent(MappedSuperclass.class)) {
      for (      XProperty prop : xclass.getDeclaredProperties(AccessType.PROPERTY.getType())) {
        if (prop.isAnnotationPresent(Id.class) || prop.isAnnotationPresent(EmbeddedId.class)) {
          return AccessType.PROPERTY;
        }
      }
      for (      XProperty prop : xclass.getDeclaredProperties(AccessType.FIELD.getType())) {
        if (prop.isAnnotationPresent(Id.class) || prop.isAnnotationPresent(EmbeddedId.class)) {
          return AccessType.FIELD;
        }
      }
    }
    xclass=xclass.getSuperclass();
  }
  throw new AnnotationException("No identifier specified for entity: " + annotatedClass.getName());
}
