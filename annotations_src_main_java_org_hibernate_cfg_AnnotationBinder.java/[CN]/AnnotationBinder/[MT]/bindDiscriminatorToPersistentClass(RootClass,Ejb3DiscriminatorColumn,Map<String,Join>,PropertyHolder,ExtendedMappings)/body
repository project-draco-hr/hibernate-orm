{
  if (rootClass.getDiscriminator() == null) {
    if (discriminatorColumn == null) {
      throw new AssertionFailure("discriminator column should have been built");
    }
    discriminatorColumn.setJoins(secondaryTables);
    discriminatorColumn.setPropertyHolder(propertyHolder);
    SimpleValue discrim=new SimpleValue(mappings,rootClass.getTable());
    rootClass.setDiscriminator(discrim);
    discriminatorColumn.linkWithValue(discrim);
    discrim.setTypeName(discriminatorColumn.getDiscriminatorTypeName());
    rootClass.setPolymorphic(true);
    log.trace("Setting discriminator for entity {}",rootClass.getEntityName());
  }
}
