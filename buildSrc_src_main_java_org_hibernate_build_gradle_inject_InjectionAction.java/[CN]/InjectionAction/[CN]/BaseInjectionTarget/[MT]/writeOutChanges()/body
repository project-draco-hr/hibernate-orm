{
  log.info("writing injection changes back [" + classFileLocation.getAbsolutePath() + "]");
  long timeStamp=classFileLocation.lastModified();
  ClassFile classFile=ctClass.getClassFile();
  classFile.compact();
  try {
    DataOutputStream out=new DataOutputStream(new BufferedOutputStream(new FileOutputStream(classFileLocation)));
    try {
      classFile.write(out);
      out.flush();
      if (!classFileLocation.setLastModified(System.currentTimeMillis())) {
        log.info("Unable to manually update class file timestamp");
      }
    }
  finally {
      out.close();
      classFileLocation.setLastModified(timeStamp);
    }
  }
 catch (  IOException e) {
    throw new InjectionException("Unable to write out modified class file",e);
  }
}
