{
  String batcherClass=properties.getProperty(Environment.BATCH_STRATEGY);
  BatcherFactory batcherFactory=null;
  if (batcherClass == null) {
    batcherFactory=batchSize == 0 ? new NonBatchingBatcherFactory() : new BatchingBatcherFactory();
  }
 else {
    log.info("Batcher factory: " + batcherClass);
    try {
      batcherFactory=(BatcherFactory)ReflectHelper.classForName(batcherClass).newInstance();
    }
 catch (    Exception cnfe) {
      throw new HibernateException("could not instantiate BatcherFactory: " + batcherClass,cnfe);
    }
  }
  batcherFactory.setJdbcBatchSize(batchSize);
  return batcherFactory;
}
