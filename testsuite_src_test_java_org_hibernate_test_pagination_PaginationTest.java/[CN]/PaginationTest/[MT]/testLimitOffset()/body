{
  if (!getDialect().supportsLimitOffset()) {
    reportSkip("Dialect does not support limit+offset");
    return;
  }
  prepareTestData();
  Session session=openSession();
  session.beginTransaction();
  List result;
  result=generateBaseHQLQuery(session).setFirstResult(0).setMaxResults(20).list();
  assertEquals(20,result.size());
  assertEquals(0,((DataPoint)result.get(0)).getSequence());
  assertEquals(1,((DataPoint)result.get(1)).getSequence());
  result=generateBaseCriteria(session).setFirstResult(1).setMaxResults(20).list();
  assertEquals(20,result.size());
  assertEquals(1,((DataPoint)result.get(0)).getSequence());
  assertEquals(2,((DataPoint)result.get(1)).getSequence());
  result=generateBaseCriteria(session).setFirstResult(99).setMaxResults(Integer.MAX_VALUE).list();
  assertEquals(1,result.size());
  assertEquals(99,((DataPoint)result.get(0)).getSequence());
  session.getTransaction().commit();
  session.close();
  cleanupTestData();
}
