{
  checkOpen();
  if (!isTransactionInProgress()) {
    throw new TransactionRequiredException("Call to EntityManager#getLockMode should occur within transaction according to spec");
  }
  if (!contains(entity)) {
    throw convert(new IllegalArgumentException("entity not in the persistence context"));
  }
  return getLockModeType(internalGetSession().getCurrentLockMode(entity));
}
