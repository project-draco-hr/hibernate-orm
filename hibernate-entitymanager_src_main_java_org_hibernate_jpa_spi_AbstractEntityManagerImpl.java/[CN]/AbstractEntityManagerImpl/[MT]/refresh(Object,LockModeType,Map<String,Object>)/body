{
  checkOpen();
  checkTransactionNeeded();
  Session session=internalGetSession();
  CacheMode previousCacheMode=session.getCacheMode();
  CacheMode localCacheMode=determineAppropriateLocalCacheMode(properties);
  LockOptions lockOptions=null;
  try {
    session.setCacheMode(localCacheMode);
    if (!session.contains(entity)) {
      throw new IllegalArgumentException("Entity not managed");
    }
    if (lockModeType != null) {
      lockOptions=getLockRequest(lockModeType,properties);
      session.refresh(entity,lockOptions);
    }
 else {
      session.refresh(entity);
    }
  }
 catch (  MappingException e) {
    throw new IllegalArgumentException(e.getMessage(),e);
  }
catch (  HibernateException he) {
    throw convert(he,lockOptions);
  }
 finally {
    session.setCacheMode(previousCacheMode);
  }
}
