{
synchronized (regionRootMutex) {
    if (regionRoot != null && regionRoot.isValid()) {
      return;
    }
    if (!optimistic) {
      regionRoot=jbcCache.getRoot().getChild(regionFqn);
      return;
    }
    Transaction tx=suspend();
    Node newRoot=null;
    try {
      newRoot=jbcCache.getRoot().getChild(regionFqn);
      if (newRoot == null || !newRoot.isValid()) {
        DataVersion version=optimistic ? NonLockingDataVersion.INSTANCE : null;
        newRoot=CacheHelper.addNode(jbcCache,regionFqn,true,true,version);
      }
 else       if (newRoot instanceof NodeSPI) {
        if (!(((NodeSPI)newRoot).getVersion() instanceof NonLockingDataVersion)) {
          ((NodeSPI)newRoot).setVersion(NonLockingDataVersion.INSTANCE);
        }
      }
      newRoot.setResident(true);
    }
  finally {
      resume(tx);
      regionRoot=newRoot;
    }
  }
}
