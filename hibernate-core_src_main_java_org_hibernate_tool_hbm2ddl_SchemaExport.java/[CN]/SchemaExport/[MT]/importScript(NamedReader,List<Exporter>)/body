{
  BufferedReader reader=new BufferedReader(namedReader.getReader());
  String[] statements=importSqlCommandExtractor.extractCommands(reader);
  if (statements != null) {
    for (    String statement : statements) {
      if (statement != null) {
        String trimmedSql=statement.trim();
        if (trimmedSql.endsWith(";")) {
          trimmedSql=trimmedSql.substring(0,statement.length() - 1);
        }
        if (!StringHelper.isEmpty(trimmedSql)) {
          try {
            for (            Exporter exporter : exporters) {
              if (exporter.acceptsImportScripts()) {
                exporter.export(trimmedSql);
              }
            }
          }
 catch (          Exception e) {
            if (haltOnError) {
              throw new ImportScriptException("Error during statement execution (file: '" + namedReader.getName() + "'): "+ trimmedSql,e);
            }
            exceptions.add(e);
            LOG.unsuccessful(trimmedSql);
            LOG.error(e.getMessage());
          }
        }
      }
    }
  }
}
