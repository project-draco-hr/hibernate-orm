{
  final Dialect dialect=Dialect.getDialect(properties);
  Properties props=new Properties();
  props.putAll(dialect.getDefaultProperties());
  props.putAll(properties);
  this.connectionHelper=new ManagedProviderConnectionHelper(props);
  this.sqlStatementLogger=new SqlStatementLogger(false,true);
  this.formatter=FormatStyle.DDL.getFormatter();
  this.sqlExceptionHelper=new SqlExceptionHelper();
  this.importFiles=ConfigurationHelper.getString(AvailableSettings.HBM2DDL_IMPORT_FILES,properties,DEFAULT_IMPORT_FILE);
  this.dropSQL=configuration.generateDropSchemaScript(dialect);
  this.createSQL=configuration.generateSchemaCreationScript(dialect);
  this.serviceRegistry=createServiceRegistry(props);
}
