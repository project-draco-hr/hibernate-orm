{
  HqlSqlWalker w=new HqlSqlWalker(this,factory,parser,tokenReplacements,collectionRole);
  AST hqlAst=parser.getAST();
  w.statement(hqlAst);
  if (LOG.isDebugEnabled()) {
    ASTPrinter printer=new ASTPrinter(SqlTokenTypes.class);
    LOG.debugf(printer.showAsString(w.getAST(),"--- SQL AST ---"));
  }
  w.getParseErrorHandler().throwQueryException();
  return w;
}
