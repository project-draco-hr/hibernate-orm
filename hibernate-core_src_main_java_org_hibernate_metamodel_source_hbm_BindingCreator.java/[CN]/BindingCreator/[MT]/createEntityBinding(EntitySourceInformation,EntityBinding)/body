{
  if (processedEntityNames.contains(entitySourceInfo.getMappedEntityName())) {
    return metadata.getEntityBinding(entitySourceInfo.getMappedEntityName());
  }
  currentBindingContext=entitySourceInfo.getSourceMappingDocument().getMappingLocalBindingContext();
  try {
    final EntityBinding entityBinding=doCreateEntityBinding(entitySourceInfo,superEntityBinding);
    metadata.addEntity(entityBinding);
    processedEntityNames.add(entityBinding.getEntity().getName());
    return entityBinding;
  }
  finally {
    currentBindingContext=null;
  }
}
