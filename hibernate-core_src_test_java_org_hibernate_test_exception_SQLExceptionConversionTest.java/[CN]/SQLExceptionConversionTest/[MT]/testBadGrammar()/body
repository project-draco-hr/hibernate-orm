{
  Session session=openSession();
  session.beginTransaction();
  session.doWork(new Work(){
    @Override public void execute(    Connection connection) throws SQLException {
      PreparedStatement ps=null;
      try {
        ps=connection.prepareStatement("SELECT user_id, user_name FROM tbl_no_there");
        ps.executeQuery();
        fail("SQL compilation should have failed");
      }
 catch (      SQLGrammarException ignored) {
      }
 finally {
        if (ps != null) {
          try {
            ps.close();
          }
 catch (          Throwable ignore) {
          }
        }
      }
    }
  }
);
  session.getTransaction().rollback();
  session.close();
}
