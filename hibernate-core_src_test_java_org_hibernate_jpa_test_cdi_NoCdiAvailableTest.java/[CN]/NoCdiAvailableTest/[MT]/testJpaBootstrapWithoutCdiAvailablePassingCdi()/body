{
  Class delegateClass=Thread.currentThread().getContextClassLoader().loadClass("org.hibernate.jpa.test.cdi.NoCdiAvailableTestDelegate");
  Method mainMethod=delegateClass.getMethod("passingBeanManager");
  EntityManagerFactory entityManagerFactory=null;
  try {
    entityManagerFactory=(EntityManagerFactory)mainMethod.invoke(null);
    fail("Expecting failure from missing CDI classes");
  }
 catch (  InvocationTargetException expected) {
  }
 finally {
    if (entityManagerFactory != null) {
      entityManagerFactory.close();
    }
  }
}
