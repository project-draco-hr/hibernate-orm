{
  if (maxLo < 1) {
    int val=((Integer)doWorkInNewTransaction(session)).intValue();
    if (val == 0)     val=((Integer)doWorkInNewTransaction(session)).intValue();
    return IdentifierGeneratorFactory.createNumber(val,returnClass);
  }
  if (lo > maxLo) {
    int hival=((Integer)doWorkInNewTransaction(session)).intValue();
    lo=(hival == 0) ? 1 : 0;
    hi=hival * (maxLo + 1);
    log.debug("new hi value: " + hival);
  }
  return IdentifierGeneratorFactory.createNumber(hi + lo++,returnClass);
}
