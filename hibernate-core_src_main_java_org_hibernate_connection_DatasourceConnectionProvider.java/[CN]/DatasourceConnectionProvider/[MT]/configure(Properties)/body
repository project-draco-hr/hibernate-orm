{
  String jndiName=props.getProperty(Environment.DATASOURCE);
  if (jndiName == null) {
    String msg="datasource JNDI name was not specified by property " + Environment.DATASOURCE;
    LOG.unspecifiedJndiName(msg);
    throw new HibernateException(msg);
  }
  user=props.getProperty(Environment.USER);
  pass=props.getProperty(Environment.PASS);
  try {
    ds=(DataSource)JndiHelper.getInitialContext(props).lookup(jndiName);
  }
 catch (  Exception e) {
    LOG.datasourceNotFound(jndiName,e.getMessage());
    throw new HibernateException("Could not find datasource",e);
  }
  if (ds == null) {
    throw new HibernateException("Could not find datasource: " + jndiName);
  }
  LOG.usingDatasource(jndiName);
}
