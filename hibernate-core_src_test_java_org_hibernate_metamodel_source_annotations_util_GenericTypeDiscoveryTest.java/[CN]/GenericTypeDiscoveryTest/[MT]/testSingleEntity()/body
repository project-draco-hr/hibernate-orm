{
  Index index=JandexHelper.indexForClass(service,Paper.class,Stuff.class,Item.class,PricedStuff.class);
  Set<ConfiguredClassHierarchy> hierarchies=ConfiguredClassHierarchyBuilder.createEntityHierarchies(index,serviceRegistry);
  assertEquals("There should be only one hierarchy",1,hierarchies.size());
  Iterator<ConfiguredClass> iter=hierarchies.iterator().next().iterator();
  ConfiguredClass configuredClass=iter.next();
  ClassInfo info=configuredClass.getClassInfo();
  assertEquals("wrong class",DotName.createSimple(Stuff.class.getName()),info.name());
  List<MappedProperty> mappedProperties=configuredClass.getMappedProperties();
  assertTrue("Stuff should have one mapped property",mappedProperties.size() == 1);
  MappedProperty property=mappedProperties.get(0);
  assertEquals(Price.class,property.getType());
  assertTrue(iter.hasNext());
  configuredClass=iter.next();
  info=configuredClass.getClassInfo();
  assertEquals("wrong class",DotName.createSimple(PricedStuff.class.getName()),info.name());
  mappedProperties=configuredClass.getMappedProperties();
  assertTrue("PricedStuff should not mapped properties",mappedProperties.size() == 0);
  assertTrue(iter.hasNext());
  configuredClass=iter.next();
  info=configuredClass.getClassInfo();
  assertEquals("wrong class",DotName.createSimple(Item.class.getName()),info.name());
  mappedProperties=configuredClass.getMappedProperties();
  assertTrue("Item should have 4 mapped properties",mappedProperties.size() == 4);
  property=mappedProperties.get(2);
  assertEquals(SomeGuy.class,property.getType());
  property=mappedProperties.get(3);
  assertEquals(PaperType.class,property.getType());
  assertTrue(iter.hasNext());
  configuredClass=iter.next();
  info=configuredClass.getClassInfo();
  assertEquals("wrong class",DotName.createSimple(Paper.class.getName()),info.name());
  mappedProperties=configuredClass.getMappedProperties();
  assertTrue("Paper should not mapped properties",mappedProperties.size() == 0);
  assertFalse(iter.hasNext());
}
