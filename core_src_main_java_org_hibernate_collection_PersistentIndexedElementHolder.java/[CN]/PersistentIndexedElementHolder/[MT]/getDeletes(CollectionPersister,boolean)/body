{
  final Type indexType=persister.getIndexType();
  HashMap snapshot=(HashMap)getSnapshot();
  HashMap deletes=(HashMap)snapshot.clone();
  deletes.keySet().removeAll(((HashMap)getSnapshot(persister)).keySet());
  ArrayList deleteList=new ArrayList(deletes.size());
  for (  Object o : deletes.entrySet()) {
    Map.Entry me=(Map.Entry)o;
    final Object object=indexIsFormula ? me.getValue() : ((XmlRepresentableType)indexType).fromXMLString((String)me.getKey(),persister.getFactory());
    if (object != null) {
      deleteList.add(object);
    }
  }
  return deleteList.iterator();
}
