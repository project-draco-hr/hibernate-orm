{
  try {
    org.hibernate.Query namedQuery=getSession().getNamedQuery(name);
    try {
      if (namedQuery.getReturnTypes().length != 1) {
        throw new IllegalArgumentException("Cannot create TypedQuery for query with more than one return");
      }
      if (!resultClass.isAssignableFrom(namedQuery.getReturnTypes()[0].getReturnedClass())) {
        throw new IllegalArgumentException("Type specified for TypedQuery [" + resultClass.getName() + "] is incompatible with query return type ["+ namedQuery.getReturnTypes()[0].getReturnedClass()+ "]");
      }
      return new QueryImpl<T>(namedQuery,this);
    }
 catch (    HibernateException he) {
      throw convert(he);
    }
  }
 catch (  MappingException e) {
    throw new IllegalArgumentException("Named query not found: " + name);
  }
}
