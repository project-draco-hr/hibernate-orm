{
  final AbstractEntityEntry entityEntry=(AbstractEntityEntry)managedEntity.$$_hibernate_getEntityEntry();
  if (entityEntry == null || !entityEntry.getPersister().isMutable() || entityEntry.getPersistenceContext() == null || entityEntry.getPersistenceContext() == persistenceContext) {
    return;
  }
  if (entityEntry.getPersistenceContext().getSession().isOpen()) {
    throw new HibernateException("Illegal attempt to associate a ManagedEntity with two open persistence contexts. " + entityEntry);
  }
 else {
    log.stalePersistenceContextInEntityEntry(entityEntry.toString());
  }
}
