{
  SQLFunction sqlFunction=requireSQLFunction(functionName);
  Type argumentType=null;
  if (first != null) {
    if ("cast".equals(functionName)) {
      argumentType=sfi.getTypeResolver().heuristicType(first.getNextSibling().getText());
    }
 else     if (first instanceof SqlNode) {
      argumentType=((SqlNode)first).getDataType();
    }
  }
  return sqlFunction.getReturnType(argumentType,sfi);
}
