{
  QueryCache queryCache=factory.getQueryCache(queryParameters.getCacheRegion());
  Set filterKeys=FilterKey.createFilterKeys(session.getLoadQueryInfluencers().getEnabledFilters(),session.getEntityMode());
  QueryKey key=QueryKey.generateQueryKey(getSQLString(),queryParameters,filterKeys,session,(areResultSetRowsTransformedImmediately(queryParameters.getResultTransformer()) ? queryParameters.getResultTransformer() : null));
  if (querySpaces == null || querySpaces.size() == 0) {
    log.trace("unexpected querySpaces is " + (querySpaces == null ? "null" : "empty"));
  }
 else {
    log.trace("querySpaces is " + querySpaces.toString());
  }
  List result=getResultFromQueryCache(session,queryParameters,querySpaces,resultTypes,queryCache,key);
  if (result == null) {
    result=doList(session,queryParameters);
    putResultInQueryCache(session,queryParameters,resultTypes,queryCache,key,result);
  }
  return getResultList(result,queryParameters.getResultTransformer());
}
