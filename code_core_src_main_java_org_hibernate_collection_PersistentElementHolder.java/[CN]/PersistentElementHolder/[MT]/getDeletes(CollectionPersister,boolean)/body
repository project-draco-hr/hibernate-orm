{
  Type elementType=persister.getElementType();
  ArrayList snapshot=(ArrayList)getSnapshot();
  List elements=element.elements(persister.getElementNodeName());
  ArrayList result=new ArrayList();
  for (int i=0; i < snapshot.size(); i++) {
    Object old=snapshot.get(i);
    if (i >= elements.size()) {
      result.add(old);
    }
 else {
      Element elem=(Element)elements.get(i);
      Object object=elementType.fromXMLNode(elem,persister.getFactory());
      if (elementType.isDirty(old,object,getSession()))       result.add(old);
    }
  }
  return result.iterator();
}
