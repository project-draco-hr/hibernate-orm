{
  this.sessionFactory=sessionFactory;
  this.transactionType=transactionType;
  this.discardOnClose=discardOnClose;
  this.sessionInterceptorClass=sessionInterceptorClass;
  @SuppressWarnings("unchecked") final Iterator<PersistentClass> classes=cfg.getClassMappings();
  if (!"disabled".equalsIgnoreCase(cfg.getProperty("hibernate.ejb.metamodel.generation"))) {
    this.metamodel=new MetamodelImpl(classes);
  }
 else {
    this.metamodel=null;
  }
  this.criteriaQueryBuilder=new QueryBuilderImpl(this);
  this.util=new HibernatePersistenceUnitUtil(this);
}
