{
  if (hasOffset) {
    throw new UnsupportedOperationException("An offset may not be specified to <TOP n> in Cache SQL");
  }
  int insertionPoint=sql.startsWith("select distinct") ? 15 : 6;
  return new StringBuffer(sql.length() + 8).append(sql).insert(insertionPoint," TOP ? ").toString();
}
