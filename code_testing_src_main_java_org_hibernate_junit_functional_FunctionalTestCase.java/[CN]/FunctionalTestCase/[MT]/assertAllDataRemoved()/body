{
  if (!createSchema()) {
    return;
  }
  if (!Boolean.getBoolean("hibernate.test.validateDataCleanup")) {
    return;
  }
  Session tmpSession=getSessions().openSession();
  try {
    List list=tmpSession.createQuery("select o from java.lang.Object o").list();
    Map items=new HashMap();
    if (!list.isEmpty()) {
      for (Iterator iter=list.iterator(); iter.hasNext(); ) {
        Object element=iter.next();
        Integer l=(Integer)items.get(tmpSession.getEntityName(element));
        if (l == null) {
          l=new Integer(0);
        }
        l=new Integer(l.intValue() + 1);
        items.put(tmpSession.getEntityName(element),l);
        System.out.println("Data left: " + element);
      }
      fail("Data is left in the database: " + items.toString());
    }
  }
  finally {
    try {
      tmpSession.close();
    }
 catch (    Throwable t) {
    }
  }
}
