{
  Ejb3Configuration ejb3Configuration=new Ejb3Configuration();
  if (createSchema()) {
    ejb3Configuration.getHibernateConfiguration().setProperty(Environment.HBM2DDL_AUTO,"create-drop");
  }
  if (StringHelper.isNotEmpty(getAuditStrategy())) {
    ejb3Configuration.getHibernateConfiguration().setProperty("org.hibernate.envers.audit_strategy",getAuditStrategy());
  }
  if (!isAudit()) {
    ejb3Configuration.getHibernateConfiguration().setProperty(EnversIntegrator.AUTO_REGISTER,"false");
  }
  ejb3Configuration.getHibernateConfiguration().setProperty(org.hibernate.cfg.AvailableSettings.USE_NEW_ID_GENERATOR_MAPPINGS,"true");
  ejb3Configuration.getHibernateConfiguration().setProperty("org.hibernate.envers.use_enhanced_revision_entity","true");
  ejb3Configuration.getHibernateConfiguration().setProperty(Environment.DIALECT,getDialect().getClass().getName());
  return ejb3Configuration;
}
