{
  for (int n=2; n < 4000; n*=2) {
    Session s=openSession();
    Simple[] simples=new Simple[n];
    s.delete("from Simple");
    s.flush();
    Serializable[] ids=new Serializable[n];
    for (int i=0; i < n; i++) {
      simples[i]=new Simple();
      simples[i].init();
      simples[i].setCount(i);
      ids[i]=new Long(i);
      s.save(simples[i],ids[i]);
    }
    s.flush();
    s.connection().commit();
    s.close();
    s=openSession();
    long time=System.currentTimeMillis();
    hibernate(s,simples,ids,n,"h1");
    long hiber=System.currentTimeMillis() - time;
    s.close();
    s=openSession();
    time=System.currentTimeMillis();
    hibernate(s,simples,ids,n,"h2");
    hiber+=System.currentTimeMillis() - time;
    s.close();
    s=openSession();
    time=System.currentTimeMillis();
    hibernate(s,simples,ids,n,"h2");
    hiber+=System.currentTimeMillis() - time;
    s.close();
    System.out.println("Objects: " + n + " - Hibernate: "+ hiber);
  }
  System.gc();
}
