{
  Update update=new Update(getDialect()).setTableName(qualifiedTableName);
  update.addColumns(elementColumnNames,elementColumnIsSettable,elementColumnWriters);
  if (hasIdentifier) {
    update.addPrimaryKeyColumns(new String[]{identifierColumnName});
  }
 else   if (hasIndex && !indexContainsFormula) {
    update.addPrimaryKeyColumns(ArrayHelper.join(keyColumnNames,indexColumnNames));
  }
 else {
    update.addPrimaryKeyColumns(keyColumnNames);
    update.addPrimaryKeyColumns(elementColumnNames,elementColumnIsInPrimaryKey,elementColumnWriters);
  }
  if (getFactory().getSettings().isCommentsEnabled()) {
    update.setComment("update collection row " + getRole());
  }
  return update.toStatementString();
}
