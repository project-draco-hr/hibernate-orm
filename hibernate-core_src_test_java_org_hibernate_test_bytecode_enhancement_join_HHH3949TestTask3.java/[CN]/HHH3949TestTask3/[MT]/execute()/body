{
  Session session=getFactory().openSession();
  session.getTransaction().begin();
  List<Person> persons=(List<Person>)session.createCriteria(Person.class).setFetchMode("vehicle",FetchMode.JOIN).list();
  for (  Person person : persons) {
    if (shouldHaveVehicle(person)) {
      Assert.assertNotNull(person.getVehicle());
      Assert.assertNotNull(person.getVehicle().getDriver());
    }
  }
  session.getTransaction().commit();
  session.close();
}
