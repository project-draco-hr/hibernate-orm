{
  if (maxLo < 1) {
    long val=((Number)super.generate(session,obj)).longValue();
    if (val == 0)     val=((Number)super.generate(session,obj)).longValue();
    return IdentifierGeneratorFactory.createNumber(val,returnClass);
  }
  if (lo > maxLo) {
    long hival=((Number)super.generate(session,obj)).longValue();
    lo=(hival == 0) ? 1 : 0;
    hi=hival * (maxLo + 1);
    log.debug("new hi value: " + hival);
  }
  return IdentifierGeneratorFactory.createNumber(hi + lo++,returnClass);
}
