{
  return new AccessCallback(){
    public long getNextValue(){
      accessCounter++;
      try {
        PreparedStatement st=session.getBatcher().prepareSelectStatement(sql);
        try {
          ResultSet rs=st.executeQuery();
          try {
            rs.next();
            long result=rs.getLong(1);
            if (log.isDebugEnabled()) {
              log.debug("Sequence identifier generated: " + result);
            }
            return result;
          }
  finally {
            try {
              rs.close();
            }
 catch (            Throwable ignore) {
            }
          }
        }
  finally {
          session.getBatcher().closeStatement(st);
        }
      }
 catch (      SQLException sqle) {
        throw JDBCExceptionHelper.convert(session.getFactory().getSQLExceptionConverter(),sqle,"could not get next sequence value",sql);
      }
    }
  }
;
}
