{
  return new AccessCallback(){
    public IntegralDataTypeHolder getNextValue(){
      accessCounter++;
      try {
        PreparedStatement st=session.getBatcher().prepareSelectStatement(sql);
        try {
          ResultSet rs=st.executeQuery();
          try {
            rs.next();
            IntegralDataTypeHolder value=IdentifierGeneratorHelper.getIntegralDataTypeHolder(numberType);
            value.initialize(rs,1);
            if (log.isDebugEnabled()) {
              log.debug("Sequence value obtained: " + value.makeValue());
            }
            return value;
          }
  finally {
            try {
              rs.close();
            }
 catch (            Throwable ignore) {
            }
          }
        }
  finally {
          session.getBatcher().closeStatement(st);
        }
      }
 catch (      SQLException sqle) {
        throw JDBCExceptionHelper.convert(session.getFactory().getSQLExceptionConverter(),sqle,"could not get next sequence value",sql);
      }
    }
  }
;
}
