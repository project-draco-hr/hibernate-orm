{
  try {
    Configuration cfg=new Configuration();
    boolean script=true;
    boolean doUpdate=true;
    String propFile=null;
    String outFile=null;
    boolean hasNaming=false;
    boolean hasNamingDelegator=false;
    for (int i=0; i < args.length; i++) {
      if (args[i].startsWith("--")) {
        if (args[i].equals("--quiet")) {
          script=false;
        }
 else         if (args[i].startsWith("--properties=")) {
          propFile=args[i].substring(13);
        }
 else         if (args[i].startsWith("--config=")) {
          cfg.configure(args[i].substring(9));
        }
 else         if (args[i].startsWith("--text")) {
          doUpdate=false;
        }
 else         if (args[i].startsWith("--output=")) {
          outFile=args[i].substring(9);
        }
 else         if (args[i].startsWith("--naming=")) {
          hasNaming=true;
          checkNamingAndNamingDelegatorNotBothSpecified(hasNaming,hasNamingDelegator);
          cfg.setNamingStrategy((NamingStrategy)ReflectHelper.classForName(args[i].substring(9)).newInstance());
        }
 else         if (args[i].startsWith("--namingdelegator=")) {
          hasNamingDelegator=true;
          checkNamingAndNamingDelegatorNotBothSpecified(hasNaming,hasNamingDelegator);
          cfg.setNamingStrategyDelegator((NamingStrategyDelegator)ReflectHelper.classForName(args[i].substring(18)).newInstance());
        }
      }
 else {
        cfg.addFile(args[i]);
      }
    }
    if (propFile != null) {
      Properties props=new Properties();
      props.putAll(cfg.getProperties());
      props.load(new FileInputStream(propFile));
      cfg.setProperties(props);
    }
    StandardServiceRegistryImpl serviceRegistry=createServiceRegistry(cfg.getProperties());
    try {
      final SchemaUpdate schemaUpdate=new SchemaUpdate(serviceRegistry,cfg);
      schemaUpdate.setOutputFile(outFile);
      schemaUpdate.execute(script,doUpdate);
    }
  finally {
      serviceRegistry.destroy();
    }
  }
 catch (  Exception e) {
    LOG.unableToRunSchemaUpdate(e);
    e.printStackTrace();
  }
}
