{
  LOG.runningHbm2ddlSchemaUpdate();
  exceptions.clear();
  List<org.hibernate.tool.schema.spi.Target> toolTargets=buildToolTargets(target);
  final ConfigurationService cfgService=serviceRegistry.getService(ConfigurationService.class);
  final SchemaMigrator schemaMigrator=serviceRegistry.getService(SchemaManagementTool.class).getSchemaMigrator(cfgService.getSettings());
  final JdbcServices jdbcServices=serviceRegistry.getService(JdbcServices.class);
  final DatabaseInformation databaseInformation;
  try {
    databaseInformation=new DatabaseInformationImpl(serviceRegistry,serviceRegistry.getService(JdbcEnvironment.class),jdbcConnectionAccess,metadata.getDatabase().getDefaultNamespace().getPhysicalName().getCatalog(),metadata.getDatabase().getDefaultNamespace().getPhysicalName().getSchema());
  }
 catch (  SQLException e) {
    throw jdbcServices.getSqlExceptionHelper().convert(e,"Error creating DatabaseInformation for schema migration");
  }
  try {
    schemaMigrator.doMigration(metadata,databaseInformation,true,toolTargets);
  }
  finally {
    databaseInformation.cleanup();
  }
}
