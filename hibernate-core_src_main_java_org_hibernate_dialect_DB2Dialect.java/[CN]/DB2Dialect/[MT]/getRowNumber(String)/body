{
  StringBuffer rownumber=new StringBuffer(50).append("rownumber() over(");
  int orderByIndex=sql.toLowerCase().indexOf("order by");
  if (orderByIndex > 0 && !hasDistinct(sql)) {
    rownumber.append(sql.substring(orderByIndex));
  }
  rownumber.append(") as rownumber_,");
  return rownumber.toString();
}
