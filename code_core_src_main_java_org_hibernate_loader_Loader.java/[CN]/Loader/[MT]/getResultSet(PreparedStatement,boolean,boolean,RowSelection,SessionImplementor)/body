{
  ResultSet rs=null;
  try {
    Dialect dialect=getFactory().getDialect();
    if (callable) {
      rs=session.getBatcher().getResultSet((CallableStatement)st,dialect);
    }
 else {
      rs=session.getBatcher().getResultSet(st);
    }
    rs=wrapResultSetIfEnabled(rs,session);
    if (!dialect.supportsLimitOffset() || !useLimit(selection,dialect)) {
      advance(rs,selection);
    }
    if (autodiscovertypes) {
      autoDiscoverTypes(rs);
    }
    return rs;
  }
 catch (  SQLException sqle) {
    session.getBatcher().closeQueryStatement(st,rs);
    throw sqle;
  }
}
