{
  LOG.runningSchemaValidator();
  final ConfigurationService cfgService=serviceRegistry.getService(ConfigurationService.class);
  final JdbcServices jdbcServices=serviceRegistry.getService(JdbcServices.class);
  final DatabaseInformation databaseInformation;
  try {
    databaseInformation=new DatabaseInformationImpl(serviceRegistry,serviceRegistry.getService(JdbcEnvironment.class),jdbcConnectionAccess,metadata.getDatabase().getDefaultSchema().getPhysicalName().getCatalog(),metadata.getDatabase().getDefaultSchema().getPhysicalName().getSchema());
  }
 catch (  SQLException e) {
    throw jdbcServices.getSqlExceptionHelper().convert(e,"Error creating DatabaseInformation for schema validation");
  }
  serviceRegistry.getService(SchemaManagementTool.class).getSchemaValidator(cfgService.getSettings()).doValidation(metadata,databaseInformation);
}
