{
  LOG.runningSchemaValidator();
  Connection connection=null;
  try {
    DatabaseMetadata meta;
    try {
      LOG.fetchingDatabaseMetadata();
      connectionHelper.prepare(false);
      connection=connectionHelper.getConnection();
      meta=new DatabaseMetadata(connection,dialect,configuration,false);
    }
 catch (    SQLException sqle) {
      LOG.unableToGetDatabaseMetadata(sqle);
      throw sqle;
    }
    configuration.validateSchema(dialect,meta);
  }
 catch (  SQLException e) {
    LOG.unableToCompleteSchemaValidation(e);
  }
 finally {
    try {
      connectionHelper.release();
    }
 catch (    Exception e) {
      LOG.unableToCloseConnection(e);
    }
  }
}
