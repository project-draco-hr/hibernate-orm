{
  try {
    cleanup();
  }
  finally {
    if (em != null && em.isOpen()) {
      em.close();
    }
    em=null;
    entityManagerFactory.close();
    entityManagerFactory=null;
  }
}
