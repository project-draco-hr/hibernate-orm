{
  CriteriaQuery<String> q=qb.createQuery(String.class);
  Root<Order> order=q.from(Order.class);
  ListJoin<Order,String> note=order.joinList("notes");
  Expression<Set<Item>> items=order.get("items");
  order.fetch("items",INNER);
  q.select(note).where(qb.and(qb.lt(note.index(),10),qb.isNotEmpty(items)));
}
