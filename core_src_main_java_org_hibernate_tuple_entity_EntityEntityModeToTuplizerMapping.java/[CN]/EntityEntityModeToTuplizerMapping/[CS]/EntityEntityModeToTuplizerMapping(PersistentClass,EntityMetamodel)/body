{
  final EntityTuplizerFactory entityTuplizerFactory=em.getSessionFactory().getSettings().getEntityTuplizerFactory();
  Map userSuppliedTuplizerImpls=new HashMap();
  if (mappedEntity.getTuplizerMap() != null) {
    userSuppliedTuplizerImpls.putAll(mappedEntity.getTuplizerMap());
  }
  Tuplizer dynamicMapTuplizer;
  String tuplizerImplClassName=(String)userSuppliedTuplizerImpls.remove(EntityMode.MAP);
  if (tuplizerImplClassName == null) {
    dynamicMapTuplizer=entityTuplizerFactory.constructDefaultTuplizer(EntityMode.MAP,em,mappedEntity);
  }
 else {
    dynamicMapTuplizer=entityTuplizerFactory.constructTuplizer(tuplizerImplClassName,em,mappedEntity);
  }
  Tuplizer pojoTuplizer;
  tuplizerImplClassName=(String)userSuppliedTuplizerImpls.remove(EntityMode.POJO);
  if (mappedEntity.hasPojoRepresentation()) {
    if (tuplizerImplClassName == null) {
      pojoTuplizer=entityTuplizerFactory.constructDefaultTuplizer(EntityMode.POJO,em,mappedEntity);
    }
 else {
      pojoTuplizer=entityTuplizerFactory.constructTuplizer(tuplizerImplClassName,em,mappedEntity);
    }
  }
 else {
    pojoTuplizer=dynamicMapTuplizer;
  }
  Tuplizer dom4jTuplizer;
  tuplizerImplClassName=(String)userSuppliedTuplizerImpls.remove(EntityMode.DOM4J);
  if (mappedEntity.hasDom4jRepresentation()) {
    if (tuplizerImplClassName == null) {
      dom4jTuplizer=entityTuplizerFactory.constructDefaultTuplizer(EntityMode.DOM4J,em,mappedEntity);
    }
 else {
      dom4jTuplizer=entityTuplizerFactory.constructTuplizer(tuplizerImplClassName,em,mappedEntity);
    }
  }
 else {
    dom4jTuplizer=null;
  }
  if (pojoTuplizer != null) {
    addTuplizer(EntityMode.POJO,pojoTuplizer);
  }
  if (dynamicMapTuplizer != null) {
    addTuplizer(EntityMode.MAP,dynamicMapTuplizer);
  }
  if (dom4jTuplizer != null) {
    addTuplizer(EntityMode.DOM4J,dom4jTuplizer);
  }
  if (!userSuppliedTuplizerImpls.isEmpty()) {
    Iterator itr=userSuppliedTuplizerImpls.entrySet().iterator();
    while (itr.hasNext()) {
      final Map.Entry entry=(Map.Entry)itr.next();
      final EntityMode entityMode=(EntityMode)entry.getKey();
      final String tuplizerClassName=(String)entry.getValue();
      final EntityTuplizer tuplizer=entityTuplizerFactory.constructTuplizer(tuplizerClassName,em,mappedEntity);
      addTuplizer(entityMode,tuplizer);
    }
  }
}
