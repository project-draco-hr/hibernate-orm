{
  NotUsingModifiedFlagsEntity entity=new NotUsingModifiedFlagsEntity(entityId);
  EntityManager em=getEntityManager();
  em.getTransaction().begin();
  em.persist(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.setData("data1");
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.setComp1(new Component1("str1","str2"));
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.setComp2(new Component2("str1","str2"));
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  RefEntity refEntity=new RefEntity(refEntityId,"first");
  refEntity.setReference(entity);
  em.persist(refEntity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  refEntity=em.find(RefEntity.class,refEntityId);
  refEntity.setReference(null);
  refEntity.setSecondReference(entity);
  em.merge(refEntity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.getStringSet().add("firstElement");
  entity.getStringSet().add("secondElement");
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.getStringSet().remove("secondElement");
  entity.getStringMap().put("someKey","someValue");
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  StrTestEntity strTestEntity=new StrTestEntity("first");
  em.persist(strTestEntity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.getEntitiesSet().add(strTestEntity);
  entity=em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  entity.getEntitiesSet().remove(strTestEntity);
  entity.getEntitiesMap().put("someKey",strTestEntity);
  em.merge(entity);
  em.getTransaction().commit();
  em.getTransaction().begin();
  strTestEntity.setStr("second");
  em.merge(strTestEntity);
  em.getTransaction().commit();
}
