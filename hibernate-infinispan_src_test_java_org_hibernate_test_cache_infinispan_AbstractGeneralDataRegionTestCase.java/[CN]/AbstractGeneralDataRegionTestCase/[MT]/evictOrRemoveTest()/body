{
  Configuration cfg=createConfiguration();
  InfinispanRegionFactory regionFactory=CacheTestUtil.startRegionFactory(new StandardServiceRegistryBuilder().applySettings(cfg.getProperties()).build(),cfg,getCacheTestSupport());
  boolean invalidation=false;
  avoidConcurrentFlush();
  GeneralDataRegion localRegion=(GeneralDataRegion)createRegion(regionFactory,getStandardRegionName(REGION_PREFIX),cfg.getProperties(),null);
  cfg=createConfiguration();
  regionFactory=CacheTestUtil.startRegionFactory(new StandardServiceRegistryBuilder().applySettings(cfg.getProperties()).build(),cfg,getCacheTestSupport());
  GeneralDataRegion remoteRegion=(GeneralDataRegion)createRegion(regionFactory,getStandardRegionName(REGION_PREFIX),cfg.getProperties(),null);
  assertNull("local is clean",localRegion.get(KEY));
  assertNull("remote is clean",remoteRegion.get(KEY));
  regionPut(localRegion);
  assertEquals(VALUE1,localRegion.get(KEY));
  sleep(250);
  Object expected=invalidation ? null : VALUE1;
  assertEquals(expected,remoteRegion.get(KEY));
  regionEvict(localRegion);
  sleep(250);
  assertEquals(null,localRegion.get(KEY));
  assertEquals(null,remoteRegion.get(KEY));
}
