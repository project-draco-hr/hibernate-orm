{
  Configuration cfg=createConfiguration();
  InfinispanRegionFactory regionFactory=CacheTestUtil.startRegionFactory(new ServiceRegistryBuilder().applySettings(cfg.getProperties()).buildServiceRegistry(),cfg,getCacheTestSupport());
  CacheAdapter localCache=getInfinispanCache(regionFactory);
  boolean invalidation=localCache.isClusteredInvalidation();
  avoidConcurrentFlush();
  GeneralDataRegion localRegion=(GeneralDataRegion)createRegion(regionFactory,getStandardRegionName(REGION_PREFIX),cfg.getProperties(),null);
  cfg=createConfiguration();
  regionFactory=CacheTestUtil.startRegionFactory(new ServiceRegistryBuilder().applySettings(cfg.getProperties()).buildServiceRegistry(),cfg,getCacheTestSupport());
  GeneralDataRegion remoteRegion=(GeneralDataRegion)createRegion(regionFactory,getStandardRegionName(REGION_PREFIX),cfg.getProperties(),null);
  assertNull("local is clean",localRegion.get(KEY));
  assertNull("remote is clean",remoteRegion.get(KEY));
  localRegion.put(KEY,VALUE1);
  assertEquals(VALUE1,localRegion.get(KEY));
  sleep(250);
  Object expected=invalidation ? null : VALUE1;
  assertEquals(expected,remoteRegion.get(KEY));
  localRegion.evict(KEY);
  sleep(250);
  assertEquals(null,localRegion.get(KEY));
  assertEquals(null,remoteRegion.get(KEY));
}
