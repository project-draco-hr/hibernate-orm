{
  SqlServerGeometry sqlServerGeom=new SqlServerGeometry();
  int srid=geom.getSRID();
  sqlServerGeom.setSrid(srid < 0 ? 0 : srid);
  sqlServerGeom.setIsValid();
  if (geom.isEmpty()) {
    sqlServerGeom.setNumberOfPoints(0);
    sqlServerGeom.setNumberOfFigures(0);
    sqlServerGeom.setNumberOfShapes(1);
    sqlServerGeom.setShape(0,new Shape(-1,-1,OpenGisType.POINT));
    return sqlServerGeom;
  }
  sqlServerGeom.setIsSinglePoint();
  sqlServerGeom.setNumberOfPoints(1);
  if (geom.is3D()) {
    sqlServerGeom.setHasZValues();
    sqlServerGeom.allocateZValueArray();
  }
  if (geom.isMeasured()) {
    sqlServerGeom.setHasMValues();
    sqlServerGeom.allocateMValueArray();
  }
  sqlServerGeom.setCoordinate(0,geom.getPoints());
  return sqlServerGeom;
}
