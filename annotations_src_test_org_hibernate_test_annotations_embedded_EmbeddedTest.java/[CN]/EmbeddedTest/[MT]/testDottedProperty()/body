{
  Session s;
  Transaction tx;
  s=openSession();
  tx=s.beginTransaction();
  Swap shortSwap=new Swap();
  shortSwap.setTenor(2);
  FixedLeg shortFixed=new FixedLeg();
  shortFixed.setPaymentFrequency(Frequency.SEMIANNUALLY);
  shortFixed.setRate(5.6);
  FloatLeg shortFloating=new FloatLeg();
  shortFloating.setPaymentFrequency(Frequency.QUARTERLY);
  shortFloating.setRateIndex(RateIndex.LIBOR);
  shortFloating.setRateSpread(1.1);
  shortSwap.setFixedLeg(shortFixed);
  shortSwap.setFloatLeg(shortFloating);
  Swap swap=new Swap();
  swap.setTenor(7);
  FixedLeg fixed=new FixedLeg();
  fixed.setPaymentFrequency(Frequency.MONTHLY);
  fixed.setRate(7.6);
  FloatLeg floating=new FloatLeg();
  floating.setPaymentFrequency(Frequency.MONTHLY);
  floating.setRateIndex(RateIndex.TIBOR);
  floating.setRateSpread(0.8);
  swap.setFixedLeg(fixed);
  swap.setFloatLeg(floating);
  Swap longSwap=new Swap();
  longSwap.setTenor(7);
  FixedLeg longFixed=new FixedLeg();
  longFixed.setPaymentFrequency(Frequency.MONTHLY);
  longFixed.setRate(7.6);
  FloatLeg longFloating=new FloatLeg();
  longFloating.setPaymentFrequency(Frequency.MONTHLY);
  longFloating.setRateIndex(RateIndex.TIBOR);
  longFloating.setRateSpread(0.8);
  longSwap.setFixedLeg(longFixed);
  longSwap.setFloatLeg(longFloating);
  SpreadDeal deal=new SpreadDeal();
  deal.setId("FX45632");
  deal.setNotional(450000.0);
  deal.setShortSwap(shortSwap);
  deal.setSwap(swap);
  deal.setLongSwap(longSwap);
  s.persist(deal);
  tx.commit();
  s.close();
  s=openSession();
  tx=s.beginTransaction();
  deal=(SpreadDeal)s.get(SpreadDeal.class,deal.getId());
  assertNotNull("Short swap is null.",deal.getShortSwap());
  assertNotNull("Swap is null.",deal.getSwap());
  assertNotNull("Long swap is null.",deal.getLongSwap());
  assertEquals(2,deal.getShortSwap().getTenor());
  assertEquals(7,deal.getSwap().getTenor());
  assertEquals(7,deal.getLongSwap().getTenor());
  assertNotNull("Short fixed leg is null.",deal.getShortSwap().getFixedLeg());
  assertNotNull("Short floating leg is null.",deal.getShortSwap().getFloatLeg());
  assertNotNull("Fixed leg is null.",deal.getSwap().getFixedLeg());
  assertNotNull("Floating leg is null.",deal.getSwap().getFloatLeg());
  assertNotNull("Long fixed leg is null.",deal.getLongSwap().getFixedLeg());
  assertNotNull("Long floating leg is null.",deal.getLongSwap().getFloatLeg());
  assertEquals(Frequency.SEMIANNUALLY,deal.getShortSwap().getFixedLeg().getPaymentFrequency());
  assertEquals(Frequency.QUARTERLY,deal.getShortSwap().getFloatLeg().getPaymentFrequency());
  assertEquals(Frequency.MONTHLY,deal.getSwap().getFixedLeg().getPaymentFrequency());
  assertEquals(Frequency.MONTHLY,deal.getSwap().getFloatLeg().getPaymentFrequency());
  assertEquals(Frequency.MONTHLY,deal.getLongSwap().getFixedLeg().getPaymentFrequency());
  assertEquals(Frequency.MONTHLY,deal.getLongSwap().getFloatLeg().getPaymentFrequency());
  assertEquals(5.6,deal.getShortSwap().getFixedLeg().getRate());
  assertEquals(7.6,deal.getSwap().getFixedLeg().getRate());
  assertEquals(7.6,deal.getLongSwap().getFixedLeg().getRate());
  assertEquals(RateIndex.LIBOR,deal.getShortSwap().getFloatLeg().getRateIndex());
  assertEquals(RateIndex.TIBOR,deal.getSwap().getFloatLeg().getRateIndex());
  assertEquals(RateIndex.TIBOR,deal.getLongSwap().getFloatLeg().getRateIndex());
  assertEquals(1.1,deal.getShortSwap().getFloatLeg().getRateSpread());
  assertEquals(0.8,deal.getSwap().getFloatLeg().getRateSpread());
  assertEquals(0.8,deal.getLongSwap().getFloatLeg().getRateSpread());
  s.delete(deal);
  tx.commit();
  s.close();
}
