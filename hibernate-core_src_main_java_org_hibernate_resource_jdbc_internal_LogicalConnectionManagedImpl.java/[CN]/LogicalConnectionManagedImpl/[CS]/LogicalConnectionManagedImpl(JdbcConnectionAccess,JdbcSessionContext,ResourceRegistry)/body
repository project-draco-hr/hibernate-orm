{
  this.jdbcConnectionAccess=jdbcConnectionAccess;
  this.observer=jdbcSessionContext.getObserver();
  this.sqlExceptionHelper=jdbcSessionContext.getServiceRegistry().getService(JdbcServices.class).getSqlExceptionHelper();
  this.connectionReleaseMode=jdbcSessionContext.getConnectionReleaseMode();
  this.resourceRegistry=resourceRegistry;
  if (jdbcSessionContext.getConnectionAcquisitionMode() == JdbcSessionContext.ConnectionAcquisitionMode.IMMEDIATELY) {
    if (jdbcSessionContext.getConnectionReleaseMode() != ConnectionReleaseMode.ON_CLOSE) {
      throw new IllegalStateException("Illegal combination of ConnectionAcquisitionMode#IMMEDIATELY with !ConnectionReleaseMode.ON_CLOSE");
    }
    acquireConnectionIfNeeded();
  }
}
