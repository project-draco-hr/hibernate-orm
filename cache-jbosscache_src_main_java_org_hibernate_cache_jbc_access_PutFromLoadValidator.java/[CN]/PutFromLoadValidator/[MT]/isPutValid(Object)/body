{
  boolean valid=false;
  long now=System.currentTimeMillis();
  PendingPutMap pending=pendingPuts.get(key);
  if (pending != null) {
synchronized (pending) {
      PendingPut toCancel=pending.remove(getOwnerForPut());
      valid=toCancel != null;
      if (valid) {
        toCancel.completed=true;
        if (pending.size() == 0) {
          pendingPuts.remove(key);
        }
      }
    }
  }
  if (!valid) {
    if (now > invalidationTimestamp) {
      Long removedTime=recentRemovals.get(key);
      if (removedTime == null || now > removedTime.longValue()) {
        valid=true;
      }
    }
  }
  cleanOutdatedPendingPuts(now,true);
  return valid;
}
