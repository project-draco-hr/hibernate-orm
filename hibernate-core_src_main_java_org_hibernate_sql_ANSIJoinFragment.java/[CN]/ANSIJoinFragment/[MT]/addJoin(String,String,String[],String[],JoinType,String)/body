{
  final String joinString;
switch (joinType) {
case INNER_JOIN:
    joinString=" inner join ";
  break;
case LEFT_OUTER_JOIN:
joinString=" left outer join ";
break;
case RIGHT_OUTER_JOIN:
joinString=" right outer join ";
break;
case FULL_JOIN:
joinString=" full outer join ";
break;
default :
throw new AssertionFailure("undefined join type");
}
this.buffer.append(joinString).append(tableName).append(' ').append(alias).append(" on ");
for (int j=0; j < fkColumns.length; j++) {
this.buffer.append(fkColumns[j]).append('=').append(alias).append('.').append(pkColumns[j]);
if (j < fkColumns.length - 1) {
this.buffer.append(" and ");
}
}
addCondition(buffer,on);
}
