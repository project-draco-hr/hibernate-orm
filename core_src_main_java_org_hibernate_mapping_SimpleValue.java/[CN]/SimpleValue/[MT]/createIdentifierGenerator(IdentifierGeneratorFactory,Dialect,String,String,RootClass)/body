{
  Properties params=new Properties();
  if (defaultSchema != null) {
    params.setProperty(PersistentIdentifierGenerator.SCHEMA,defaultSchema);
  }
  if (defaultCatalog != null) {
    params.setProperty(PersistentIdentifierGenerator.CATALOG,defaultCatalog);
  }
  if (rootClass != null) {
    params.setProperty(IdentifierGenerator.ENTITY_NAME,rootClass.getEntityName());
  }
  String tableName=getTable().getQuotedName(dialect);
  params.setProperty(PersistentIdentifierGenerator.TABLE,tableName);
  String columnName=((Column)getColumnIterator().next()).getQuotedName(dialect);
  params.setProperty(PersistentIdentifierGenerator.PK,columnName);
  if (rootClass != null) {
    StringBuffer tables=new StringBuffer();
    Iterator iter=rootClass.getIdentityTables().iterator();
    while (iter.hasNext()) {
      Table table=(Table)iter.next();
      tables.append(table.getQuotedName(dialect));
      if (iter.hasNext())       tables.append(", ");
    }
    params.setProperty(PersistentIdentifierGenerator.TABLES,tables.toString());
  }
 else {
    params.setProperty(PersistentIdentifierGenerator.TABLES,tableName);
  }
  if (identifierGeneratorProperties != null) {
    params.putAll(identifierGeneratorProperties);
  }
  identifierGeneratorFactory.setDialect(dialect);
  return identifierGeneratorFactory.createIdentifierGenerator(identifierGeneratorStrategy,getType(),params);
}
