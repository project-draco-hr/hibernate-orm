{
  if (connection == null) {
    log.trace("connection already null in cleanup : no action");
    return null;
  }
  try {
    log.trace("performing cleanup");
    if (isLogicallyConnected()) {
      batcher.closeStatements();
    }
    Connection c=connection.close();
    return c;
  }
  finally {
    connection=null;
  }
}
