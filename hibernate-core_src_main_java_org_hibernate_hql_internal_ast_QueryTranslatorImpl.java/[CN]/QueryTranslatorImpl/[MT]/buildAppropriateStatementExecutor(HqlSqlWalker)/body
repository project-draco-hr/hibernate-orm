{
  final Statement statement=(Statement)walker.getAST();
  if (walker.getStatementType() == HqlSqlTokenTypes.DELETE) {
    final FromElement fromElement=walker.getFinalFromClause().getFromElement();
    final Queryable persister=fromElement.getQueryable();
    if (persister.isMultiTable()) {
      return new MultiTableDeleteExecutor(walker);
    }
 else {
      return new DeleteExecutor(walker,persister);
    }
  }
 else   if (walker.getStatementType() == HqlSqlTokenTypes.UPDATE) {
    final FromElement fromElement=walker.getFinalFromClause().getFromElement();
    final Queryable persister=fromElement.getQueryable();
    if (persister.isMultiTable()) {
      return new MultiTableUpdateExecutor(walker);
    }
 else {
      return new BasicExecutor(walker,persister);
    }
  }
 else   if (walker.getStatementType() == HqlSqlTokenTypes.INSERT) {
    return new BasicExecutor(walker,((InsertStatement)statement).getIntoClause().getQueryable());
  }
 else {
    throw new QueryException("Unexpected statement type");
  }
}
