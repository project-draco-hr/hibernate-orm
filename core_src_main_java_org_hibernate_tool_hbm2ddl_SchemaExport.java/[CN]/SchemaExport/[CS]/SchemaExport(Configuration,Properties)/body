{
  dialect=Dialect.getDialect(properties);
  Properties props=new Properties();
  props.putAll(dialect.getDefaultProperties());
  props.putAll(properties);
  connectionHelper=new ManagedProviderConnectionHelper(props);
  dropSQL=cfg.generateDropSchemaScript(dialect);
  createSQL=cfg.generateSchemaCreationScript(dialect);
  formatter=(PropertiesHelper.getBoolean(Environment.FORMAT_SQL,props) ? FormatStyle.DDL : FormatStyle.NONE).getFormatter();
}
