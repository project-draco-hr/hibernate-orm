{
  LOG.trace("Total checked-out connections: " + checkedOut);
synchronized (pool) {
    if (!pool.isEmpty()) {
      int last=pool.size() - 1;
      if (LOG.isTraceEnabled()) {
        LOG.trace("Using pooled JDBC connection, pool size: " + last);
        checkedOut++;
      }
      Connection pooled=pool.remove(last);
      if (isolation != null) {
        pooled.setTransactionIsolation(isolation.intValue());
      }
      if (pooled.getAutoCommit() != autocommit) {
        pooled.setAutoCommit(autocommit);
      }
      return pooled;
    }
  }
  LOG.debug("Opening new JDBC connection");
  Connection conn=DriverManager.getConnection(url,connectionProps);
  if (isolation != null) {
    conn.setTransactionIsolation(isolation.intValue());
  }
  if (conn.getAutoCommit() != autocommit) {
    conn.setAutoCommit(autocommit);
  }
  LOG.debug("Created connection to: " + url + ", Isolation Level: "+ conn.getTransactionIsolation());
  checkedOut++;
  return conn;
}
