{
  LOG.totalCheckedOutConnection(checkedOut);
synchronized (pool) {
    if (!pool.isEmpty()) {
      int last=pool.size() - 1;
      if (LOG.isTraceEnabled()) {
        LOG.usingPooledJdbcConnection(last);
        checkedOut++;
      }
      Connection pooled=pool.remove(last);
      if (isolation != null) {
        pooled.setTransactionIsolation(isolation.intValue());
      }
      if (pooled.getAutoCommit() != autocommit) {
        pooled.setAutoCommit(autocommit);
      }
      return pooled;
    }
  }
  LOG.openingNewJdbcConnection();
  Connection conn=DriverManager.getConnection(url,connectionProps);
  if (isolation != null) {
    conn.setTransactionIsolation(isolation.intValue());
  }
  if (conn.getAutoCommit() != autocommit) {
    conn.setAutoCommit(autocommit);
  }
  LOG.createdConnection(url,conn.getTransactionIsolation());
  checkedOut++;
  return conn;
}
