{
  InputSource source=null;
  if (systemId != null) {
    LOG.debugf("Trying to resolve system-id [%s]",systemId);
    if (systemId.startsWith(HIBERNATE_NAMESPACE)) {
      LOG.debugf("Recognized hibernate namespace; attempting to resolve on classpath under org/hibernate/");
      source=resolveOnClassPath(publicId,systemId,HIBERNATE_NAMESPACE);
    }
 else     if (systemId.startsWith(OLD_HIBERNATE_NAMESPACE)) {
      LOG.recognizedObsoleteHibernateNamespace(OLD_HIBERNATE_NAMESPACE,HIBERNATE_NAMESPACE);
      LOG.debugf("Attempting to resolve on classpath under org/hibernate/");
      source=resolveOnClassPath(publicId,systemId,OLD_HIBERNATE_NAMESPACE);
    }
 else     if (systemId.startsWith(USER_NAMESPACE)) {
      LOG.debugf("Recognized local namespace; attempting to resolve on classpath");
      String path=systemId.substring(USER_NAMESPACE.length());
      InputStream stream=resolveInLocalNamespace(path);
      if (stream == null)       LOG.debugf("Unable to locate [%s] on classpath",systemId);
 else {
        LOG.debugf("Located [%s] in classpath",systemId);
        source=new InputSource(stream);
        source.setPublicId(publicId);
        source.setSystemId(systemId);
      }
    }
  }
  return source;
}
