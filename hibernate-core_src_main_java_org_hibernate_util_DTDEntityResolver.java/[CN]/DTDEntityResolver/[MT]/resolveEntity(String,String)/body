{
  InputSource source=null;
  if (systemId != null) {
    LOG.tryingToResolveSystemId(systemId);
    if (systemId.startsWith(HIBERNATE_NAMESPACE)) {
      LOG.recognizedHibernateNamespace();
      source=resolveOnClassPath(publicId,systemId,HIBERNATE_NAMESPACE);
    }
 else     if (systemId.startsWith(OLD_HIBERNATE_NAMESPACE)) {
      LOG.recognizedObsoleteHibernateNamespace(OLD_HIBERNATE_NAMESPACE,HIBERNATE_NAMESPACE);
      LOG.attemptingToResolveSystemId();
      source=resolveOnClassPath(publicId,systemId,OLD_HIBERNATE_NAMESPACE);
    }
 else     if (systemId.startsWith(USER_NAMESPACE)) {
      LOG.recognizedLocalNamespace();
      String path=systemId.substring(USER_NAMESPACE.length());
      InputStream stream=resolveInLocalNamespace(path);
      if (stream == null)       LOG.unableToLocateSystemId(systemId);
 else {
        LOG.systemIdLocated(systemId);
        source=new InputSource(stream);
        source.setPublicId(publicId);
        source.setSystemId(systemId);
      }
    }
  }
  return source;
}
