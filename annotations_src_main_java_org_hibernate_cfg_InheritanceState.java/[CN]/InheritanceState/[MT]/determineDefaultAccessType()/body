{
  XClass xclass=clazz;
  while (xclass != null && !Object.class.getName().equals(xclass.getName())) {
    if (xclass.isAnnotationPresent(Entity.class) || xclass.isAnnotationPresent(MappedSuperclass.class)) {
      for (      XProperty prop : xclass.getDeclaredProperties(AccessType.PROPERTY.getType())) {
        final boolean isEmbeddedId=prop.isAnnotationPresent(EmbeddedId.class);
        if (prop.isAnnotationPresent(Id.class) || isEmbeddedId) {
          if (isEmbeddedId) {
            identifierType=prop.getClassOrElementClass();
          }
          return AccessType.PROPERTY;
        }
      }
      for (      XProperty prop : xclass.getDeclaredProperties(AccessType.FIELD.getType())) {
        final boolean isEmbeddedId=prop.isAnnotationPresent(EmbeddedId.class);
        if (prop.isAnnotationPresent(Id.class) || isEmbeddedId) {
          if (isEmbeddedId) {
            identifierType=prop.getClassOrElementClass();
          }
          return AccessType.FIELD;
        }
      }
    }
    xclass=xclass.getSuperclass();
  }
  throw new AnnotationException("No identifier specified for entity: " + clazz.getName());
}
