{
  Person p=(Person)getSession().createCriteria(Person.class).add(Restrictions.idEq(personId)).uniqueResult();
  Name n2=new Name();
  n2.setName("name2");
  p.getNames().add(n2);
  Transaction transaction=getSession().beginTransaction();
  getSession().saveOrUpdate(p);
  transaction.commit();
  namesId.add(n2.getId());
  int sizePerson=getAuditReader().getRevisions(Person.class,personId).size();
  Assert.assertEquals(config.getProperty("org.hibernate.envers.revision_on_collection_change"),getCollectionChangeValue());
  Assert.assertEquals(sizePerson,getExpectedPersonRevisionCount());
  for (  Integer id : namesId) {
    int sizeName=getAuditReader().getRevisions(Name.class,id).size();
    Assert.assertEquals(sizeName,EXPECTED_NAME_REVISION_COUNT);
  }
}
