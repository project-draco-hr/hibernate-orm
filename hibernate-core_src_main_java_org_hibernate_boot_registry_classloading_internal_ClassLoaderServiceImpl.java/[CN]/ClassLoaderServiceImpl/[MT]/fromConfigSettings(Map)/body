{
  final List<ClassLoader> providedClassLoaders=new ArrayList<ClassLoader>();
  final Collection<ClassLoader> classLoaders=(Collection<ClassLoader>)configValues.get(AvailableSettings.CLASSLOADERS);
  if (classLoaders != null) {
    for (    ClassLoader classLoader : classLoaders) {
      providedClassLoaders.add(classLoader);
    }
  }
  addIfSet(providedClassLoaders,AvailableSettings.APP_CLASSLOADER,configValues);
  addIfSet(providedClassLoaders,AvailableSettings.RESOURCES_CLASSLOADER,configValues);
  addIfSet(providedClassLoaders,AvailableSettings.HIBERNATE_CLASSLOADER,configValues);
  addIfSet(providedClassLoaders,AvailableSettings.ENVIRONMENT_CLASSLOADER,configValues);
  if (providedClassLoaders.isEmpty()) {
    log.debugf("Incoming config yielded no classloaders; adding standard SE ones");
    final ClassLoader tccl=locateTCCL();
    if (tccl != null) {
      providedClassLoaders.add(tccl);
    }
    providedClassLoaders.add(ClassLoaderServiceImpl.class.getClassLoader());
  }
  return new ClassLoaderServiceImpl(providedClassLoaders);
}
