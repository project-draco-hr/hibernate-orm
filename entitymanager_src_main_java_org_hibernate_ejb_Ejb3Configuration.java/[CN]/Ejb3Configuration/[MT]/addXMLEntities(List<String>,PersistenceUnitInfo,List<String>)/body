{
  ClassLoader classLoaderToUse=info.getNewTempClassLoader();
  if (classLoaderToUse == null) {
    log.warn("Persistence provider caller does not implement the EJB3 spec correctly." + "PersistenceUnitInfo.getNewTempClassLoader() is null.");
    return;
  }
  for (  final String xmlFile : xmlFiles) {
    final InputStream fileInputStream=classLoaderToUse.getResourceAsStream(xmlFile);
    if (fileInputStream == null) {
      log.info("Unable to resolve mapping file [{}]",xmlFile);
      continue;
    }
    final InputSource inputSource=new InputSource(fileInputStream);
    XmlDocument metadataXml=MappingReader.INSTANCE.readMappingDocument(cfg.getEntityResolver(),inputSource,new OriginImpl("persistence-unit-info",xmlFile));
    try {
      final Element rootElement=metadataXml.getDocumentTree().getRootElement();
      if (rootElement != null && "entity-mappings".equals(rootElement.getName())) {
        Element element=rootElement.element("package");
        String defaultPackage=element != null ? element.getTextTrim() : null;
        List<Element> elements=rootElement.elements("entity");
        for (        Element subelement : elements) {
          String classname=XMLContext.buildSafeClassName(subelement.attributeValue("class"),defaultPackage);
          if (!entities.contains(classname)) {
            entities.add(classname);
          }
        }
        elements=rootElement.elements("mapped-superclass");
        for (        Element subelement : elements) {
          String classname=XMLContext.buildSafeClassName(subelement.attributeValue("class"),defaultPackage);
          if (!entities.contains(classname)) {
            entities.add(classname);
          }
        }
        elements=rootElement.elements("embeddable");
        for (        Element subelement : elements) {
          String classname=XMLContext.buildSafeClassName(subelement.attributeValue("class"),defaultPackage);
          if (!entities.contains(classname)) {
            entities.add(classname);
          }
        }
      }
 else       if (rootElement != null && "hibernate-mappings".equals(rootElement.getName())) {
      }
    }
  finally {
      try {
        fileInputStream.close();
      }
 catch (      IOException ioe) {
        log.warn("Could not close input stream",ioe);
      }
    }
  }
}
