{
  final Type attributeType=attributeDefinition.getType();
  if (attributeType.isAnyType()) {
  }
 else   if (attributeType.isComponentType()) {
    final ExpandingFetchSource popped=popFromStack();
    if (!CompositeAttributeFetch.class.isInstance(popped)) {
      throw new WalkingException(String.format("Mismatched FetchSource from stack on pop; expected: CompositeAttributeFetch; actual: [%s]",popped));
    }
    final CompositeAttributeFetch poppedAsCompositeAttributeFetch=(CompositeAttributeFetch)popped;
    if (!attributeDefinition.equals(poppedAsCompositeAttributeFetch.getFetchedAttributeDefinition())) {
      throw new WalkingException(String.format("Mismatched CompositeAttributeFetch from stack on pop; expected fetch for attribute: [%s]; actual: [%s]",attributeDefinition,poppedAsCompositeAttributeFetch.getFetchedAttributeDefinition()));
    }
  }
 else   if (attributeType.isEntityType()) {
    final ExpandingFetchSource source=currentSource();
    if (AttributeFetch.class.isInstance(source) && attributeDefinition.equals(AttributeFetch.class.cast(source).getFetchedAttributeDefinition())) {
      popEntityFromStack(((AssociationAttributeDefinition)attributeDefinition).toEntityDefinition());
    }
  }
 else   if (attributeType.isCollectionType()) {
    final CollectionReference currentCollection=collectionReferenceStack.peekFirst();
    if (currentCollection != null && AttributeFetch.class.isInstance(currentCollection) && attributeDefinition.equals(AttributeFetch.class.cast(currentCollection).getFetchedAttributeDefinition())) {
      popFromCollectionStack(((AssociationAttributeDefinition)attributeDefinition).toCollectionDefinition());
    }
  }
  log.tracef("%s Finishing up attribute : %s",StringHelper.repeat("<<",fetchSourceStack.size()),attributeDefinition);
  currentPropertyPath=currentPropertyPath.getParent();
}
