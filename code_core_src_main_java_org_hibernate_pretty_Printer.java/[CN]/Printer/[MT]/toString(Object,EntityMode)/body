{
  ClassMetadata cm=factory.getClassMetadata(entity.getClass());
  if (cm == null)   return entity.getClass().getName();
  Map result=new HashMap();
  if (cm.hasIdentifierProperty()) {
    result.put(cm.getIdentifierPropertyName(),cm.getIdentifierType().toLoggableString(cm.getIdentifier(entity,entityMode),factory));
  }
  Type[] types=cm.getPropertyTypes();
  String[] names=cm.getPropertyNames();
  Object[] values=cm.getPropertyValues(entity,entityMode);
  for (int i=0; i < types.length; i++) {
    if (!names[i].startsWith("_")) {
      String strValue=values[i] == LazyPropertyInitializer.UNFETCHED_PROPERTY ? values[i].toString() : types[i].toLoggableString(values[i],factory);
      result.put(names[i],strValue);
    }
  }
  return cm.getEntityName() + result.toString();
}
