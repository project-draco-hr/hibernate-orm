{
  final String compositeQuerySpaceUid=getQuerySpaces().generateImplicitUid();
  final CompositeQuerySpaceImpl compositeQuerySpace=new CompositeQuerySpaceImpl(new CompositePropertyMapping(compositeType,(PropertyMapping)getCollectionPersister(),"index"),compositeQuerySpaceUid,getQuerySpaces(),canJoinsBeRequired(),sessionFactory());
  getQuerySpaces().registerQuerySpace(compositeQuerySpace);
  final JoinDefinedByMetadata join=JoinHelper.INSTANCE.createCompositeJoin(this,CollectionPropertyNames.COLLECTION_INDICES,compositeQuerySpace,canJoinsBeRequired(),compositeType);
  internalGetJoins().add(join);
  return join;
}
