{
  final SchemaExport schemaExport=createSchemaExport(metadata,serviceRegistry);
  schemaExport.execute(false,true,false,false);
  if (doesDialectSupportDropTableIfExist()) {
    assertEquals(0,schemaExport.getExceptions().size());
  }
 else {
    assertEquals(2,schemaExport.getExceptions().size());
  }
  schemaExport.execute(false,true,false,false);
  assertEquals(0,schemaExport.getExceptions().size());
  schemaExport.execute(false,true,true,false);
  assertEquals(0,schemaExport.getExceptions().size());
}
