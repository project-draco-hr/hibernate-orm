{
  Session s;
  s=openSession();
  Transaction tx=s.beginTransaction();
  InternetProvider provider=new InternetProvider();
  provider.setBrandName("Fido");
  LegalStructure structure=new LegalStructure();
  structure.setCountry("Canada");
  structure.setName("Rogers");
  provider.setOwner(structure);
  s.persist(provider);
  Manager manager=new Manager();
  manager.setName("Bill");
  manager.setEmployer(provider);
  structure.getTopManagement().add(manager);
  s.persist(manager);
  tx.commit();
  s.close();
  s=openSession();
  s.getTransaction().begin();
  InternetProvider internetProviderQueried=(InternetProvider)s.createQuery("from InternetProvider").uniqueResult();
  assertFalse(Hibernate.isInitialized(internetProviderQueried.getOwner().getTopManagement()));
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.getTransaction().begin();
  internetProviderQueried=(InternetProvider)s.createQuery("from InternetProvider i join fetch i.owner.topManagement").uniqueResult();
  assertTrue(Hibernate.isInitialized(internetProviderQueried.getOwner().getTopManagement()));
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.getTransaction().begin();
  internetProviderQueried=(InternetProvider)s.createQuery("from InternetProvider i join fetch i.owner o join fetch o.topManagement").uniqueResult();
  assertTrue(Hibernate.isInitialized(internetProviderQueried.getOwner().getTopManagement()));
  s.getTransaction().commit();
  s.close();
  s=openSession();
  tx=s.beginTransaction();
  provider=(InternetProvider)s.get(InternetProvider.class,provider.getId());
  manager=provider.getOwner().getTopManagement().iterator().next();
  s.delete(manager);
  s.delete(provider);
  tx.commit();
  s.close();
}
