{
  Session s;
  Transaction tx;
  Person p=new Person();
  Address a=new Address();
  Country c=new Country();
  Country bornCountry=new Country();
  assertNull(bornCountry.getIso2());
  assertNull(bornCountry.getName());
  a.address1="colorado street";
  a.city="Springfield";
  a.country=c;
  p.address=a;
  p.bornIn=bornCountry;
  p.name="Homer";
  s=openSession();
  tx=s.beginTransaction();
  s.persist(p);
  tx.commit();
  s.close();
  s=openSession();
  tx=s.beginTransaction();
  p=(Person)s.createQuery("from Person p where p.bornIn = :b").setParameter("b",p.bornIn).uniqueResult();
  assertNotNull(p);
  assertNotNull(p.address);
  assertEquals("Springfield",p.address.city);
  assertNotNull(p.address.country);
  assertEquals("DM",p.address.country.getIso2());
  assertNull(p.bornIn);
  tx.commit();
  s.close();
}
