{
  Session s=openSession();
  s.beginTransaction();
  Route route=new Route();
  route.setName("routeA");
  s.save(route);
  s.getTransaction().commit();
  s.close();
  clearCounts();
  s=openSession();
  s.beginTransaction();
  route=(Route)s.get(Route.class,new Long(1));
  route.setName("new routA");
  route.setTransientField(new String("sfnaouisrbn"));
  Tour tour=new Tour();
  tour.setName("tourB");
  Transport transport1=new Transport();
  transport1.setName("TRANSPORT1");
  Transport transport2=new Transport();
  transport2.setName("TRANSPORT2");
  Node node1=new Node();
  node1.setName("NODE1");
  Node node2=new Node();
  node2.setName("NODE2");
  Node node3=new Node();
  node3.setName("NODE3");
  node1.setRoute(route);
  node1.setTour(tour);
  node1.getPickupTransports().add(transport1);
  node1.setTransientField("node 1");
  node2.setRoute(route);
  node2.setTour(tour);
  node2.getDeliveryTransports().add(transport1);
  node2.getPickupTransports().add(transport2);
  node2.setTransientField("node 2");
  node3.setRoute(route);
  node3.setTour(tour);
  node3.getDeliveryTransports().add(transport2);
  node3.setTransientField("node 3");
  tour.getNodes().add(node1);
  tour.getNodes().add(node2);
  tour.getNodes().add(node3);
  route.getNodes().add(node1);
  route.getNodes().add(node2);
  route.getNodes().add(node3);
  transport1.setPickupNode(node1);
  transport1.setDeliveryNode(node2);
  transport1.setTransientField("aaaaaaaaaaaaaa");
  transport2.setPickupNode(node2);
  transport2.setDeliveryNode(node3);
  transport2.setTransientField("bbbbbbbbbbbbb");
  Route mergedRoute=(Route)s.merge(route);
  s.getTransaction().commit();
  s.close();
  assertInsertCount(6);
  assertUpdateCount(1);
}
