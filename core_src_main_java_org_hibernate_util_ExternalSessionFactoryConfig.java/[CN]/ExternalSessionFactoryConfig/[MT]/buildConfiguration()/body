{
  Configuration cfg=new Configuration().setProperties(buildProperties());
  String[] mappingFiles=PropertiesHelper.toStringArray(mapResources," ,\n\t\r\f");
  for (int i=0; i < mappingFiles.length; i++) {
    cfg.addResource(mappingFiles[i]);
  }
  if (customListeners != null && !customListeners.isEmpty()) {
    Iterator entries=customListeners.entrySet().iterator();
    while (entries.hasNext()) {
      final Map.Entry entry=(Map.Entry)entries.next();
      final String type=(String)entry.getKey();
      final Object value=entry.getValue();
      if (value != null) {
        if (String.class.isAssignableFrom(value.getClass())) {
          cfg.setListener(type,((String)value));
        }
 else {
          cfg.setListener(type,value);
        }
      }
    }
  }
  return cfg;
}
