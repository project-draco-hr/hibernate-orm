{
  checkOpen(true);
  if (isNativeSqlQuery()) {
    throw new IllegalStateException("Illegal attempt to set lock mode on a native SQL query");
  }
  if (!isSelectQuery()) {
    throw new IllegalStateException("Illegal attempt to set lock mode on a non-SELECT query");
  }
  if (lockModeType != LockModeType.NONE) {
    if (!getEntityManager().isTransactionInProgress()) {
      throw new TransactionRequiredException("no transaction is in progress");
    }
  }
  if (!canApplyAliasSpecificLockModeHints()) {
    throw new IllegalStateException("Not a JPAQL/Criteria query");
  }
  this.jpaLockMode=lockModeType;
  internalApplyLockMode(lockModeType);
  return this;
}
