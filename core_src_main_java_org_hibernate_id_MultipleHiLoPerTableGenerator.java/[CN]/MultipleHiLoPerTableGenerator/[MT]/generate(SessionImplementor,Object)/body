{
  if (maxLo < 1) {
    IntegralDataTypeHolder value=null;
    while (value == null || value.lt(1)) {
      value=(IntegralDataTypeHolder)doWorkInNewTransaction(session);
    }
    return value.makeValue();
  }
  if (lo > maxLo) {
    IntegralDataTypeHolder hiVal=(IntegralDataTypeHolder)doWorkInNewTransaction(session);
    lo=(hiVal.eq(0)) ? 1 : 0;
    value=hiVal.copy().multiplyBy(maxLo + 1).add(lo);
    if (log.isDebugEnabled()) {
      log.debug("new hi value: " + hiVal);
    }
  }
  return value.makeValueThenIncrement();
}
