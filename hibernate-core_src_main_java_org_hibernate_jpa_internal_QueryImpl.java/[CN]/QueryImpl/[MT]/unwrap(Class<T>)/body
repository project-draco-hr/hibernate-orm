{
  if (org.hibernate.Query.class.isAssignableFrom(tClass)) {
    return (T)query;
  }
  if (QueryImpl.class.isAssignableFrom(tClass)) {
    return (T)this;
  }
  if (HibernateQuery.class.isAssignableFrom(tClass)) {
    return (T)this;
  }
  throw new PersistenceException(String.format("Unsure how to unwrap %s impl [%s] as requested type [%s]",Query.class.getSimpleName(),this.getClass().getName(),tClass.getName()));
}
