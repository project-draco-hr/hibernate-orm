{
  final String eeOriginalIdPropertyPath=MIDDLE_ENTITY_ALIAS + "." + originalIdPropertyName;
  final QueryBuilder qb=new QueryBuilder(versionsMiddleEntityName,MIDDLE_ENTITY_ALIAS);
  qb.addFrom(referencedIdData.getAuditEntityName(),REFERENCED_ENTITY_ALIAS);
  qb.addFrom(indexIdData.getAuditEntityName(),INDEX_ENTITY_ALIAS);
  qb.addProjection("new list",MIDDLE_ENTITY_ALIAS + ", " + REFERENCED_ENTITY_ALIAS+ ", "+ INDEX_ENTITY_ALIAS,false,false);
  final Parameters rootParameters=qb.getRootParameters();
  referencedIdData.getPrefixedMapper().addIdsEqualToQuery(rootParameters,eeOriginalIdPropertyPath,referencedIdData.getOriginalMapper(),REFERENCED_ENTITY_ALIAS + "." + originalIdPropertyName);
  indexIdData.getPrefixedMapper().addIdsEqualToQuery(rootParameters,eeOriginalIdPropertyPath,indexIdData.getOriginalMapper(),INDEX_ENTITY_ALIAS + "." + originalIdPropertyName);
  referencingIdData.getPrefixedMapper().addNamedIdEqualsToQuery(rootParameters,originalIdPropertyName,true);
  return qb;
}
