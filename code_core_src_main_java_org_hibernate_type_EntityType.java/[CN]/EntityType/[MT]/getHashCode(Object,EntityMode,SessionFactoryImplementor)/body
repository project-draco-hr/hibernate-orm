{
  EntityPersister persister=factory.getEntityPersister(associatedEntityName);
  if (!persister.canExtractIdOutOfEntity()) {
    return super.getHashCode(x,entityMode);
  }
  final Serializable id;
  if (x instanceof HibernateProxy) {
    id=((HibernateProxy)x).getHibernateLazyInitializer().getIdentifier();
  }
 else {
    id=persister.getIdentifier(x,entityMode);
  }
  return persister.getIdentifierType().getHashCode(id,entityMode,factory);
}
