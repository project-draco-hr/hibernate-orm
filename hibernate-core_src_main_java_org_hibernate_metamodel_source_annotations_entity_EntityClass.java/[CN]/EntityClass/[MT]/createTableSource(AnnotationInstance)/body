{
  String schema=null;
  String catalog=null;
  if (tableAnnotation != null) {
    schema=JandexHelper.getValue(tableAnnotation,"schema",String.class);
    catalog=JandexHelper.getValue(tableAnnotation,"catalog",String.class);
  }
  String tableName=null;
  String logicalTableName=null;
  if (tableAnnotation != null) {
    logicalTableName=JandexHelper.getValue(tableAnnotation,"name",String.class);
    if (StringHelper.isNotEmpty(logicalTableName)) {
      tableName=logicalTableName;
    }
    createUniqueConstraints(tableAnnotation,tableName);
  }
  TableSourceImpl tableSourceImpl;
  if (tableAnnotation == null || JPADotNames.TABLE.equals(tableAnnotation.name())) {
    tableSourceImpl=new TableSourceImpl(schema,catalog,tableName,null);
  }
 else {
    tableSourceImpl=new TableSourceImpl(schema,catalog,tableName,logicalTableName);
  }
  return tableSourceImpl;
}
