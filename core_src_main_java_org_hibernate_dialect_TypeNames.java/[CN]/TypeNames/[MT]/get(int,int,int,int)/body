{
  Map map=(Map)weighted.get(new Integer(typecode));
  if (map != null && map.size() > 0) {
    Iterator entries=map.entrySet().iterator();
    while (entries.hasNext()) {
      Map.Entry entry=(Map.Entry)entries.next();
      if (size <= ((Integer)entry.getKey()).intValue()) {
        return replace((String)entry.getValue(),size,precision,scale);
      }
    }
  }
  return replace(get(typecode),size,precision,scale);
}
