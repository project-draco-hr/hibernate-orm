{
  Session session=openSession();
  session.setTenantIdentifier("jboss");
  session.beginTransaction();
  Customer steve=new Customer(1L,"steve");
  session.save(steve);
  session.getTransaction().commit();
  session.close();
  session=openSession();
  session.setTenantIdentifier("acme");
  session.beginTransaction();
  Customer john=new Customer(1L,"john");
  session.save(john);
  session.getTransaction().commit();
  session.close();
  sessionFactory.getStatisticsImplementor().clear();
{
    session=openSession();
    session.setTenantIdentifier("jboss");
    session.beginTransaction();
    Customer customer=(Customer)session.load(Customer.class,1L);
    Assert.assertEquals("steve",customer.getName());
    Assert.assertEquals(1,sessionFactory.getStatisticsImplementor().getSecondLevelCacheHitCount());
    session.getTransaction().commit();
    session.close();
  }
  sessionFactory.getStatisticsImplementor().clear();
{
    session=openSession();
    session.setTenantIdentifier("acme");
    session.beginTransaction();
    Customer customer=(Customer)session.load(Customer.class,1L);
    Assert.assertEquals("john",customer.getName());
    Assert.assertEquals(1,sessionFactory.getStatisticsImplementor().getSecondLevelCacheHitCount());
    session.getTransaction().commit();
    session.close();
  }
  sessionFactory.getStatisticsImplementor().clear();
  sessionFactory.getCache().evictEntityRegions();
{
    session=openSession();
    session.setTenantIdentifier("jboss");
    session.beginTransaction();
    Customer customer=(Customer)session.load(Customer.class,1L);
    Assert.assertEquals("steve",customer.getName());
    Assert.assertEquals(0,sessionFactory.getStatisticsImplementor().getSecondLevelCacheHitCount());
    session.getTransaction().commit();
    session.close();
  }
  sessionFactory.getStatisticsImplementor().clear();
{
    session=openSession();
    session.setTenantIdentifier("acme");
    session.beginTransaction();
    Customer customer=(Customer)session.load(Customer.class,1L);
    Assert.assertEquals("john",customer.getName());
    Assert.assertEquals(0,sessionFactory.getStatisticsImplementor().getSecondLevelCacheHitCount());
    session.getTransaction().commit();
    session.close();
  }
  session=openSession();
  session.setTenantIdentifier("jboss");
  session.beginTransaction();
  session.delete(steve);
  session.getTransaction().commit();
  session.close();
  session=openSession();
  session.setTenantIdentifier("acme");
  session.beginTransaction();
  session.delete(john);
  session.getTransaction().commit();
  session.close();
}
