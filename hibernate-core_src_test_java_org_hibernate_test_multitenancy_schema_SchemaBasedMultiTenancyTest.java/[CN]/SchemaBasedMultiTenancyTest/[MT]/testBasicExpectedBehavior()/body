{
  Session session=sessionFactory.withOptions().tenantIdentifier("jboss").openSession();
  session.beginTransaction();
  Customer steve=new Customer(1L,"steve");
  session.save(steve);
  session.getTransaction().commit();
  session.close();
  session=sessionFactory.withOptions().tenantIdentifier("acme").openSession();
  try {
    session.beginTransaction();
    Customer check=(Customer)session.get(Customer.class,steve.getId());
    Assert.assertNull("tenancy not properly isolated",check);
  }
  finally {
    session.getTransaction().commit();
    session.close();
  }
  session=sessionFactory.withOptions().tenantIdentifier("jboss").openSession();
  session.beginTransaction();
  session.delete(steve);
  session.getTransaction().commit();
  session.close();
}
