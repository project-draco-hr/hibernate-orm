{
  final String result;
  if (lockOptions == null || lockOptions.size() == 0) {
    result=sql;
  }
 else {
    Map aliasedLockOptions=new HashMap();
    Iterator iter=lockOptions.entrySet().iterator();
    while (iter.hasNext()) {
      Map.Entry me=(Map.Entry)iter.next();
      aliasedLockOptions.put(getAliasName((String)me.getKey()),me.getValue());
    }
    Map keyColumnNames=null;
    if (dialect.forUpdateOfColumns()) {
      keyColumnNames=new HashMap();
      for (int i=0; i < names.length; i++) {
        keyColumnNames.put(names[i],persisters[i].getIdentifierColumnNames());
      }
    }
    result=dialect.applyLocksToSql(sql,aliasedLockOptions,keyColumnNames);
  }
  logQuery(queryString,result);
  return result;
}
