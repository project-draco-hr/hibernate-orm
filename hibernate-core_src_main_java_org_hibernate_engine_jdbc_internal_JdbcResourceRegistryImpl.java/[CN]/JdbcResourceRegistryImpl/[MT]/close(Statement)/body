{
  LOG.tracev("Closing prepared statement [{0}]",statement);
  if (statement instanceof InvalidatableWrapper) {
    InvalidatableWrapper<Statement> wrapper=(InvalidatableWrapper<Statement>)statement;
    close(wrapper.getWrappedObject());
    wrapper.invalidate();
    return;
  }
  try {
    try {
      if (statement.getMaxRows() != 0) {
        statement.setMaxRows(0);
      }
      if (statement.getQueryTimeout() != 0) {
        statement.setQueryTimeout(0);
      }
    }
 catch (    SQLException sqle) {
      if (LOG.isDebugEnabled()) {
        LOG.debugf("Exception clearing maxRows/queryTimeout [%s]",sqle.getMessage());
      }
      return;
    }
    statement.close();
    if (lastQuery == statement) {
      lastQuery=null;
    }
  }
 catch (  SQLException sqle) {
    if (LOG.isDebugEnabled()) {
      LOG.debugf("Unable to release statement [%s]",sqle.getMessage());
    }
  }
}
