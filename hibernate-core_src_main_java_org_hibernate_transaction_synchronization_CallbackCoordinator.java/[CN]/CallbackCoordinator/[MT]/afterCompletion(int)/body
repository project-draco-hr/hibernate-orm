{
  LOG.transactionAfterCompletionCallback(status);
  try {
    afterCompletionAction.doAction(ctx,status);
    final boolean wasSuccessful=(status == Status.STATUS_COMMITTED);
    jdbcContext.afterTransactionCompletion(wasSuccessful,hibernateTransaction);
  }
  finally {
    reset();
    jdbcContext.cleanUpJtaSynchronizationCallbackCoordinator();
    if (ctx.shouldAutoClose() && !ctx.isClosed()) {
      LOG.automaticallyClosingSession();
      ctx.managedClose();
    }
  }
}
