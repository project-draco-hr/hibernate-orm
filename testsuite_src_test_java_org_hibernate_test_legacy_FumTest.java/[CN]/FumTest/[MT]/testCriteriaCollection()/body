{
  Session s=openSession();
  Fum fum=new Fum(fumKey("fum"));
  fum.setFum("a value");
  fum.getMapComponent().getFummap().put("self",fum);
  fum.getMapComponent().getStringmap().put("string","a staring");
  fum.getMapComponent().getStringmap().put("string2","a notha staring");
  fum.getMapComponent().setCount(1);
  s.save(fum);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  Fum b=(Fum)s.createCriteria(Fum.class).add(Restrictions.in("fum",new String[]{"a value","no value"})).uniqueResult();
  assertTrue(Hibernate.isInitialized(b.getMapComponent().getStringmap()));
  assertTrue(b.getMapComponent().getFummap().size() == 1);
  assertTrue(b.getMapComponent().getStringmap().size() == 2);
  s.delete(b);
  s.flush();
  s.connection().commit();
  s.close();
}
