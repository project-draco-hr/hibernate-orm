{
  final ConstPool constPool=classfile.getConstPool();
  final int callbackTypeIndex=constPool.addClassInfo(FIELD_HANDLER_TYPE_NAME);
  if ((typeName.charAt(0) == 'L') && (typeName.charAt(typeName.length() - 1) == ';') || (typeName.charAt(0) == '[')) {
    final int indexOfL=typeName.indexOf('L');
    String type;
    if (indexOfL == 0) {
      type=typeName.substring(1,typeName.length() - 1);
      type=type.replace('/','.');
    }
 else     if (indexOfL == -1) {
      type=typeName;
    }
 else {
      type=typeName.replace('/','.');
    }
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readObject","(Ljava/lang/Object;Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;",4);
      code.addCheckcast(type);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeObject","(Ljava/lang/Object;Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;",5);
      code.addCheckcast(type);
    }
  }
 else   if (typeName.equals("Z")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readBoolean","(Ljava/lang/Object;Ljava/lang/String;Z)Z",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeBoolean","(Ljava/lang/Object;Ljava/lang/String;ZZ)Z",5);
    }
  }
 else   if (typeName.equals("B")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readByte","(Ljava/lang/Object;Ljava/lang/String;B)B",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeByte","(Ljava/lang/Object;Ljava/lang/String;BB)B",5);
    }
  }
 else   if (typeName.equals("C")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readChar","(Ljava/lang/Object;Ljava/lang/String;C)C",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeChar","(Ljava/lang/Object;Ljava/lang/String;CC)C",5);
    }
  }
 else   if (typeName.equals("I")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readInt","(Ljava/lang/Object;Ljava/lang/String;I)I",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeInt","(Ljava/lang/Object;Ljava/lang/String;II)I",5);
    }
  }
 else   if (typeName.equals("S")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readShort","(Ljava/lang/Object;Ljava/lang/String;S)S",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeShort","(Ljava/lang/Object;Ljava/lang/String;SS)S",5);
    }
  }
 else   if (typeName.equals("D")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readDouble","(Ljava/lang/Object;Ljava/lang/String;D)D",5);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeDouble","(Ljava/lang/Object;Ljava/lang/String;DD)D",7);
    }
  }
 else   if (typeName.equals("F")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readFloat","(Ljava/lang/Object;Ljava/lang/String;F)F",4);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeFloat","(Ljava/lang/Object;Ljava/lang/String;FF)F",5);
    }
  }
 else   if (typeName.equals("J")) {
    if (isReadMethod) {
      code.addInvokeinterface(callbackTypeIndex,"readLong","(Ljava/lang/Object;Ljava/lang/String;J)J",5);
    }
 else {
      code.addInvokeinterface(callbackTypeIndex,"writeLong","(Ljava/lang/Object;Ljava/lang/String;JJ)J",7);
    }
  }
 else {
    throw new RuntimeException("bad type: " + typeName);
  }
}
