{
  final String name="itemJpaQueryWithLockModeAndHints";
  EntityManager em=getOrCreateEntityManager();
  em.getTransaction().begin();
  Query query=em.createNamedQuery(name);
  org.hibernate.Query hibernateQuery=((HibernateQuery)query).getHibernateQuery();
  assertNull(hibernateQuery.getFirstResult());
  assertNull(hibernateQuery.getMaxResults());
  assertEquals(FlushMode.AUTO,hibernateQuery.getFlushMode());
  assertEquals(CacheMode.IGNORE,hibernateQuery.getCacheMode());
  assertEquals(LockMode.PESSIMISTIC_WRITE,hibernateQuery.getLockOptions().getLockMode());
  assertEquals((Integer)3,hibernateQuery.getTimeout());
  query.setHint(QueryHints.HINT_TIMEOUT,10);
  em.getEntityManagerFactory().addNamedQuery(name,query);
  query=em.createNamedQuery(name);
  hibernateQuery=((HibernateQuery)query).getHibernateQuery();
  assertNull(hibernateQuery.getFirstResult());
  assertNull(hibernateQuery.getMaxResults());
  assertEquals(FlushMode.AUTO,hibernateQuery.getFlushMode());
  assertEquals(CacheMode.IGNORE,hibernateQuery.getCacheMode());
  assertEquals(LockMode.PESSIMISTIC_WRITE,hibernateQuery.getLockOptions().getLockMode());
  assertEquals((Integer)10,hibernateQuery.getTimeout());
  query.setHint(QueryHints.SPEC_HINT_TIMEOUT,10000);
  em.getEntityManagerFactory().addNamedQuery(name,query);
  query=em.createNamedQuery(name);
  hibernateQuery=((HibernateQuery)query).getHibernateQuery();
  assertNull(hibernateQuery.getFirstResult());
  assertNull(hibernateQuery.getMaxResults());
  assertEquals(FlushMode.AUTO,hibernateQuery.getFlushMode());
  assertEquals(CacheMode.IGNORE,hibernateQuery.getCacheMode());
  assertEquals(LockMode.PESSIMISTIC_WRITE,hibernateQuery.getLockOptions().getLockMode());
  assertEquals((Integer)10,hibernateQuery.getTimeout());
  query.setFirstResult(51);
  em.getEntityManagerFactory().addNamedQuery(name,query);
  query=em.createNamedQuery(name);
  hibernateQuery=((HibernateQuery)query).getHibernateQuery();
  assertEquals((Integer)51,hibernateQuery.getFirstResult());
  assertNull(hibernateQuery.getMaxResults());
  assertEquals(FlushMode.AUTO,hibernateQuery.getFlushMode());
  assertEquals(CacheMode.IGNORE,hibernateQuery.getCacheMode());
  assertEquals(LockMode.PESSIMISTIC_WRITE,hibernateQuery.getLockOptions().getLockMode());
  assertEquals((Integer)10,hibernateQuery.getTimeout());
  em.getTransaction().commit();
  em.close();
}
