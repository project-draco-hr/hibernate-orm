{
  final Citizen c1=new Citizen();
  c1.setFirstname("Emmanuel");
  c1.setLastname("Bernard");
  c1.setSsn("1234");
  final State france=new State();
  france.setName("Ile de France");
  c1.setState(france);
  final Citizen c2=new Citizen();
  c2.setFirstname("Gavin");
  c2.setLastname("King");
  c2.setSsn("000");
  final State australia=new State();
  australia.setName("Australia");
  c2.setState(australia);
  withTx(tm,new Callable<Void>(){
    @Override public Void call() throws Exception {
      Session s=openSession();
      Transaction tx=s.beginTransaction();
      s.persist(australia);
      s.persist(france);
      s.persist(c1);
      s.persist(c2);
      tx.commit();
      s.close();
      return null;
    }
  }
);
}
