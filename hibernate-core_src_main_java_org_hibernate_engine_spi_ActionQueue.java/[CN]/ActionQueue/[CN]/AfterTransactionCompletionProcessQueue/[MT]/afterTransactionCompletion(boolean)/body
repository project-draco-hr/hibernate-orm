{
  for (  AfterTransactionCompletionProcess process : processes) {
    try {
      process.doAfterTransactionCompletion(success,session);
    }
 catch (    CacheException ce) {
      LOG.unableToReleaseCacheLock(ce);
    }
catch (    Exception e) {
      throw new AssertionFailure("Exception releasing cache locks",e);
    }
  }
  processes.clear();
  if (session.getFactory().getSettings().isQueryCacheEnabled()) {
    session.getFactory().getUpdateTimestampsCache().invalidate(querySpacesToInvalidate.toArray(new String[querySpacesToInvalidate.size()]),session);
  }
  querySpacesToInvalidate.clear();
}
