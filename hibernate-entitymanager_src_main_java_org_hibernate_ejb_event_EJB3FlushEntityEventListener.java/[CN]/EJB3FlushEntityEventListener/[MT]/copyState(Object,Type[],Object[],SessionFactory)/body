{
  ClassMetadata metadata=sf.getClassMetadata(entity.getClass());
  Object[] newState=metadata.getPropertyValues(entity);
  int size=newState.length;
  boolean isDirty=false;
  for (int index=0; index < size; index++) {
    if (!types[index].isEqual(state[index],newState[index])) {
      isDirty=true;
      state[index]=newState[index];
    }
  }
  return isDirty;
}
