{
  Session s=openSession();
  Transaction t=s.beginTransaction();
  Simple simple=new Simple(Long.valueOf(10));
  simple.setName("Simple 1");
  s.save(simple);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  Query q=s.createQuery("from Simple s where s.name=?");
  q.setCacheRegion("foo");
  q.setCacheable(true);
  q.setString(0,"Simple 1");
  assertTrue(q.list().size() == 1);
  assertTrue(q.list().size() == 1);
  assertTrue(q.list().size() == 1);
  q=s.createQuery("from Simple s where s.name=:name");
  q.setCacheRegion("foo");
  q.setCacheable(true);
  q.setString("name","Simple 1");
  assertTrue(q.list().size() == 1);
  simple=(Simple)q.list().get(0);
  q.setString("name","Simple 2");
  assertTrue(q.list().size() == 0);
  assertTrue(q.list().size() == 0);
  simple.setName("Simple 2");
  assertTrue(q.list().size() == 1);
  assertTrue(q.list().size() == 1);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  s.update(simple);
  s.delete(simple);
  t.commit();
  s.close();
  s=openSession();
  t=s.beginTransaction();
  q=s.createQuery("from Simple s where s.name=?");
  q.setCacheRegion("foo");
  q.setCacheable(true);
  q.setString(0,"Simple 1");
  assertTrue(q.list().size() == 0);
  assertTrue(q.list().size() == 0);
  t.commit();
  s.close();
}
