{
  try {
    Blob blob=createBlob();
    OutputStream byteStream=blob.setBinaryStream(1);
    StreamUtils.copy(inputStream,byteStream);
    byteStream.flush();
    byteStream.close();
    return blob;
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Unable to prepare BLOB binary stream for writing",e);
  }
catch (  IOException e) {
    throw new IllegalStateException("Unable to write stream contents to BLOB",e);
  }
}
