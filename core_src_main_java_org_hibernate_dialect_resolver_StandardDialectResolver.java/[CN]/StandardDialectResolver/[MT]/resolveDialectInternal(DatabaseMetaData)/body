{
  String databaseName=metaData.getDatabaseProductName();
  int databaseMajorVersion=metaData.getDatabaseMajorVersion();
  if ("HSQL Database Engine".equals(databaseName)) {
    return new HSQLDialect();
  }
  if ("H2".equals(databaseName)) {
    return new H2Dialect();
  }
  if ("MySQL".equals(databaseName)) {
    return new MySQLDialect();
  }
  if ("PostgreSQL".equals(databaseName)) {
    return new PostgreSQLDialect();
  }
  if ("Apache Derby".equals(databaseName)) {
    return new DerbyDialect();
  }
  if ("ingres".equalsIgnoreCase(databaseName)) {
switch (databaseMajorVersion) {
case 9:
      int databaseMinorVersion=metaData.getDatabaseMinorVersion();
    if (databaseMinorVersion > 2) {
      return new Ingres9Dialect();
    }
  return new IngresDialect();
case 10:
log.warn("Ingres " + databaseMajorVersion + " is not yet fully supported; using Ingres 9.3 dialect");
return new Ingres10Dialect();
default :
log.warn("Unknown Ingres major version [" + databaseMajorVersion + "] using Ingres 9.2 dialect");
}
return new IngresDialect();
}
if (databaseName.startsWith("Microsoft SQL Server")) {
return new SQLServerDialect();
}
if ("Sybase SQL Server".equals(databaseName) || "Adaptive Server Enterprise".equals(databaseName)) {
return new SybaseASE15Dialect();
}
if (databaseName.startsWith("Adaptive Server Anywhere")) {
return new SybaseAnywhereDialect();
}
if ("Informix Dynamic Server".equals(databaseName)) {
return new InformixDialect();
}
if (databaseName.startsWith("DB2/")) {
return new DB2Dialect();
}
if ("Oracle".equals(databaseName)) {
switch (databaseMajorVersion) {
case 11:
log.warn("Oracle 11g is not yet fully supported; using 10g dialect");
return new Oracle10gDialect();
case 10:
return new Oracle10gDialect();
case 9:
return new Oracle9iDialect();
case 8:
return new Oracle8iDialect();
default :
log.warn("unknown Oracle major version [" + databaseMajorVersion + "]");
}
}
return null;
}
