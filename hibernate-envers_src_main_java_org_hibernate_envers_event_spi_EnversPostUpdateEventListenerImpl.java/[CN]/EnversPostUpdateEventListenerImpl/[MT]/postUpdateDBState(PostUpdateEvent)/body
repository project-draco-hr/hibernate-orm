{
  final Object[] newDbState=event.getState().clone();
  if (event.getOldState() != null) {
    final EntityPersister entityPersister=event.getPersister();
    for (int i=0; i < entityPersister.getPropertyNames().length; ++i) {
      if (!entityPersister.getPropertyUpdateability()[i]) {
        newDbState[i]=event.getOldState()[i];
      }
    }
  }
  return newDbState;
}
