{
  final String entityName=event.getPersister().getEntityName();
  if (getEnversService().getEntitiesConfigurations().isVersioned(entityName)) {
    checkIfTransactionInProgress(event.getSession());
    final AuditProcess auditProcess=getEnversService().getAuditProcessManager().get(event.getSession());
    final Object[] newDbState=postUpdateDBState(event);
    final AuditWorkUnit workUnit=new ModWorkUnit(event.getSession(),event.getPersister().getEntityName(),getEnversService(),event.getId(),event.getPersister(),newDbState,event.getOldState());
    auditProcess.addWorkUnit(workUnit);
    if (workUnit.containsWork()) {
      generateBidirectionalCollectionChangeWorkUnits(auditProcess,event.getPersister(),entityName,newDbState,event.getOldState(),event.getSession());
    }
  }
}
