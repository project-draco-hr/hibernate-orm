{
  this.dialect=dialect;
  this.sqlExceptionHelper=buildSqlExceptionHelper(dialect);
  this.extractedMetaDataSupport=new ExtractedDatabaseMetaDataImpl.Builder(this).apply(databaseMetaData).setConnectionSchemaName(determineCurrentSchemaName(databaseMetaData,serviceRegistry,dialect)).build();
  NameQualifierSupport nameQualifierSupport=dialect.getNameQualifierSupport();
  if (nameQualifierSupport == null) {
    nameQualifierSupport=determineNameQualifierSupport(databaseMetaData);
  }
  for (  String keyword : dialect.getKeywords()) {
    reservedWords.add(keyword.toUpperCase(Locale.ROOT));
  }
  reservedWords.addAll(extractedMetaDataSupport.getExtraKeywords());
  final boolean globallyQuoteIdentifiers=serviceRegistry.getService(ConfigurationService.class).getSetting(AvailableSettings.GLOBALLY_QUOTED_IDENTIFIERS,StandardConverters.BOOLEAN,false);
  this.identifierHelper=new NormalizingIdentifierHelperImpl(this,nameQualifierSupport,globallyQuoteIdentifiers,databaseMetaData.storesMixedCaseQuotedIdentifiers(),databaseMetaData.storesLowerCaseQuotedIdentifiers(),databaseMetaData.storesUpperCaseQuotedIdentifiers(),databaseMetaData.storesMixedCaseIdentifiers(),databaseMetaData.storesUpperCaseIdentifiers(),databaseMetaData.storesLowerCaseIdentifiers());
  this.currentCatalog=identifierHelper.toIdentifier(extractedMetaDataSupport.getConnectionCatalogName());
  this.currentSchema=identifierHelper.toIdentifier(extractedMetaDataSupport.getConnectionSchemaName());
  this.qualifiedObjectNameFormatter=new QualifiedObjectNameFormatterStandardImpl(nameQualifierSupport,databaseMetaData);
  this.typeInfoSet.addAll(TypeInfo.extractTypeInfo(databaseMetaData));
  this.lobCreatorBuilder=LobCreatorBuilderImpl.makeLobCreatorBuilder(serviceRegistry.getService(ConfigurationService.class).getSettings(),databaseMetaData.getConnection());
}
