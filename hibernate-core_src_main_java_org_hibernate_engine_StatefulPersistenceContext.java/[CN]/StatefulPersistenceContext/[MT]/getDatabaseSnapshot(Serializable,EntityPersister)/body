{
  EntityKey key=new EntityKey(id,persister,session.getEntityMode());
  Object cached=entitySnapshotsByKey.get(key);
  if (cached != null) {
    return cached == NO_ROW ? null : (Object[])cached;
  }
 else {
    Object[] snapshot=persister.getDatabaseSnapshot(id,session);
    entitySnapshotsByKey.put(key,snapshot == null ? NO_ROW : snapshot);
    return snapshot;
  }
}
