{
  SimpleJtaTransactionManagerImpl.getInstance().begin();
  Session s=openSession();
  Node parent=new Node("parent");
  Node child=new Node("child");
  parent.getCascadingChildren().add(child);
  s.persist(parent);
  SimpleJtaTransactionManagerImpl.getInstance().commit();
  clearCounts();
  SimpleJtaTransactionManagerImpl.getInstance().begin();
  s=openSession();
  parent=(Node)s.get(Node.class,"parent");
  s=applyNonFlushedChangesToNewSessionCloseOldSession(s);
  parent=(Node)getOldToNewEntityRefMap().get(parent);
  s.delete(parent);
  applyNonFlushedChangesToNewSessionCloseOldSession(s);
  SimpleJtaTransactionManagerImpl.getInstance().commit();
  assertUpdateCount(0);
  assertInsertCount(0);
  assertDeleteCount(2);
}
