{
  if (queryLoader != null) {
    return queryLoader;
  }
 else   if (isAffectedByEnabledFilters(session)) {
    return createEntityLoader(lockOptions,session.getLoadQueryInfluencers());
  }
 else   if (session.getLoadQueryInfluencers().getInternalFetchProfile() != null && LockMode.UPGRADE.greaterThan(lockOptions.getLockMode())) {
    return (UniqueEntityLoader)getLoaders().get(session.getLoadQueryInfluencers().getInternalFetchProfile());
  }
 else   if (isAffectedByEnabledFetchProfiles(session)) {
    return createEntityLoader(lockOptions,session.getLoadQueryInfluencers());
  }
 else   if (lockOptions.getTimeOut() != LockOptions.WAIT_FOREVER) {
    return createEntityLoader(lockOptions,session.getLoadQueryInfluencers());
  }
 else {
    return (UniqueEntityLoader)getLoaders().get(lockOptions.getLockMode());
  }
}
