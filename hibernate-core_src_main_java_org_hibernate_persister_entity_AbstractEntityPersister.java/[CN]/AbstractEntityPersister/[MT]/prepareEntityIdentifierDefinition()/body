{
  final Type idType=getIdentifierType();
  if (!idType.isComponentType()) {
    entityIdentifierDefinition=buildEncapsulatedIdentifierDefinition();
    return;
  }
  final CompositeType cidType=(CompositeType)idType;
  if (!cidType.isEmbedded()) {
    entityIdentifierDefinition=buildEncapsulatedIdentifierDefinition();
    return;
  }
  entityIdentifierDefinition=new NonEncapsulatedEntityIdentifierDefinition(){
    @Override public Iterable<AttributeDefinition> getAttributes(){
      throw new NotYetImplementedException();
    }
    @Override public Class getSeparateIdentifierMappingClass(){
      throw new NotYetImplementedException();
    }
    @Override public boolean isEncapsulated(){
      return false;
    }
    @Override public EntityDefinition getEntityDefinition(){
      return AbstractEntityPersister.this;
    }
  }
;
}
