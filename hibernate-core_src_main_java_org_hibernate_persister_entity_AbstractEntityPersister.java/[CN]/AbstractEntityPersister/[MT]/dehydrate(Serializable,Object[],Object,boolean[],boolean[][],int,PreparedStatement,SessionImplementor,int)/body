{
  if (LOG.isTraceEnabled())   LOG.trace("Dehydrating entity: " + MessageHelper.infoString(this,id,getFactory()));
  for (int i=0; i < entityMetamodel.getPropertySpan(); i++) {
    if (includeProperty[i] && isPropertyOfTable(i,j)) {
      getPropertyTypes()[i].nullSafeSet(ps,fields[i],index,includeColumns[i],session);
      index+=ArrayHelper.countTrue(includeColumns[i]);
    }
  }
  if (rowId != null) {
    ps.setObject(index,rowId);
    index+=1;
  }
 else   if (id != null) {
    getIdentifierType().nullSafeSet(ps,id,index,session);
    index+=getIdentifierColumnSpan();
  }
  return index;
}
