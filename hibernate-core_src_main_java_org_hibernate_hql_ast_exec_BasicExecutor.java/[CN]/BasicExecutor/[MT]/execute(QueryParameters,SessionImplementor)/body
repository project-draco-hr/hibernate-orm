{
  coordinateSharedCacheCleanup(session);
  PreparedStatement st=null;
  RowSelection selection=parameters.getRowSelection();
  try {
    try {
      st=session.getJDBCContext().getConnectionManager().prepareStatement(sql,false);
      Iterator parameterSpecifications=this.parameterSpecifications.iterator();
      int pos=1;
      while (parameterSpecifications.hasNext()) {
        final ParameterSpecification paramSpec=(ParameterSpecification)parameterSpecifications.next();
        pos+=paramSpec.bind(st,parameters,session,pos);
      }
      if (selection != null) {
        if (selection.getTimeout() != null) {
          st.setQueryTimeout(selection.getTimeout().intValue());
        }
      }
      return st.executeUpdate();
    }
  finally {
      if (st != null) {
        st.close();
      }
    }
  }
 catch (  SQLException sqle) {
    throw getFactory().getSQLExceptionHelper().convert(sqle,"could not execute update query",sql);
  }
}
