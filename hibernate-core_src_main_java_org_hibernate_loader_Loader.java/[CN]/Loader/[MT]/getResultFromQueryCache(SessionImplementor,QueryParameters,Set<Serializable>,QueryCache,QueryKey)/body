{
  List result=null;
  final Type[] returnTypes=getReturnTypes();
  if (session.getCacheMode().isGetEnabled()) {
    boolean isImmutableNaturalKeyLookup=queryParameters.isNaturalKeyLookup() && returnTypes.length == 1 && returnTypes[0].isEntityType() && getEntityPersister(EntityType.class.cast(returnTypes[0])).getEntityMetamodel().hasImmutableNaturalId();
    final PersistenceContext persistenceContext=session.getPersistenceContext();
    boolean defaultReadOnlyOrig=persistenceContext.isDefaultReadOnly();
    if (queryParameters.isReadOnlyInitialized()) {
      persistenceContext.setDefaultReadOnly(queryParameters.isReadOnly());
    }
 else {
      queryParameters.setReadOnly(persistenceContext.isDefaultReadOnly());
    }
    try {
      result=queryCache.get(key,key.getResultTransformer().getCachedResultTypes(returnTypes),isImmutableNaturalKeyLookup,querySpaces,session);
    }
  finally {
      persistenceContext.setDefaultReadOnly(defaultReadOnlyOrig);
    }
    if (factory.getStatistics().isStatisticsEnabled()) {
      if (result == null) {
        factory.getStatisticsImplementor().queryCacheMiss(getQueryIdentifier(),queryCache.getRegion().getName());
      }
 else {
        factory.getStatisticsImplementor().queryCacheHit(getQueryIdentifier(),queryCache.getRegion().getName());
      }
    }
  }
  return result;
}
