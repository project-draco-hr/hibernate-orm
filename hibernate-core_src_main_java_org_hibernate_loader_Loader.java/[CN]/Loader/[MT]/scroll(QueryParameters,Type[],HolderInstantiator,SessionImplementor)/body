{
  checkScrollability();
  final boolean stats=getQueryIdentifier() != null && getFactory().getStatistics().isStatisticsEnabled();
  long startTime=0;
  if (stats)   startTime=System.currentTimeMillis();
  try {
    final SqlStatementWrapper wrapper=executeQueryStatement(queryParameters,true,Collections.<AfterLoadAction>emptyList(),session);
    final ResultSet rs=wrapper.getResultSet();
    final PreparedStatement st=(PreparedStatement)wrapper.getStatement();
    if (stats) {
      getFactory().getStatisticsImplementor().queryExecuted(getQueryIdentifier(),0,System.currentTimeMillis() - startTime);
    }
    if (needsFetchingScroll()) {
      return new FetchingScrollableResultsImpl(rs,st,session,this,queryParameters,returnTypes,holderInstantiator);
    }
 else {
      return new ScrollableResultsImpl(rs,st,session,this,queryParameters,returnTypes,holderInstantiator);
    }
  }
 catch (  SQLException sqle) {
    throw factory.getSQLExceptionHelper().convert(sqle,"could not execute query using scroll",getSQLString());
  }
}
