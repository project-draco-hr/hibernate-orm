{
  if (dialect.useFollowOnLocking()) {
    final LockMode lockMode=determineFollowOnLockMode(parameters.getLockOptions());
    final LockOptions lockOptions=new LockOptions(lockMode);
    if (lockOptions.getLockMode() != LockMode.UPGRADE_SKIPLOCKED) {
      LOG.usingFollowOnLocking();
      lockOptions.setTimeOut(parameters.getLockOptions().getTimeOut());
      lockOptions.setScope(parameters.getLockOptions().getScope());
      afterLoadActions.add(new AfterLoadAction(){
        @Override public void afterLoad(        SessionImplementor session,        Object entity,        Loadable persister){
          ((Session)session).buildLockRequest(lockOptions).lock(persister.getEntityName(),entity);
        }
      }
);
      parameters.setLockOptions(new LockOptions());
      return true;
    }
  }
  return false;
}
