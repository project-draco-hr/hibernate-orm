{
  if (ResultSetIdentifierConsumer.class.isInstance(type)) {
    return ((ResultSetIdentifierConsumer)type).consumeIdentifier(rs);
  }
  if (CustomType.class.isInstance(type)) {
    final CustomType customType=(CustomType)type;
    if (ResultSetIdentifierConsumer.class.isInstance(customType.getUserType())) {
      return ((ResultSetIdentifierConsumer)customType.getUserType()).consumeIdentifier(rs);
    }
  }
  Class clazz=type.getReturnedClass();
  if (clazz == Long.class) {
    return new Long(rs.getLong(1));
  }
 else   if (clazz == Integer.class) {
    return new Integer(rs.getInt(1));
  }
 else   if (clazz == Short.class) {
    return new Short(rs.getShort(1));
  }
 else   if (clazz == String.class) {
    return rs.getString(1);
  }
 else {
    throw new IdentifierGenerationException("this id generator generates long, integer, short or string");
  }
}
