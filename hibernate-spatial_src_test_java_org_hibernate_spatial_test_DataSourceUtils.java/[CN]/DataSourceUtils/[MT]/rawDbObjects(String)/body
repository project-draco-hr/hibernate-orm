{
  Map<Integer,Object> map=new HashMap<Integer,Object>();
  Connection cn=null;
  try {
    cn=getDataSource().getConnection();
    PreparedStatement pstmt=cn.prepareStatement("select id, geom from geomtest where type = ? order by id");
    pstmt.setString(1,type);
    ResultSet results=pstmt.executeQuery();
    while (results.next()) {
      Integer id=results.getInt(1);
      Object obj=results.getObject(2);
      map.put(id,obj);
    }
  }
 catch (  SQLException e) {
    e.printStackTrace();
  }
 finally {
    try {
      if (cn != null)       cn.close();
    }
 catch (    SQLException e) {
    }
  }
  return map;
}
