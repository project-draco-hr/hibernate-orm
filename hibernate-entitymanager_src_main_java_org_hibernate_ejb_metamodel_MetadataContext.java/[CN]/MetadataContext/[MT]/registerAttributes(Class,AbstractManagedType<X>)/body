{
  if (!processedMetamodelClasses.add(metamodelClass)) {
    return;
  }
  for (  Attribute<X,?> attribute : managedType.getDeclaredAttributes()) {
    registerAttribute(metamodelClass,attribute);
  }
  if (IdentifiableType.class.isInstance(managedType)) {
    final AbstractIdentifiableType<X> entityType=(AbstractIdentifiableType<X>)managedType;
    if (entityType.hasDeclaredVersionAttribute()) {
      registerAttribute(metamodelClass,entityType.getDeclaredVersion());
    }
    if (!entityType.hasSingleIdAttribute()) {
      final Set<SingularAttribute<? super X,?>> attributes=entityType.getIdClassAttributes();
      if (attributes != null) {
        for (        SingularAttribute<? super X,?> attribute : attributes) {
          registerAttribute(metamodelClass,attribute);
        }
      }
    }
  }
}
