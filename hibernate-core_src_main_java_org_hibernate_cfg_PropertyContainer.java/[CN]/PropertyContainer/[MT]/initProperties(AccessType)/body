{
  if (!(AccessType.PROPERTY.equals(access) || AccessType.FIELD.equals(access))) {
    throw new IllegalArgumentException("Access type has to be AccessType.FIELD or AccessType.Property");
  }
  TreeMap<String,XProperty> propertiesMap=new TreeMap<String,XProperty>();
  List<XProperty> properties=xClass.getDeclaredProperties(access.getType());
  for (  XProperty property : properties) {
    if (mustBeSkipped(property)) {
      continue;
    }
    XProperty oldProperty=propertiesMap.get(property.getName());
    if (oldProperty != null) {
      throw LOG.throwAmbiguousPropertyException(this.xClass,oldProperty.getName(),oldProperty.getType(),property.getType());
    }
    propertiesMap.put(property.getName(),property);
  }
  return propertiesMap;
}
