{
  if (globallyQuoteIdentifiers) {
    return Identifier.toIdentifier(text,true);
  }
  final boolean isUpperCase=text.toUpperCase(Locale.ROOT).equals(text);
  final boolean isLowerCase=text.toLowerCase(Locale.ROOT).equals(text);
  final boolean isMixedCase=!isLowerCase && !isUpperCase;
  if (jdbcEnvironment.isReservedWord(text)) {
    return Identifier.toIdentifier(text,true);
  }
  if (storesMixedCaseQuotedIdentifiers && isMixedCase) {
    return Identifier.toIdentifier(text,true);
  }
  if (storesLowerCaseQuotedIdentifiers && isLowerCase) {
    return Identifier.toIdentifier(text,true);
  }
  if (storesUpperCaseQuotedIdentifiers && isUpperCase) {
    return Identifier.toIdentifier(text,true);
  }
  return Identifier.toIdentifier(text);
}
