{
  if (tableName == null || tableName.equals(getPrimaryTableName())) {
    return primaryTable;
  }
  TableSpecification tableSpec=secondaryTables.get(tableName);
  if (tableSpec == null) {
    throw new AssertionFailure(String.format("Unable to find table %s amongst tables %s",tableName,secondaryTables.keySet()));
  }
  return tableSpec;
}
