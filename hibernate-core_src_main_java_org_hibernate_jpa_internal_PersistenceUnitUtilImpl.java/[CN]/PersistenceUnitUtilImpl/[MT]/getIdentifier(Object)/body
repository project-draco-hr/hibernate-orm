{
  final Class entityClass=Hibernate.getClass(entity);
  final EntityPersister persister=sessionFactory.getMetamodel().entityPersister(entityClass);
  if (persister == null) {
    throw new IllegalArgumentException(entityClass + " is not an entity");
  }
  return persister.getIdentifier(entity);
}
