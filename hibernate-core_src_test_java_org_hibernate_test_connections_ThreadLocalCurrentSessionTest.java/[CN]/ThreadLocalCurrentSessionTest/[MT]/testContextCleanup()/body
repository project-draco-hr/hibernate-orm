{
  Session session=sessionFactory().getCurrentSession();
  session.beginTransaction();
  session.getTransaction().commit();
  assertFalse("session open after txn completion",session.isOpen());
  assertFalse("session still bound afterQuery txn completion",TestableThreadLocalContext.isSessionBound(session));
  Session session2=sessionFactory().getCurrentSession();
  assertFalse("same session returned afterQuery txn completion",session == session2);
  session2.close();
  assertFalse("session open afterQuery closing",session2.isOpen());
  assertFalse("session still bound afterQuery closing",TestableThreadLocalContext.isSessionBound(session2));
}
