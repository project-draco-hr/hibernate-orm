{
  if (scrollable && !factory.getSettings().isScrollableResultSetsEnabled()) {
    throw new AssertionFailure("scrollable result sets are not enabled");
  }
  sql=getSQL(sql);
  log(sql);
  log.trace("preparing callable statement");
  if (scrollable) {
    return conn.prepareCall(sql,ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
  }
 else {
    return conn.prepareCall(sql);
  }
}
