{
  EntityManager em=getOrCreateEntityManager();
  em.getTransaction().begin();
  Lock lock=new Lock("name");
  em.persist(lock);
  em.getTransaction().commit();
  em.close();
  Integer initial=lock.getVersion();
  assertNotNull(initial);
  em=getOrCreateEntityManager();
  em.getTransaction().begin();
  Lock reread=em.createQuery("from Lock_",Lock.class).setLockMode(LockModeType.PESSIMISTIC_FORCE_INCREMENT).getSingleResult();
  em.getTransaction().commit();
  em.close();
  assertFalse(reread.getVersion().equals(initial));
  em=getOrCreateEntityManager();
  em.getTransaction().begin();
  em.remove(em.getReference(Lock.class,reread.getId()));
  em.getTransaction().commit();
  em.close();
}
