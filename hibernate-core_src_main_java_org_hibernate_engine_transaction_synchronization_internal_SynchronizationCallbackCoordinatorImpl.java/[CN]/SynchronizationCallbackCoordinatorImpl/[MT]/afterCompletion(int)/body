{
  if (settings.isJtaTrackByThread() && !isRegistrationThread() && JtaStatusHelper.isRollback(status)) {
    LOG.warnv("Transaction afterCompletion called by a background thread! Delaying action until the original thread can handle it. [status={0}]",status);
    delayedCompletionHandlingStatus=status;
  }
 else {
    doAfterCompletion(status);
  }
}
