{
  LOG.trace("Transaction after completion callback [status=" + status + "]");
  if (transactionContext().isClosed()) {
    LOG.debug("Transaction context was closed prior to synchronization callback");
    return;
  }
  try {
    afterCompletionAction.doAction(transactionCoordinator,status);
    transactionCoordinator.afterTransaction(null,status);
  }
  finally {
    reset();
    if (transactionContext().shouldAutoClose() && !transactionContext().isClosed()) {
      LOG.trace("Automatically closing session");
      transactionContext().managedClose();
    }
  }
}
