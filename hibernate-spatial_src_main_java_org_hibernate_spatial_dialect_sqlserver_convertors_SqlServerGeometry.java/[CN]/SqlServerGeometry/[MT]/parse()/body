{
  srid=buffer.getInt();
  version=buffer.get();
  if (!isCompatible()) {
    throw new IllegalStateException("Version mismatch. Expected version " + SUPPORTED_VERSION + ", but received version "+ version);
  }
  serializationPropertiesByte=buffer.get();
  determineNumberOfPoints();
  readPoints();
  if (hasZValues()) {
    readZValues();
  }
  if (hasMValues()) {
    readMValues();
  }
  if (isSingleLineSegment() || isSinglePoint()) {
    setNumberOfFigures(1);
    setFigure(0,new Figure(FigureAttribute.Stroke,0));
    setNumberOfShapes(1);
    OpenGisType gisType=isSinglePoint() ? OpenGisType.POINT : OpenGisType.LINESTRING;
    setShape(0,new Shape(-1,0,gisType));
    return;
  }
  readFigures();
  readShapes();
}
