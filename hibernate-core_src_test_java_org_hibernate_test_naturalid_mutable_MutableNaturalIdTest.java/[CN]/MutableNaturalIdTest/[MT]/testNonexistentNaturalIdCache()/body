{
  sessionFactory().getStatistics().clear();
  Session s=openSession();
  Transaction t=s.beginTransaction();
  Object nullUser=s.createCriteria(User.class).add(Restrictions.naturalId().set("name","gavin").set("org","hb")).setCacheable(true).uniqueResult();
  assertNull(nullUser);
  t.commit();
  s.close();
  assertEquals(1,sessionFactory().getStatistics().getNaturalIdQueryExecutionCount(),1);
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCacheHitCount(),0);
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCachePutCount(),0);
  s=openSession();
  t=s.beginTransaction();
  User u=new User("gavin","hb","secret");
  s.persist(u);
  t.commit();
  s.close();
  sessionFactory().getStatistics().clear();
  s=openSession();
  t=s.beginTransaction();
  u=(User)s.createCriteria(User.class).add(Restrictions.naturalId().set("name","gavin").set("org","hb")).setCacheable(true).uniqueResult();
  assertNotNull(u);
  t.commit();
  s.close();
  assertEquals(1,sessionFactory().getStatistics().getNaturalIdQueryExecutionCount());
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCacheHitCount());
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCachePutCount());
  sessionFactory().getStatistics().clear();
  s=openSession();
  t=s.beginTransaction();
  u=(User)s.createCriteria(User.class).add(Restrictions.naturalId().set("name","gavin").set("org","hb")).setCacheable(true).uniqueResult();
  s.delete(u);
  t.commit();
  s.close();
  assertEquals(1,sessionFactory().getStatistics().getNaturalIdQueryExecutionCount());
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCacheHitCount());
  sessionFactory().getStatistics().clear();
  s=openSession();
  t=s.beginTransaction();
  nullUser=s.createCriteria(User.class).add(Restrictions.naturalId().set("name","gavin").set("org","hb")).setCacheable(true).uniqueResult();
  assertNull(nullUser);
  t.commit();
  s.close();
  assertEquals(1,sessionFactory().getStatistics().getNaturalIdQueryExecutionCount());
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCacheHitCount());
  assertEquals(0,sessionFactory().getStatistics().getNaturalIdCachePutCount());
}
