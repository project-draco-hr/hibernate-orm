{
  Session s=openSession();
  s.beginTransaction();
  Foo foo=new Foo();
  s.save(foo);
  foo.setString("dirty");
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.beginTransaction();
  Foo foo2=new Foo();
  s.load(foo2,foo.getKey());
  assertTrue("create-update",foo.equalsFoo(foo2));
  s.delete(foo2);
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.beginTransaction();
  foo=new Foo();
  s.save(foo,"assignedid");
  foo.setString("dirty");
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.beginTransaction();
  s.load(foo2,"assignedid");
  assertTrue("create-update",foo.equalsFoo(foo2));
  s.delete(foo2);
  s.getTransaction().commit();
  s.close();
}
