{
  Session s=openSession();
  One one=new One();
  BarProxy foo=new Bar();
  foo.setObject(one);
  Serializable fid=s.save(foo);
  Serializable oid=one.getKey();
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  assertTrue(s.find("from Bar bar where bar.object.id = ? and bar.object.class = ?",new Object[]{oid,new Character('O')},new Type[]{Hibernate.LONG,Hibernate.CHARACTER}).size() == 1);
  assertTrue(s.find("select one from One one, Bar bar where bar.object.id = one.id and bar.object.class = 'O'").size() == 1);
  s.flush();
  s.connection().commit();
  s.close();
  s=openSession();
  foo=(BarProxy)s.load(Foo.class,fid);
  assertTrue(foo.getObject() != null && foo.getObject() instanceof One && s.getIdentifier(foo.getObject()).equals(oid));
  s.delete(foo);
  s.flush();
  s.connection().commit();
  s.close();
}
