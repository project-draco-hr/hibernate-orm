{
  Session s=openSession();
  s.beginTransaction();
  Foo foo=new Foo();
  Foo foo2=new Foo();
  s.save(foo);
  s.save(foo2);
  foo2.setFoo(foo);
  s.getTransaction().commit();
  s.disconnect();
  s.reconnect();
  s.beginTransaction();
  s.delete(foo);
  foo2.setFoo(null);
  s.getTransaction().commit();
  s.disconnect();
  s.reconnect();
  s.beginTransaction();
  s.delete(foo2);
  s.getTransaction().commit();
  s.close();
}
