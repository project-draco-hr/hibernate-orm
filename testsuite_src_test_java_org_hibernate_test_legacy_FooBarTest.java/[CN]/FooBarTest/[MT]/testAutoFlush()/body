{
  Session s=openSession();
  Transaction txn=s.beginTransaction();
  FooProxy foo=new Foo();
  s.save(foo);
  assertTrue("autoflush create",s.find("from Foo foo").size() == 1);
  foo.setChar(new Character('X'));
  assertTrue("autoflush update",s.find("from Foo foo where foo.char='X'").size() == 1);
  txn.commit();
  s.close();
  s=openSession();
  txn=s.beginTransaction();
  foo=(FooProxy)s.load(Foo.class,foo.getKey());
  if (!(getDialect() instanceof MySQLDialect) && !(getDialect() instanceof HSQLDialect) && !(getDialect() instanceof PointbaseDialect)) {
    foo.setBytes("osama".getBytes());
    assertTrue("autoflush collection update",s.find("from Foo foo where 111 in elements(foo.bytes)").size() == 1);
    foo.getBytes()[0]=69;
    assertTrue("autoflush collection update",s.find("from Foo foo where 69 in elements(foo.bytes)").size() == 1);
  }
  s.delete(foo);
  assertTrue("autoflush delete",s.find("from Foo foo").size() == 0);
  txn.commit();
  s.close();
}
