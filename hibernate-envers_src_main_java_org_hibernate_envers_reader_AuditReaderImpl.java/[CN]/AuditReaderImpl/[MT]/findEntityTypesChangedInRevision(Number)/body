{
  checkNotNull(revision,"Entity revision");
  checkPositive(revision,"Entity revision");
  checkSession();
  if (!verCfg.getGlobalCfg().isTrackEntitiesChangedInRevisionEnabled()) {
    throw new AuditException("This query is designed for Envers default mechanism of tracking entities modified in a given revision." + " Extend DefaultTrackingModifiedTypesRevisionEntity, utilize @ModifiedEntityNames annotation or set " + "'org.hibernate.envers.track_entities_changed_in_revision' parameter to true.");
  }
  Set<Number> revisions=new HashSet<Number>(1);
  revisions.add(revision);
  Criteria query=verCfg.getRevisionInfoQueryCreator().getRevisionsQuery(session,revisions);
  Object revisionInfo=query.uniqueResult();
  if (revisionInfo != null) {
    Set<String> modifiedEntityNames=(Set<String>)ReflectionTools.getAnnotatedMembersValues(revisionInfo,ModifiedEntityNames.class).values().toArray()[0];
    Set<Class> result=new HashSet<Class>(modifiedEntityNames.size());
    for (    String entityName : modifiedEntityNames) {
      try {
        result.add(Class.forName(entityName));
      }
 catch (      ClassNotFoundException e) {
        throw new RuntimeException(e);
      }
    }
    return result;
  }
  return Collections.EMPTY_SET;
}
