{
  checkNotNull(revision,"Entity revision");
  checkPositive(revision,"Entity revision");
  checkSession();
  if (!verCfg.getGlobalCfg().isTrackEntitiesChangedInRevisionEnabled()) {
    throw new AuditException("This query is designed for Envers default mechanism of tracking entities modified in a given revision." + " Extend DefaultTrackingModifiedEntitiesRevisionEntity, utilize @ModifiedEntityNames annotation or set " + "'org.hibernate.envers.track_entities_changed_in_revision' parameter to true.");
  }
  Set<Number> revisions=new HashSet<Number>(1);
  revisions.add(revision);
  Criteria query=verCfg.getRevisionInfoQueryCreator().getRevisionsQuery(session,revisions);
  Object revisionInfo=query.uniqueResult();
  if (revisionInfo != null) {
    Set<String> entityNames=verCfg.getModifiedEntityNamesReader().getModifiedEntityNames(revisionInfo);
    if (entityNames != null) {
      Set<Pair<String,Class>> result=new HashSet<Pair<String,Class>>();
      for (      String entityName : entityNames) {
        result.add(Pair.make(entityName,Tools.getEntityClass(sessionImplementor,session,entityName)));
      }
      return result;
    }
  }
  return Collections.EMPTY_SET;
}
