{
  previousValueHolder=IdentifierGeneratorHelper.getIntegralDataTypeHolder(returnClass);
  log.debug("fetching initial value: " + sql);
  try {
    PreparedStatement st=session.getTransactionCoordinator().getJdbcCoordinator().getStatementPreparer().prepareStatement(sql);
    try {
      ResultSet rs=st.executeQuery();
      try {
        if (rs.next()) {
          previousValueHolder.initialize(rs,0L).increment();
        }
 else {
          previousValueHolder.initialize(1L);
        }
        sql=null;
        log.debug("first free id: " + previousValueHolder.makeValue());
      }
  finally {
        rs.close();
      }
    }
  finally {
      st.close();
    }
  }
 catch (  SQLException sqle) {
    throw session.getFactory().getSQLExceptionHelper().convert(sqle,"could not fetch initial value for increment generator",sql);
  }
}
