{
  previousValueHolder=IdentifierGeneratorHelper.getIntegralDataTypeHolder(returnClass);
  LOG.debugf("Fetching initial value: %s",sql);
  try {
    PreparedStatement st=session.getTransactionCoordinator().getJdbcCoordinator().getStatementPreparer().prepareStatement(sql);
    try {
      ResultSet rs=session.getTransactionCoordinator().getJdbcCoordinator().getResultSetReturn().extract(st);
      try {
        if (rs.next())         previousValueHolder.initialize(rs,0L).increment();
 else         previousValueHolder.initialize(1L);
        sql=null;
        if (LOG.isDebugEnabled()) {
          LOG.debugf("First free id: %s",previousValueHolder.makeValue());
        }
      }
  finally {
        session.getTransactionCoordinator().getJdbcCoordinator().release(rs);
      }
    }
  finally {
      session.getTransactionCoordinator().getJdbcCoordinator().release(st);
    }
  }
 catch (  SQLException sqle) {
    throw session.getFactory().getSQLExceptionHelper().convert(sqle,"could not fetch initial value for increment generator",sql);
  }
}
