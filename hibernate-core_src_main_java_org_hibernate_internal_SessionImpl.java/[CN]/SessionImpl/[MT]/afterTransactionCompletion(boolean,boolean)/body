{
  LOG.tracef("SessionImpl#afterTransactionCompletion(successful=%s, delayed=%s)",successful,delayed);
  afterCompletionAction.doAction(successful);
  persistenceContext.afterTransactionCompletion();
  actionQueue.afterTransactionCompletion(successful);
  getEventListenerManager().transactionCompletion(successful);
  if (factory.getStatistics().isStatisticsEnabled()) {
    factory.getStatisticsImplementor().endTransaction(successful);
  }
  try {
    interceptor.afterTransactionCompletion(currentHibernateTransaction);
  }
 catch (  Throwable t) {
    LOG.exceptionInAfterTransactionCompletionInterceptor(t);
  }
  if (!delayed) {
    if (shouldAutoClose() && !isClosed()) {
      managedClose();
    }
  }
  if (autoClear) {
    internalClear();
  }
}
