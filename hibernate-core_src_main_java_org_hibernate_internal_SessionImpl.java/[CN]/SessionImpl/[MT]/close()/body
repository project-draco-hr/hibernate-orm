{
  LOG.trace("Closing session");
  if (isClosed()) {
    throw new SessionException("Session was already closed");
  }
  if (factory.getStatistics().isStatisticsEnabled()) {
    factory.getStatisticsImplementor().closeSession();
  }
  try {
    return transactionCoordinator.close();
  }
  finally {
    setClosed();
    cleanup();
  }
}
