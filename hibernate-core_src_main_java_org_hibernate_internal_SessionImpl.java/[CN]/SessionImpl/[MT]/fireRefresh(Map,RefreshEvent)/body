{
  try {
    checkOpen();
    checkTransactionSynchStatus();
    for (    RefreshEventListener listener : listeners(EventType.REFRESH)) {
      listener.onRefresh(event,refreshedAlready);
    }
    delayedAfterCompletion();
  }
 catch (  RuntimeException e) {
    if (!getSessionFactory().getSessionFactoryOptions().isJpaBootstrap()) {
      if (e instanceof HibernateException) {
        handlePersistenceException((HibernateException)e);
        throw e;
      }
    }
    throw convert(e);
  }
 finally {
    delayedAfterCompletion();
  }
}
