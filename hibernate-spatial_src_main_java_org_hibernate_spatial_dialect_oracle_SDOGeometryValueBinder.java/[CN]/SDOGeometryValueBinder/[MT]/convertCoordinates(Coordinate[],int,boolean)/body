{
  if (dim > 4) {
    throw new IllegalArgumentException("Dim parameter value cannot be greater than 4");
  }
  Double[] converted=new Double[coordinates.length * dim];
  for (int i=0; i < coordinates.length; i++) {
    MCoordinate c=MCoordinate.convertCoordinate(coordinates[i]);
    converted[i * dim]=toDouble(c.x);
    converted[i * dim + 1]=toDouble(c.y);
    if (dim == 3) {
      converted[i * dim + 2]=isLrs ? toDouble(c.m) : toDouble(c.z);
    }
 else     if (dim == 4) {
      converted[i * dim + 2]=toDouble(c.z);
      converted[i * dim + 3]=toDouble(c.m);
    }
  }
  return converted;
}
