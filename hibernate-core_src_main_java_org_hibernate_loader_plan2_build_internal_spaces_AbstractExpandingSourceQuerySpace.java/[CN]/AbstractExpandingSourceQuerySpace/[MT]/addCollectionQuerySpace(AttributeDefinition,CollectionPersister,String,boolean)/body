{
  final boolean required=canJoinsBeRequired() && !attributeDefinition.isNullable();
  final ExpandingCollectionQuerySpace rhs=getExpandingQuerySpaces().makeCollectionQuerySpace(querySpaceUid,collectionPersister,required);
  if (shouldIncludeJoin) {
    final JoinDefinedByMetadata join=JoinHelper.INSTANCE.createCollectionJoin(this,attributeDefinition.getName(),rhs,required,(CollectionType)attributeDefinition.getType(),sessionFactory());
    internalGetJoins().add(join);
  }
  return rhs;
}
