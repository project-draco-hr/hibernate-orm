{
  assertNotNull("BundleContext injected",context);
  assertEquals("System Bundle ID",0,context.getBundle().getBundleId());
  testHibernateBundle("org.hibernate.core");
  testHibernateBundle("org.hibernate.entitymanager");
  final Bundle testClientBundle=findHibernateBundle("testClientBundle");
  assertNotNull("The test client bundle was not found!",testClientBundle);
  testClientBundle.start();
  assertEquals("The test client bundle was not activated!",Bundle.ACTIVE,testClientBundle.getState());
  final ServiceReference serviceReference=context.getServiceReference(OsgiTestResults.class.getName());
  final OsgiTestResults testResults=(OsgiTestResults)context.getService(serviceReference);
  if (testResults.getFailures().size() > 0) {
    fail(testResults.getFailures().get(0).getFailure());
  }
}
