{
  Configuration cfg=new Configuration();
  cfg.setProperty(Environment.ENABLE_LAZY_LOAD_NO_TRANS,"true");
  cfg.setProperty(Environment.GENERATE_STATISTICS,"true");
  cfg.setProperty(Environment.USE_SECOND_LEVEL_CACHE,"false");
  super.prepare(cfg);
  try (Session s=getFactory().openSession()){
    s.beginTransaction();
    try {
      Store store=new Store(1).setName("Acme Super Outlet");
      s.persist(store);
      Product product=new Product("007").setName("widget").setDescription("FooBar");
      s.persist(product);
      store.addInventoryProduct(product).setQuantity(10L).setStorePrice(new BigDecimal(500));
      s.getTransaction().commit();
    }
 catch (    Exception e) {
      if (s.getTransaction().isActive()) {
        s.getTransaction().rollback();
      }
      throw e;
    }
  }
 }
