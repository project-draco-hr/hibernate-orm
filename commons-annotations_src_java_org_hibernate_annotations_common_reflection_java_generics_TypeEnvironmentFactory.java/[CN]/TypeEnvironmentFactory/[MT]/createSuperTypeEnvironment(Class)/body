{
  Class superclass=clazz.getSuperclass();
  if (superclass == null) {
    return IdentityTypeEnvironment.INSTANCE;
  }
  Type[] formalArgs=superclass.getTypeParameters();
  Type genericSuperclass=clazz.getGenericSuperclass();
  if (genericSuperclass instanceof Class) {
    return IdentityTypeEnvironment.INSTANCE;
  }
  if (genericSuperclass instanceof ParameterizedType) {
    Type[] actualArgs=((ParameterizedType)genericSuperclass).getActualTypeArguments();
    return new SimpleTypeEnvironment(formalArgs,actualArgs);
  }
  throw new AssertionError("Should be unreachable");
}
