{
  final boolean stats=factory != null && factory.getStatistics().isStatisticsEnabled();
  for (  Serializable space : spaces) {
    final Long lastUpdate=getLastUpdateTimestampForSpace(space,session);
    if (lastUpdate == null) {
      if (stats) {
        factory.getStatistics().updateTimestampsCacheMiss();
      }
    }
 else {
      if (DEBUG_ENABLED) {
        LOG.debugf("[%s] last update timestamp: %s",space,lastUpdate + ", result set timestamp: " + timestamp);
      }
      if (stats) {
        factory.getStatistics().updateTimestampsCacheHit();
      }
      if (lastUpdate >= timestamp) {
        return false;
      }
    }
  }
  return true;
}
