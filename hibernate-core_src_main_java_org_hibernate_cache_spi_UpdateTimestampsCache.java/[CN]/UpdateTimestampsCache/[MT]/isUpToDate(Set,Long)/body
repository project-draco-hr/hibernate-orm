{
  final boolean debug=LOG.isDebugEnabled();
  final boolean stats=factory != null && factory.getStatistics().isStatisticsEnabled();
  for (  Serializable space : (Set<Serializable>)spaces) {
    Long lastUpdate=(Long)region.get(space);
    if (lastUpdate == null) {
      if (stats) {
        factory.getStatisticsImplementor().updateTimestampsCacheMiss();
      }
    }
 else {
      if (debug) {
        LOG.debugf("[%s] last update timestamp: %s",space,lastUpdate + ", result set timestamp: " + timestamp);
      }
      if (stats) {
        factory.getStatisticsImplementor().updateTimestampsCacheHit();
      }
      if (lastUpdate >= timestamp) {
        return false;
      }
    }
  }
  return true;
}
