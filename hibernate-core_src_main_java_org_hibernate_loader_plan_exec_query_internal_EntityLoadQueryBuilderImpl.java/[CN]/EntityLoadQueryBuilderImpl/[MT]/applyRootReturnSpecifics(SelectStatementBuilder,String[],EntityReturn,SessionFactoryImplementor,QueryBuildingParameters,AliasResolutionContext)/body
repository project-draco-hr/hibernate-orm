{
  final String rootAlias=aliasResolutionContext.resolveAliases(rootReturn).getTableAlias();
  final OuterJoinLoadable rootLoadable=(OuterJoinLoadable)rootReturn.getEntityPersister();
  final Queryable rootQueryable=(Queryable)rootReturn.getEntityPersister();
  applyKeyRestriction(select,rootAlias,keyColumnNames,buildingParameters.getBatchSize());
  select.appendRestrictions(rootQueryable.filterFragment(rootAlias,buildingParameters.getQueryInfluencers().getEnabledFilters()));
  select.appendRestrictions(rootLoadable.whereJoinFragment(rootAlias,true,true));
  select.appendSelectClauseFragment(rootLoadable.selectFragment(rootAlias,aliasResolutionContext.resolveAliases(rootReturn).getColumnAliases().getSuffix()));
  final String fromTableFragment;
  if (buildingParameters.getLockOptions() != null) {
    fromTableFragment=factory.getDialect().appendLockHint(buildingParameters.getLockOptions(),rootLoadable.fromTableFragment(rootAlias));
    select.setLockOptions(buildingParameters.getLockOptions());
  }
 else   if (buildingParameters.getLockMode() != null) {
    fromTableFragment=factory.getDialect().appendLockHint(buildingParameters.getLockMode(),rootLoadable.fromTableFragment(rootAlias));
    select.setLockMode(buildingParameters.getLockMode());
  }
 else {
    fromTableFragment=rootLoadable.fromTableFragment(rootAlias);
  }
  select.appendFromClauseFragment(fromTableFragment + rootLoadable.fromJoinFragment(rootAlias,true,true));
}
