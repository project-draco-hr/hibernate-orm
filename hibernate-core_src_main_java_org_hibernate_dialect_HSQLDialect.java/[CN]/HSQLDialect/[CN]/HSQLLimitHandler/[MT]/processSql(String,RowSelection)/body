{
  final boolean hasOffset=LimitHelper.hasFirstRow(selection);
  if (hsqldbVersion < 20) {
    return new StringBuilder(sql.length() + 10).append(sql).insert(sql.toLowerCase().indexOf("select") + 6,hasOffset ? " limit ? ?" : " top ?").toString();
  }
 else {
    return sql + (hasOffset ? " offset ? limit ?" : " limit ?");
  }
}
