{
  Session s=openSession();
  s.beginTransaction();
  Bar bar=new Bar();
  bar.setDetails("Some details");
  Foo foo=new Foo();
  foo.setBar(bar);
  bar.setFoo(foo);
  s.persist(foo);
  s.flush();
  assertNotNull(foo.getId());
  assertEquals(foo.getId(),bar.getFoo().getId());
  s.clear();
  Bar newBar=(Bar)s.createQuery("SELECT b FROM Bar b WHERE b.foo.id = :id").setParameter("id",foo.getId()).uniqueResult();
  assertNotNull(newBar);
  assertEquals("Some details",newBar.getDetails());
  s.getTransaction().rollback();
  s.close();
}
