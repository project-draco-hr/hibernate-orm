{
  SqlServerGeometry nativeGeom=new SqlServerGeometry();
  nativeGeom.setSrid(geom.getSRID());
  if (geom.isValid()) {
    nativeGeom.setIsValid();
  }
  if (hasMValues(geom)) {
    nativeGeom.setHasMValues();
  }
  List<Coordinate> coordinates=new ArrayList<Coordinate>();
  List<Figure> figures=new ArrayList<Figure>();
  List<Shape> shapes=new ArrayList<Shape>();
  encode(geom,-1,coordinates,figures,shapes);
  encodePoints(nativeGeom,coordinates);
  encodeFigures(nativeGeom,figures);
  encodeShapes(nativeGeom,shapes);
  return nativeGeom;
}
