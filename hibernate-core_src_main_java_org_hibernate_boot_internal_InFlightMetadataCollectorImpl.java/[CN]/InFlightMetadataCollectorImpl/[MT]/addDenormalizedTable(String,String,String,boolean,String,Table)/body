{
  final Namespace namespace=getDatabase().locateNamespace(getDatabase().toIdentifier(catalogName),getDatabase().toIdentifier(schemaName));
  final Identifier logicalName;
  if (name != null) {
    logicalName=getDatabase().toIdentifier(name);
  }
 else {
    logicalName=null;
  }
  if (subselectFragment != null) {
    return new DenormalizedTable(namespace,logicalName,subselectFragment,isAbstract,includedTable);
  }
 else {
    Table table=namespace.locateTable(logicalName);
    if (table != null) {
      throw new DuplicateMappingException(DuplicateMappingException.Type.TABLE,logicalName.toString());
    }
 else {
      table=namespace.createDenormalizedTable(logicalName,isAbstract,includedTable);
    }
    return table;
  }
}
