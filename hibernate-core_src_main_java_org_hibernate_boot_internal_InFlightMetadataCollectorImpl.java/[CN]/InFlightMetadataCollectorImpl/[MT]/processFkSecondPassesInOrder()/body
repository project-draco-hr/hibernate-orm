{
  if (fkSecondPassList == null || fkSecondPassList.isEmpty()) {
    return;
  }
  Map<String,Set<FkSecondPass>> isADependencyOf=new HashMap<String,Set<FkSecondPass>>();
  List<FkSecondPass> endOfQueueFkSecondPasses=new ArrayList<FkSecondPass>(fkSecondPassList.size());
  for (  FkSecondPass sp : fkSecondPassList) {
    if (sp.isInPrimaryKey()) {
      final String referenceEntityName=sp.getReferencedEntityName();
      final PersistentClass classMapping=getEntityBinding(referenceEntityName);
      final String dependentTable=classMapping.getTable().getQualifiedTableName().render();
      if (!isADependencyOf.containsKey(dependentTable)) {
        isADependencyOf.put(dependentTable,new HashSet<FkSecondPass>());
      }
      isADependencyOf.get(dependentTable).add(sp);
    }
 else {
      endOfQueueFkSecondPasses.add(sp);
    }
  }
  List<FkSecondPass> orderedFkSecondPasses=new ArrayList<FkSecondPass>(fkSecondPassList.size());
  for (  String tableName : isADependencyOf.keySet()) {
    buildRecursiveOrderedFkSecondPasses(orderedFkSecondPasses,isADependencyOf,tableName,tableName);
  }
  for (  FkSecondPass sp : orderedFkSecondPasses) {
    sp.doSecondPass(getEntityBindingMap());
  }
  processEndOfQueue(endOfQueueFkSecondPasses);
  fkSecondPassList.clear();
}
