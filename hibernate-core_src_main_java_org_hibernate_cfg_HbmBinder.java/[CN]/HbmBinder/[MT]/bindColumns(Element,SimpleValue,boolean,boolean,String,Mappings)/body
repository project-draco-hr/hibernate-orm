{
  Table table=simpleValue.getTable();
  Attribute columnAttribute=node.attribute("column");
  if (columnAttribute == null) {
    Iterator itr=node.elementIterator();
    int count=0;
    while (itr.hasNext()) {
      Element columnElement=(Element)itr.next();
      if (columnElement.getName().equals("column")) {
        Column column=new Column();
        column.setValue(simpleValue);
        column.setTypeIndex(count++);
        bindColumn(columnElement,column,isNullable);
        String columnName=columnElement.attributeValue("name");
        String logicalColumnName=getNamingStrategyDelegate(mappings).determineLogicalColumnName(columnName,propertyPath);
        columnName=getNamingStrategyDelegate(mappings).toPhysicalColumnName(columnName);
        columnName=quoteIdentifier(columnName,mappings);
        column.setName(columnName);
        if (table != null) {
          table.addColumn(column);
          mappings.addColumnBinding(logicalColumnName,column,table);
        }
        simpleValue.addColumn(column);
        bindIndex(columnElement.attribute("index"),table,column,mappings);
        bindIndex(node.attribute("index"),table,column,mappings);
        bindUniqueKey(columnElement.attribute("unique-key"),table,column,mappings);
        bindUniqueKey(node.attribute("unique-key"),table,column,mappings);
      }
 else       if (columnElement.getName().equals("formula")) {
        Formula formula=new Formula();
        formula.setFormula(columnElement.getText());
        simpleValue.addFormula(formula);
      }
    }
    final Attribute uniqueAttribute=node.attribute("unique");
    if (uniqueAttribute != null && "true".equals(uniqueAttribute.getValue()) && ManyToOne.class.isInstance(simpleValue)) {
      ((ManyToOne)simpleValue).markAsLogicalOneToOne();
    }
  }
 else {
    if (node.elementIterator("column").hasNext()) {
      throw new MappingException("column attribute may not be used together with <column> subelement");
    }
    if (node.elementIterator("formula").hasNext()) {
      throw new MappingException("column attribute may not be used together with <formula> subelement");
    }
    Column column=new Column();
    column.setValue(simpleValue);
    bindColumn(node,column,isNullable);
    if (column.isUnique() && ManyToOne.class.isInstance(simpleValue)) {
      ((ManyToOne)simpleValue).markAsLogicalOneToOne();
    }
    String columnName=columnAttribute.getValue();
    String logicalColumnName=getNamingStrategyDelegate(mappings).determineLogicalColumnName(columnName,propertyPath);
    columnName=getNamingStrategyDelegate(mappings).toPhysicalColumnName(columnName);
    columnName=quoteIdentifier(columnName,mappings);
    column.setName(columnName);
    if (table != null) {
      table.addColumn(column);
      mappings.addColumnBinding(logicalColumnName,column,table);
    }
    simpleValue.addColumn(column);
    bindIndex(node.attribute("index"),table,column,mappings);
    bindUniqueKey(node.attribute("unique-key"),table,column,mappings);
  }
  if (autoColumn && simpleValue.getColumnSpan() == 0) {
    Column column=new Column();
    column.setValue(simpleValue);
    bindColumn(node,column,isNullable);
    String columnName=getNamingStrategyDelegate(mappings).determineImplicitPropertyColumnName(propertyPath);
    columnName=quoteIdentifier(columnName,mappings);
    column.setName(columnName);
    String logicalName=getNamingStrategyDelegate(mappings).determineLogicalColumnName(null,propertyPath);
    mappings.addColumnBinding(logicalName,column,table);
    simpleValue.getTable().addColumn(column);
    simpleValue.addColumn(column);
    bindIndex(node.attribute("index"),table,column,mappings);
    bindUniqueKey(node.attribute("unique-key"),table,column,mappings);
  }
}
