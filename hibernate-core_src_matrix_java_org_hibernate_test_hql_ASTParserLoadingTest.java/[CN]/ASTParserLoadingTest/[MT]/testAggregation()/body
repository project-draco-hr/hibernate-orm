{
  Session s=openSession();
  s.beginTransaction();
  Human h=new Human();
  h.setBodyWeight((float)74.0);
  h.setHeightInches(120.5);
  h.setDescription("Me");
  h.setName(new Name("Gavin",'A',"King"));
  h.setNickName("Oney");
  s.persist(h);
  Double sum=(Double)s.createQuery("select sum(h.bodyWeight) from Human h").uniqueResult();
  Double avg=(Double)s.createQuery("select avg(h.heightInches) from Human h").uniqueResult();
  assertEquals(sum.floatValue(),74.0,0.01);
  assertEquals(avg.doubleValue(),120.5,0.01);
  Long id=(Long)s.createQuery("select max(a.id) from Animal a").uniqueResult();
  assertNotNull(id);
  s.delete(h);
  s.getTransaction().commit();
  s.close();
  s=openSession();
  s.beginTransaction();
  h=new Human();
  h.setFloatValue(2.5F);
  h.setIntValue(1);
  s.persist(h);
  Human h2=new Human();
  h2.setFloatValue(2.5F);
  h2.setIntValue(2);
  s.persist(h2);
  Object[] results=(Object[])s.createQuery("select sum(h.floatValue), avg(h.floatValue), sum(h.intValue), avg(h.intValue) from Human h").uniqueResult();
  assertTrue(Double.class.isInstance(results[0]));
  assertEquals(5D,results[0]);
  assertTrue(Double.class.isInstance(results[1]));
  assertEquals(2.5D,results[1]);
  assertTrue(Long.class.isInstance(results[2]));
  assertEquals(3L,results[2]);
  assertTrue(Double.class.isInstance(results[3]));
  if (getDialect() instanceof SQLServer2008Dialect)   assertEquals(1.0D,results[3]);
 else   assertEquals(1.5D,results[3]);
  s.delete(h);
  s.delete(h2);
  s.getTransaction().commit();
  s.close();
}
