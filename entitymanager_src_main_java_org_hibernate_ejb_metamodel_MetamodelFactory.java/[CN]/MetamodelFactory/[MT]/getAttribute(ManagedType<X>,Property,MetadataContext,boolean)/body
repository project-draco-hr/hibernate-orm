{
  AttributeContext attrContext=getAttributeContext(property);
  final Attribute<X,Y> attribute;
  if (attrContext.isCollection()) {
    final Type<V> attrType=getType(attrContext.getElementTypeStatus(),attrContext.getElementValue(),metadataContext);
    @SuppressWarnings("unchecked") final Class<Y> collectionClass=(Class<Y>)attrContext.getCollectionClass();
    if (java.util.Map.class.isAssignableFrom(collectionClass)) {
      final Type<K> keyType=getType(attrContext.getKeyTypeStatus(),attrContext.getKeyValue(),metadataContext);
      attribute=PluralAttributeImpl.create(ownerType,attrType,collectionClass,keyType).property(property).persistentAttributeType(attrContext.getElementAttributeType()).build();
    }
 else {
      attribute=PluralAttributeImpl.create(ownerType,attrType,collectionClass,null).property(property).persistentAttributeType(attrContext.getElementAttributeType()).build();
    }
  }
 else {
    final Type<Y> attrType=getType(attrContext.getElementTypeStatus(),attrContext.getElementValue(),metadataContext);
    final SingularAttributeImpl.Builder<X,Y> xyBuilder=SingularAttributeImpl.create(ownerType,attrType).property(property).persistentAttributeType(attrContext.getElementAttributeType());
    if (isId)     xyBuilder.id();
    attribute=xyBuilder.build();
  }
  return attribute;
}
