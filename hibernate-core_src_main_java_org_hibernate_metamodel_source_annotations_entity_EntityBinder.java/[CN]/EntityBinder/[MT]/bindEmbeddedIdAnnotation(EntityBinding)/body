{
  AnnotationInstance idAnnotation=JandexHelper.getSingleAnnotation(entityClass.getClassInfo(),JPADotNames.EMBEDDED_ID);
  String idName=JandexHelper.getPropertyName(idAnnotation.target());
  MappedAttribute idAttribute=entityClass.getMappedAttribute(idName);
  if (!(idAttribute instanceof SimpleAttribute)) {
    throw new AssertionFailure("Unexpected attribute type for id attribute");
  }
  SingularAttribute attribute=entityBinding.getEntity().locateOrCreateComponentAttribute(idName);
  SimpleAttributeBinding attributeBinding=entityBinding.makeSimpleIdAttributeBinding(attribute);
  attributeBinding.initialize(new AttributeBindingStateImpl((SimpleAttribute)idAttribute));
  attributeBinding.initialize(new ColumnRelationalStateImpl((SimpleAttribute)idAttribute,bindingContext.getMetadataImplementor()));
  bindSingleIdGeneratedValue(entityBinding,idName);
  TupleRelationalStateImpl state=new TupleRelationalStateImpl();
  EmbeddableClass embeddableClass=entityClass.getEmbeddedClasses().get(idName);
  for (  SimpleAttribute attr : embeddableClass.getSimpleAttributes()) {
    state.addValueState(new ColumnRelationalStateImpl(attr,bindingContext.getMetadataImplementor()));
  }
  attributeBinding.initialize(state);
  Map<String,String> parameterMap=new HashMap<String,String>(1);
  parameterMap.put(IdentifierGenerator.ENTITY_NAME,entityBinding.getEntity().getName());
  IdGenerator generator=new IdGenerator("NAME","assigned",parameterMap);
  entityBinding.getEntityIdentifier().setIdGenerator(generator);
}
