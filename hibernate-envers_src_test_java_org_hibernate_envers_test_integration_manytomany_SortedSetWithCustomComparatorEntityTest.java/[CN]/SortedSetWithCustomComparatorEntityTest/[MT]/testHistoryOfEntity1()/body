{
  SortedSetEntity entity1=getAuditReader().find(SortedSetEntity.class,1,1);
  assertEquals("sortedSet1",entity1.getData());
  assertEquals(Integer.valueOf(1),entity1.getId());
  SortedSet<StrTestEntity> sortedSet=entity1.getSortedSet();
  assertEquals(StrTestEntityComparator.class,sortedSet.comparator().getClass());
  assertEquals(0,sortedSet.size());
  entity1=getAuditReader().find(SortedSetEntity.class,1,2);
  assertEquals("sortedSet1",entity1.getData());
  assertEquals(Integer.valueOf(1),entity1.getId());
  sortedSet=entity1.getSortedSet();
  assertEquals(StrTestEntityComparator.class,sortedSet.comparator().getClass());
  assertEquals(1,sortedSet.size());
  Iterator<StrTestEntity> iterator=sortedSet.iterator();
  checkStrTestEntity(iterator.next(),id1,"abc");
  entity1=getAuditReader().find(SortedSetEntity.class,1,3);
  assertEquals("sortedSet1",entity1.getData());
  assertEquals(Integer.valueOf(1),entity1.getId());
  sortedSet=entity1.getSortedSet();
  assertEquals(StrTestEntityComparator.class,sortedSet.comparator().getClass());
  assertEquals(2,sortedSet.size());
  iterator=sortedSet.iterator();
  checkStrTestEntity(iterator.next(),id2,"aaa");
  checkStrTestEntity(iterator.next(),id1,"abc");
  entity1=getAuditReader().find(SortedSetEntity.class,1,4);
  assertEquals("sortedSet1",entity1.getData());
  assertEquals(Integer.valueOf(1),entity1.getId());
  sortedSet=entity1.getSortedSet();
  assertEquals(StrTestEntityComparator.class,sortedSet.comparator().getClass());
  assertEquals(3,sortedSet.size());
  iterator=sortedSet.iterator();
  checkStrTestEntity(iterator.next(),id2,"aaa");
  checkStrTestEntity(iterator.next(),id3,"aba");
  checkStrTestEntity(iterator.next(),id1,"abc");
  entity1=getAuditReader().find(SortedSetEntity.class,1,5);
  assertEquals("sortedSet1",entity1.getData());
  assertEquals(Integer.valueOf(1),entity1.getId());
  sortedSet=entity1.getSortedSet();
  assertEquals(StrTestEntityComparator.class,sortedSet.comparator().getClass());
  assertEquals(4,sortedSet.size());
  iterator=sortedSet.iterator();
  checkStrTestEntity(iterator.next(),id2,"aaa");
  checkStrTestEntity(iterator.next(),id4,"aac");
  checkStrTestEntity(iterator.next(),id3,"aba");
  checkStrTestEntity(iterator.next(),id1,"abc");
}
