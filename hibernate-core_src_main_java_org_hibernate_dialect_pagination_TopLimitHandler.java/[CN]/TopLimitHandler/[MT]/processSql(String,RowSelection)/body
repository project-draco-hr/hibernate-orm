{
  if (LimitHelper.hasFirstRow(selection)) {
    throw new UnsupportedOperationException("query result offset is not supported");
  }
  final int selectIndex=sql.toLowerCase().indexOf("select");
  final int selectDistinctIndex=sql.toLowerCase().indexOf("select distinct");
  final int insertionPoint=selectIndex + (selectDistinctIndex == selectIndex ? 15 : 6);
  return new StringBuilder(sql.length() + 8).append(sql).insert(insertionPoint," TOP ? ").toString();
}
