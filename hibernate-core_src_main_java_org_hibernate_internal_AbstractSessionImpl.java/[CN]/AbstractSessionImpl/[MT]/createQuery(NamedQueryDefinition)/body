{
  String queryString=namedQueryDefinition.getQueryString();
  final Query query=new QueryImpl(queryString,namedQueryDefinition.getFlushMode(),this,getHQLQueryPlan(queryString,false).getParameterMetadata());
  query.setComment(namedQueryDefinition.getComment() != null ? namedQueryDefinition.getComment() : namedQueryDefinition.getName());
  if (namedQueryDefinition.getLockOptions() != null) {
    query.setLockOptions(namedQueryDefinition.getLockOptions());
  }
  return query;
}
