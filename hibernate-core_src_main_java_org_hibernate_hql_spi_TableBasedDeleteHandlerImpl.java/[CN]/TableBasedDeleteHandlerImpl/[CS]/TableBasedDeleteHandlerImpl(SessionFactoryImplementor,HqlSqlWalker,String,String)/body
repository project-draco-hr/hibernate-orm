{
  super(factory,walker,catalog,schema);
  DeleteStatement deleteStatement=(DeleteStatement)walker.getAST();
  FromElement fromElement=deleteStatement.getFromClause().getFromElement();
  this.targetedPersister=fromElement.getQueryable();
  final String bulkTargetAlias=fromElement.getTableAlias();
  final ProcessedWhereClause processedWhereClause=processWhereClause(deleteStatement.getWhereClause());
  this.idSelectParameterSpecifications=processedWhereClause.getIdSelectParameterSpecifications();
  this.idInsertSelect=generateIdInsertSelect(targetedPersister,bulkTargetAlias,processedWhereClause);
  log.tracev("Generated ID-INSERT-SELECT SQL (multi-table delete) : {0}",idInsertSelect);
  final String idSubselect=generateIdSubselect(targetedPersister);
  deletes=new ArrayList<String>();
  for (  Type type : targetedPersister.getPropertyTypes()) {
    if (!type.isCollectionType()) {
      continue;
    }
    final CollectionType cType=(CollectionType)type;
    final AbstractCollectionPersister cPersister=(AbstractCollectionPersister)factory.getCollectionPersister(cType.getRole());
    final boolean hasCollectionTable=cPersister.isManyToMany() || !cPersister.getElementType().isAssociationType();
    if (!hasCollectionTable) {
      continue;
    }
    deletes.add(generateDelete(cPersister.getTableName(),cPersister.getKeyColumnNames(),idSubselect,"bulk delete - collection table clean up (" + cPersister.getRole() + ")"));
  }
  String[] tableNames=targetedPersister.getConstraintOrderedTableNameClosure();
  String[][] columnNames=targetedPersister.getContraintOrderedTableKeyColumnClosure();
  for (int i=0; i < tableNames.length; i++) {
    deletes.add(generateDelete(tableNames[i],columnNames[i],idSubselect,"bulk delete"));
  }
}
