{
  String regionFactoryClassName=PropertiesHelper.getString(Environment.CACHE_REGION_FACTORY,properties,null);
  if (regionFactoryClassName == null && cachingEnabled) {
    String providerClassName=PropertiesHelper.getString(Environment.CACHE_PROVIDER,properties,null);
    if (providerClassName != null) {
      regionFactoryClassName=RegionFactoryCacheProviderBridge.class.getName();
    }
  }
  if (regionFactoryClassName == null) {
    regionFactoryClassName=DEF_CACHE_REG_FACTORY;
  }
  log.info("Cache region factory : " + regionFactoryClassName);
  try {
    return (RegionFactory)ReflectHelper.classForName(regionFactoryClassName).getConstructor(new Class[]{Properties.class}).newInstance(new Object[]{properties});
  }
 catch (  Exception e) {
    throw new HibernateException("could not instantiate RegionFactory [" + regionFactoryClassName + "]",e);
  }
}
