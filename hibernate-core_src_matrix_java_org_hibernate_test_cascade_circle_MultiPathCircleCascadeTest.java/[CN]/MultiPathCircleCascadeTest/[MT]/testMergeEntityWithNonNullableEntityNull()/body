{
  Route route=getUpdatedDetachedEntity();
  Node node=(Node)route.getNodes().iterator().next();
  route.getNodes().remove(node);
  node.setRoute(null);
  Session s=openSession();
  s.beginTransaction();
  try {
    s.merge(node);
    s.getTransaction().commit();
    fail("should have thrown an exception");
  }
 catch (  Exception ex) {
    checkExceptionFromNullValueForNonNullable(ex,((SessionImplementor)s).getFactory().getSettings().isCheckNullability(),true);
  }
 finally {
    s.getTransaction().rollback();
    s.close();
  }
}
