{
  config=new Configuration();
  URL url=Thread.currentThread().getContextClassLoader().getResource(getHibernateConfigurationFileName());
  config.configure(new File(url.toURI()));
  String auditStrategy=getAuditStrategy();
  if (auditStrategy != null && !"".equals(auditStrategy)) {
    config.setProperty("org.hibernate.envers.audit_strategy",auditStrategy);
  }
  config.setProperty(Environment.USE_NEW_ID_GENERATOR_MAPPINGS,"true");
  config.setProperty("org.hibernate.envers.use_revision_entity_with_native_id","false");
  addProperties(config);
  this.initMappings();
  serviceRegistry=ServiceRegistryBuilder.buildServiceRegistry(config.getProperties());
  sessionFactory=config.buildSessionFactory(serviceRegistry);
}
