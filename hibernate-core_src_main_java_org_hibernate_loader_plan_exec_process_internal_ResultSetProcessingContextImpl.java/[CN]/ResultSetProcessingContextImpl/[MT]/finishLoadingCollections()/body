{
  LoadPlanVisitor.visit(loadPlan,new LoadPlanVisitationStrategyAdapter(){
    @Override public void handleCollectionReturn(    CollectionReturn rootCollectionReturn){
      endLoadingCollection(rootCollectionReturn.getCollectionPersister());
    }
    @Override public void startingCollectionFetch(    CollectionFetch collectionFetch){
      endLoadingCollection(collectionFetch.getCollectionPersister());
    }
    private void endLoadingCollection(    CollectionPersister persister){
      if (!persister.isArray()) {
        session.getPersistenceContext().getLoadContexts().getCollectionLoadContext(resultSet).endLoadingCollections(persister);
      }
    }
  }
);
}
