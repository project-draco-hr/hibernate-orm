{
  EntityManager em=getOrCreateEntityManager();
  em.getTransaction().begin();
  CriteriaQuery criteria=em.getQueryBuilder().createQuery();
  Root<Wall> from=criteria.from(Wall.class);
  ParameterExpression param=em.getQueryBuilder().parameter(String.class);
  SingularAttribute<? super Wall,?> colorAttribute=em.getMetamodel().entity(Wall.class).getDeclaredSingularAttribute("color");
  assertNotNull("metamodel returned null singular attribute",colorAttribute);
  Predicate predicate=em.getQueryBuilder().equal(from.get(colorAttribute),param);
  criteria.where(predicate);
  assertEquals(1,criteria.getParameters().size());
  em.getTransaction().commit();
  em.close();
}
