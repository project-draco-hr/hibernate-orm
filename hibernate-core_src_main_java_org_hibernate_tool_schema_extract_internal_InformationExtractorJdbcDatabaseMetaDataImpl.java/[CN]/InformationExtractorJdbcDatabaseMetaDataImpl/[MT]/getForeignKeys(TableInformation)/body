{
  final Map<Identifier,ForeignKeyBuilder> fkBuilders=new HashMap<Identifier,ForeignKeyBuilder>();
  try {
    ResultSet resultSet=extractionContext.getJdbcDatabaseMetaData().getImportedKeys(identifierHelper().toMetaDataCatalogName(tableInformation.getName().getCatalogName()),identifierHelper().toMetaDataSchemaName(tableInformation.getName().getSchemaName()),identifierHelper().toMetaDataObjectName(tableInformation.getName().getTableName()));
    try {
      while (resultSet.next()) {
        final Identifier fkIdentifier=identifierHelper().fromMetaDataObjectName(resultSet.getString("FK_NAME"));
        ForeignKeyBuilder fkBuilder=fkBuilders.get(fkIdentifier);
        if (fkBuilder == null) {
          fkBuilder=generateForeignKeyBuilder(fkIdentifier);
          fkBuilders.put(fkIdentifier,fkBuilder);
        }
        final QualifiedTableName incomingPkTableName=extractKeyTableName(resultSet,"PK");
        final TableInformation pkTableInformation=extractionContext.getDatabaseObjectAccess().locateTableInformation(incomingPkTableName);
        if (pkTableInformation == null) {
          continue;
        }
        final Identifier fkColumnIdentifier=identifierHelper().fromMetaDataObjectName(resultSet.getString("FKCOLUMN_NAME"));
        final Identifier pkColumnIdentifier=identifierHelper().fromMetaDataObjectName(resultSet.getString("PKCOLUMN_NAME"));
        fkBuilder.addColumnMapping(tableInformation.getColumn(fkColumnIdentifier),pkTableInformation.getColumn(pkColumnIdentifier));
      }
    }
  finally {
      resultSet.close();
    }
  }
 catch (  SQLException e) {
    throw convertSQLException(e,"Error accessing column metadata: " + tableInformation.getName().toString());
  }
  final List<ForeignKeyInformation> fks=new ArrayList<ForeignKeyInformation>();
  for (  ForeignKeyBuilder fkBuilder : fkBuilders.values()) {
    ForeignKeyInformation fk=fkBuilder.build();
    fks.add(fk);
  }
  return fks;
}
