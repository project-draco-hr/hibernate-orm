{
  clearCounts();
  TestingJtaPlatformImpl.INSTANCE.getTransactionManager().begin();
  Session s=openSession();
  Employer emp=new Employer();
  s.persist(emp);
  TestingJtaPlatformImpl.INSTANCE.getTransactionManager().commit();
  TestingJtaPlatformImpl.INSTANCE.getTransactionManager().begin();
  s=openSession();
  s.delete(emp);
  s=applyNonFlushedChangesToNewSessionCloseOldSession(s);
  emp=(Employer)s.get(Employee.class,emp.getId());
  TestingJtaPlatformImpl.INSTANCE.getTransactionManager().commit();
  assertNull("get did not return null after delete",emp);
}
