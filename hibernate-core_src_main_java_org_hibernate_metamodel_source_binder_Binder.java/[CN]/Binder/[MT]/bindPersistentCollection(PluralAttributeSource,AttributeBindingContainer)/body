{
  final PluralAttribute existingAttribute=attributeBindingContainer.getAttributeContainer().locatePluralAttribute(attributeSource.getName());
  final AbstractPluralAttributeBinding pluralAttributeBinding;
  if (attributeSource.getPluralAttributeNature() == PluralAttributeNature.BAG) {
    final PluralAttribute attribute=existingAttribute != null ? existingAttribute : attributeBindingContainer.getAttributeContainer().createBag(attributeSource.getName());
    pluralAttributeBinding=attributeBindingContainer.makeBagAttributeBinding(attribute,convert(attributeSource.getElementSource().getNature()));
  }
 else   if (attributeSource.getPluralAttributeNature() == PluralAttributeNature.SET) {
    final PluralAttribute attribute=existingAttribute != null ? existingAttribute : attributeBindingContainer.getAttributeContainer().createSet(attributeSource.getName());
    pluralAttributeBinding=attributeBindingContainer.makeSetAttributeBinding(attribute,convert(attributeSource.getElementSource().getNature()));
  }
 else {
    throw new NotYetImplementedException("Collections other than bag and set not yet implemented :(");
  }
  doBasicPluralAttributeBinding(attributeSource,pluralAttributeBinding);
  bindCollectionTable(attributeSource,pluralAttributeBinding);
  bindSortingAndOrdering(attributeSource,pluralAttributeBinding);
  bindCollectionKey(attributeSource,pluralAttributeBinding);
  bindCollectionElement(attributeSource,pluralAttributeBinding);
  bindCollectionIndex(attributeSource,pluralAttributeBinding);
  metadata.addCollection(pluralAttributeBinding);
}
