{
  if (processedEntityNames.contains(entitySource.getEntityName())) {
    return metadata.getEntityBinding(entitySource.getEntityName());
  }
  currentBindingContext=entitySource.getBindingContext();
  try {
    final EntityBinding entityBinding=doCreateEntityBinding(entitySource,superEntityBinding);
    metadata.addEntity(entityBinding);
    processedEntityNames.add(entityBinding.getEntity().getName());
    processFetchProfiles(entitySource,entityBinding);
    return entityBinding;
  }
  finally {
    currentBindingContext=null;
  }
}
