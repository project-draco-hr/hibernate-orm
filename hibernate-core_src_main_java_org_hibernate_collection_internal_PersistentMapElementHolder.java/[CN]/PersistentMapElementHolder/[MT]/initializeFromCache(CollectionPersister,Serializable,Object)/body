{
  final Type elementType=persister.getElementType();
  final Type indexType=persister.getIndexType();
  final String indexNodeName=getIndexAttributeName(persister);
  final Serializable[] cached=(Serializable[])disassembled;
  int i=0;
  while (i < cached.length) {
    final Object index=indexType.assemble(cached[i++],getSession(),owner);
    final Object object=elementType.assemble(cached[i++],getSession(),owner);
    final Element subElement=element.addElement(persister.getElementNodeName());
    elementType.setToXMLNode(subElement,object,persister.getFactory());
    final String indexString=((StringRepresentableType)indexType).toString(index);
    setIndex(subElement,indexNodeName,indexString);
  }
}
