{
  Session session=openSession();
  session.beginTransaction();
  try {
    session.doWork(new Work(){
      public void execute(      Connection connection) throws SQLException {
        Statement statement=null;
        try {
          statement=connection.createStatement();
          statement.executeQuery("select * from non_existent");
        }
  finally {
          releaseQuietly(statement);
        }
      }
    }
);
    fail("expecting exception");
  }
 catch (  JDBCException expected) {
  }
  session.getTransaction().commit();
  session.close();
}
