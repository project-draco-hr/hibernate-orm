{
  Configuration cfg=new Configuration();
  if (namingStrategy != null && namingStrategyDelegator != null) {
    throw new HibernateException("namingStrategy and namingStrategyDelegator cannot be specified together.");
  }
  if (namingStrategy != null) {
    cfg.setNamingStrategy((NamingStrategy)ReflectHelper.classForName(namingStrategy).newInstance());
  }
 else   if (namingStrategyDelegator != null) {
    cfg.setNamingStrategyDelegator((NamingStrategyDelegator)ReflectHelper.classForName(namingStrategyDelegator).newInstance());
  }
  if (configurationFile != null) {
    cfg.configure(configurationFile);
  }
  String[] files=getFiles();
  for (int i=0; i < files.length; i++) {
    String filename=files[i];
    if (filename.endsWith(".jar")) {
      cfg.addJar(new File(filename));
    }
 else {
      cfg.addFile(filename);
    }
  }
  return cfg;
}
