{
  try {
    Connection connection=session.getFactory().getConnectionProvider().getConnection();
    try {
      work.doWork(connection);
    }
 catch (    HibernateException e) {
      throw e;
    }
catch (    Exception e) {
      throw new HibernateException("Unable to perform isolated work",e);
    }
 finally {
      try {
        session.getFactory().getConnectionProvider().closeConnection(connection);
      }
 catch (      Throwable ignore) {
        LOG.unableToReleaseIsolatedConnection(ignore);
      }
    }
  }
 catch (  SQLException sqle) {
    throw sqlExceptionHelper().convert(sqle,"unable to obtain isolated JDBC connection");
  }
}
