{
  if (metadata.isRoot()) {
    Iterator<EntityBinding> subEntityBindingIterator=metadata.getDirectSubEntityBindings().iterator();
    if (subEntityBindingIterator.hasNext()) {
      metadata=subEntityBindingIterator.next();
    }
 else {
      return singleTableEntityPersister();
    }
  }
switch (metadata.getHierarchyDetails().getInheritanceType()) {
case JOINED:
{
      return joinedSubclassEntityPersister();
    }
case SINGLE_TABLE:
{
    return singleTableEntityPersister();
  }
case TABLE_PER_CLASS:
{
  return unionSubclassEntityPersister();
}
default :
{
throw new UnknownPersisterException("Could not determine persister implementation for entity [" + metadata.getEntity().getName() + "]");
}
}
}
