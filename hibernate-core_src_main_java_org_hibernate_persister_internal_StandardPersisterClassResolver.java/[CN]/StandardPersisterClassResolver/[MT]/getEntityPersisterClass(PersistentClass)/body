{
  if (RootClass.class.isInstance(metadata)) {
    return singleTableEntityPersister();
  }
 else   if (JoinedSubclass.class.isInstance(metadata)) {
    return joinedSubclassEntityPersister();
  }
 else   if (UnionSubclass.class.isInstance(metadata)) {
    return unionSubclassEntityPersister();
  }
 else {
    throw new UnknownPersisterException("Could not determine persister implementation for entity [" + metadata.getEntityName() + "]");
  }
}
