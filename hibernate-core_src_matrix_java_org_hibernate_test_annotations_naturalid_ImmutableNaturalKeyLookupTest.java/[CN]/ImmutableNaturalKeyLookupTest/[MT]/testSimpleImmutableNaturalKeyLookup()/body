{
  Session s=openSession();
  Transaction newTx=s.getTransaction();
  newTx.begin();
  A a1=new A();
  a1.setName("name1");
  s.persist(a1);
  newTx.commit();
  newTx=s.beginTransaction();
  getCriteria(s).uniqueResult();
  A a2=new A();
  a2.setName("xxxxxx");
  s.persist(a2);
  newTx.commit();
  newTx=s.beginTransaction();
  Assert.assertTrue(s.getSessionFactory().getStatistics().isStatisticsEnabled());
  s.getSessionFactory().getStatistics().clear();
  getCriteria(s).uniqueResult();
  Assert.assertEquals("query is not considered as isImmutableNaturalKeyLookup, despite fullfilling all conditions",1,s.getSessionFactory().getStatistics().getQueryCacheHitCount());
  s.createQuery("delete from A").executeUpdate();
  newTx.commit();
  s.close();
}
