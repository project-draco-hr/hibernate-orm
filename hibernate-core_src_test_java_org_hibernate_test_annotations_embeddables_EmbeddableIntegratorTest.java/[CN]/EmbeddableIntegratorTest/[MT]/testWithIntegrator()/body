{
  StandardServiceRegistry reg=new StandardServiceRegistryBuilder(new BootstrapServiceRegistryBuilder().with(new InvestorIntegrator()).build()).build();
  SessionFactory sf=new Configuration().addAnnotatedClass(Investor.class).setProperty("hibernate.hbm2ddl.auto","create-drop").buildSessionFactory(reg);
  Session sess=sf.openSession();
  Investor myInv=getInvestor();
  myInv.setId(2L);
  sess.save(myInv);
  sess.flush();
  sess.clear();
  Investor inv=(Investor)sess.get(Investor.class,2L);
  assertEquals(new BigDecimal("100"),inv.getInvestments().get(0).getAmount().getAmount());
  sess.close();
  sf.close();
  StandardServiceRegistryBuilder.destroy(reg);
}
