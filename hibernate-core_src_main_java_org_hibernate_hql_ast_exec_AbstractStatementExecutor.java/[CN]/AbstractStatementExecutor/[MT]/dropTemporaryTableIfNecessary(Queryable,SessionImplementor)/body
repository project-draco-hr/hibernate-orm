{
  if (getFactory().getDialect().dropTemporaryTableAfterUse()) {
    TemporaryTableDropWork work=new TemporaryTableDropWork(persister,session);
    if (shouldIsolateTemporaryTableDDL()) {
      session.getTransactionCoordinator().getTransaction().createIsolationDelegate().delegateWork(work,getFactory().getSettings().isDataDefinitionInTransactionSupported());
    }
 else {
      final Connection connection=session.getTransactionCoordinator().getJdbcCoordinator().getLogicalConnection().getShareableConnectionProxy();
      work.execute(connection);
      session.getTransactionCoordinator().getJdbcCoordinator().getLogicalConnection().afterStatementExecution();
    }
  }
 else {
    PreparedStatement ps=null;
    try {
      final String sql="delete from " + persister.getTemporaryIdTableName();
      ps=session.getTransactionCoordinator().getJdbcCoordinator().getStatementPreparer().prepareStatement(sql,false);
      ps.executeUpdate();
    }
 catch (    Throwable t) {
      log.warn("unable to cleanup temporary id table after use [" + t + "]");
    }
 finally {
      if (ps != null) {
        try {
          ps.close();
        }
 catch (        Throwable ignore) {
        }
      }
    }
  }
}
