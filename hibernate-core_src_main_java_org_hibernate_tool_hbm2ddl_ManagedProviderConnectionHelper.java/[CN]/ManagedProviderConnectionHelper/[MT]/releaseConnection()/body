{
  if (connection != null) {
    try {
      final boolean logWarning=ConfigurationHelper.getBoolean(AvailableSettings.LOG_JDBC_WARNINGS,cfgProperties,false);
      new SqlExceptionHelper(logWarning).logAndClearWarnings(connection);
    }
  finally {
      try {
        serviceRegistry.getService(ConnectionProvider.class).closeConnection(connection);
      }
  finally {
        connection=null;
      }
    }
  }
}
