{
  if (jt.equals(JoinType.RIGHT)) {
    throw new UnsupportedOperationException("RIGHT JOIN not supported");
  }
  final Class<V> attributeType=map.getBindableJavaType();
  final MapJoin<X,K,V> join;
  if (isBasicCollection(map)) {
    join=new BasicMapJoinImpl<X,K,V>(queryBuilder(),attributeType,this,map,jt);
  }
 else {
    join=new MapJoinImpl<X,K,V>(queryBuilder(),attributeType,this,map,jt);
  }
  joins.add(join);
  return join;
}
