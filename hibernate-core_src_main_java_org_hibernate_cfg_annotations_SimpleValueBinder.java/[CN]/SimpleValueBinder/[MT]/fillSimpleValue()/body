{
  LOG.debugf("Setting SimpleValue typeName for %s",propertyName);
  if (attributeConverterDefinition != null) {
    if (!BinderHelper.isEmptyAnnotationValue(explicitType)) {
      throw new AnnotationException(String.format("AttributeConverter and explicit Type cannot be applied to same attribute [%s.%s];" + "remove @Type or specify @Convert(disableConversion = true)",persistentClassName,propertyName));
    }
    simpleValue.setJpaAttributeConverterDefinition(attributeConverterDefinition);
  }
 else {
    String type;
    org.hibernate.mapping.TypeDef typeDef;
    if (!BinderHelper.isEmptyAnnotationValue(explicitType)) {
      type=explicitType;
      typeDef=mappings.getTypeDef(type);
    }
 else {
      org.hibernate.mapping.TypeDef implicitTypeDef=mappings.getTypeDef(returnedClassName);
      if (implicitTypeDef != null) {
        typeDef=implicitTypeDef;
        type=returnedClassName;
      }
 else {
        typeDef=mappings.getTypeDef(defaultType);
        type=defaultType;
      }
    }
    if (typeDef != null) {
      type=typeDef.getTypeClass();
      simpleValue.setTypeParameters(typeDef.getParameters());
    }
    if (typeParameters != null && typeParameters.size() != 0) {
      simpleValue.setTypeParameters(typeParameters);
    }
    simpleValue.setTypeName(type);
  }
  if (persistentClassName != null || attributeConverterDefinition != null) {
    simpleValue.setTypeUsingReflection(persistentClassName,propertyName);
  }
  if (!simpleValue.isTypeSpecified() && isVersion()) {
    simpleValue.setTypeName("integer");
  }
  if (timeStampVersionType != null) {
    simpleValue.setTypeName(timeStampVersionType);
  }
  if (simpleValue.getTypeName() != null && simpleValue.getTypeName().length() > 0 && simpleValue.getMappings().getTypeResolver().basic(simpleValue.getTypeName()) == null) {
    try {
      Class typeClass=ReflectHelper.classForName(simpleValue.getTypeName());
      if (typeClass != null && DynamicParameterizedType.class.isAssignableFrom(typeClass)) {
        Properties parameters=simpleValue.getTypeParameters();
        if (parameters == null) {
          parameters=new Properties();
        }
        parameters.put(DynamicParameterizedType.IS_DYNAMIC,Boolean.toString(true));
        parameters.put(DynamicParameterizedType.RETURNED_CLASS,returnedClassName);
        parameters.put(DynamicParameterizedType.IS_PRIMARY_KEY,Boolean.toString(key));
        parameters.put(DynamicParameterizedType.ENTITY,persistentClassName);
        parameters.put(DynamicParameterizedType.PROPERTY,xproperty.getName());
        parameters.put(DynamicParameterizedType.ACCESS_TYPE,accessType.getType());
        simpleValue.setTypeParameters(parameters);
      }
    }
 catch (    ClassNotFoundException cnfe) {
      throw new MappingException("Could not determine type for: " + simpleValue.getTypeName(),cnfe);
    }
  }
}
