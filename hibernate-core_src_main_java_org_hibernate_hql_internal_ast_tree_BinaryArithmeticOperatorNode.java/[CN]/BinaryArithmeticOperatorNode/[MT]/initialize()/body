{
  final Node lhs=getLeftHandOperand();
  final Node rhs=getRightHandOperand();
  if (lhs == null) {
    throw new SemanticException("left-hand operand of a binary operator was null");
  }
  if (rhs == null) {
    throw new SemanticException("right-hand operand of a binary operator was null");
  }
  final Type lhType=(lhs instanceof SqlNode) ? ((SqlNode)lhs).getDataType() : null;
  final Type rhType=(rhs instanceof SqlNode) ? ((SqlNode)rhs).getDataType() : null;
  if (ExpectedTypeAwareNode.class.isAssignableFrom(lhs.getClass()) && rhType != null) {
    Type expectedType=null;
    if (isDateTimeType(rhType)) {
      expectedType=getType() == HqlSqlTokenTypes.PLUS ? StandardBasicTypes.DOUBLE : rhType;
    }
 else {
      expectedType=rhType;
    }
    ((ExpectedTypeAwareNode)lhs).setExpectedType(expectedType);
  }
 else   if (ParameterNode.class.isAssignableFrom(rhs.getClass()) && lhType != null) {
    Type expectedType=null;
    if (isDateTimeType(lhType)) {
      if (getType() == HqlSqlTokenTypes.PLUS) {
        expectedType=StandardBasicTypes.DOUBLE;
      }
    }
 else {
      expectedType=lhType;
    }
    ((ExpectedTypeAwareNode)rhs).setExpectedType(expectedType);
  }
}
