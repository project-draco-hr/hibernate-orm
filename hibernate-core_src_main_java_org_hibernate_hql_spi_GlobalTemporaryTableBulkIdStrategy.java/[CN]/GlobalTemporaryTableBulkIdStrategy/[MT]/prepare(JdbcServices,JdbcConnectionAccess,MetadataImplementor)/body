{
  final ConfigurationService configService=metadata.getMetadataBuildingOptions().getServiceRegistry().getService(ConfigurationService.class);
  this.cleanUpTables=configService.getSetting(CLEAN_UP_ID_TABLES,StandardConverters.BOOLEAN,false);
  final List<Table> idTableDefinitions=new ArrayList<Table>();
  for (  PersistentClass entityBinding : metadata.getEntityBindings()) {
    if (!MultiTableBulkIdHelper.INSTANCE.needsIdTable(entityBinding)) {
      continue;
    }
    final Table idTableDefinition=generateIdTableDefinition(entityBinding,metadata);
    idTableDefinitions.add(idTableDefinition);
    if (cleanUpTables) {
      if (tableCleanUpDdl == null) {
        tableCleanUpDdl=new ArrayList<String>();
      }
      tableCleanUpDdl.add(idTableDefinition.sqlDropString(jdbcServices.getDialect(),null,null));
    }
  }
  exportTableDefinitions(idTableDefinitions,jdbcServices,connectionAccess,metadata);
}
