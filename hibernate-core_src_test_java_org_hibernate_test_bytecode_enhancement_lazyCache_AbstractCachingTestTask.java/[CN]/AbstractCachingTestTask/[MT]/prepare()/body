{
  StandardServiceRegistryBuilder registryBuilder=new StandardServiceRegistryBuilder();
  registryBuilder.applySetting(AvailableSettings.GENERATE_STATISTICS,"true");
  registryBuilder.applySetting(AvailableSettings.HBM2DDL_AUTO,"create-drop");
  registryBuilder.applySetting(AvailableSettings.USE_SECOND_LEVEL_CACHE,"true");
  registryBuilder.addService(ClassLoaderService.class,new ClassLoaderServiceImpl(Thread.currentThread().getContextClassLoader()));
  StandardServiceRegistry registry=registryBuilder.build();
  MetadataSources metadataSources=new MetadataSources(registry);
  metadataSources.addAnnotatedClass(Document.class);
  sessionFactory=(SessionFactoryImplementor)metadataSources.buildMetadata().buildSessionFactory();
}
