{
  if (begun) {
    return;
  }
  if (commitFailed) {
    throw new TransactionException("cannot re-start transaction after failed commit");
  }
  LOG.begin();
  try {
    toggleAutoCommit=jdbcContext.connection().getAutoCommit();
    LOG.currentAutoCommitStatus(toggleAutoCommit);
    if (toggleAutoCommit) {
      LOG.disablingAutoCommit();
      jdbcContext.connection().setAutoCommit(false);
    }
  }
 catch (  SQLException e) {
    LOG.error(LOG.jdbcBeginFailed(),e);
    throw new TransactionException(LOG.jdbcBeginFailed(),e);
  }
  callback=jdbcContext.registerCallbackIfNecessary();
  begun=true;
  committed=false;
  rolledBack=false;
  if (timeout > 0) {
    jdbcContext.getConnectionManager().setTransactionTimeout(timeout);
  }
  jdbcContext.afterTransactionBegin(this);
}
