{
  if (!begun && !commitFailed) {
    throw new TransactionException("Transaction not successfully started");
  }
  LOG.debug("Rollback");
  if (!commitFailed) {
    try {
      rollbackAndResetAutoCommit();
      LOG.debug("Rolled back JDBC Connection");
      rolledBack=true;
      notifySynchronizationsAfterTransactionCompletion(Status.STATUS_ROLLEDBACK);
    }
 catch (    SQLException e) {
      LOG.error(LOG.jdbcRollbackFailed(),e);
      notifySynchronizationsAfterTransactionCompletion(Status.STATUS_UNKNOWN);
      throw new TransactionException(LOG.jdbcRollbackFailed(),e);
    }
 finally {
      if (callback) {
        jdbcContext.afterTransactionCompletion(false,this);
      }
      closeIfRequired();
    }
  }
}
