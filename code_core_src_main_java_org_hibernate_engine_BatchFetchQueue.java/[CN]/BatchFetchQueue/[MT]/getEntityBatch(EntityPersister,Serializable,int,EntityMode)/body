{
  Serializable[] ids=new Serializable[batchSize];
  ids[0]=id;
  int i=1;
  int end=-1;
  boolean checkForEnd=false;
  Iterator iter=batchLoadableEntityKeys.keySet().iterator();
  while (iter.hasNext()) {
    EntityKey key=(EntityKey)iter.next();
    if (key.getEntityName().equals(persister.getEntityName())) {
      if (checkForEnd && i == end) {
        return ids;
      }
      if (persister.getIdentifierType().isEqual(id,key.getIdentifier(),entityMode)) {
        end=i;
      }
 else {
        if (!isCached(key,persister,entityMode)) {
          ids[i++]=key.getIdentifier();
        }
      }
      if (i == batchSize) {
        i=1;
        if (end != -1)         checkForEnd=true;
      }
    }
  }
  return ids;
}
