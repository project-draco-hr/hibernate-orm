{
  EntityManager em=getOrCreateEntityManager();
  try {
    em.getTransaction().begin();
    NameInfo ni=new NameInfo("John","Doe");
    Person person1=new Person("JDOE",ni);
    em.persist(person1);
    em.getTransaction().commit();
    em.getTransaction().begin();
    person1=em.find(Person.class,person1.getId());
    person1.getNameInfo().setFirstName("Jane");
    em.merge(person1);
    em.getTransaction().commit();
    em.getTransaction().begin();
    person1=em.find(Person.class,person1.getId());
    person1.setName("JDOE2");
    em.merge(person1);
    em.getTransaction().commit();
    personId=person1.getId();
  }
  finally {
    em.close();
  }
}
