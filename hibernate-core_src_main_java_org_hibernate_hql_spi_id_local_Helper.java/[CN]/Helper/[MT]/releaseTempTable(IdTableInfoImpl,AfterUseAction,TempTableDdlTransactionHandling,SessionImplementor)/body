{
  if (afterUseAction == AfterUseAction.NONE) {
    return;
  }
  if (afterUseAction == AfterUseAction.DROP) {
    TemporaryTableDropWork work=new TemporaryTableDropWork(idTableInfo,session.getFactory());
    if (ddlTransactionHandling == TempTableDdlTransactionHandling.NONE) {
      final Connection connection=session.getTransactionCoordinator().getJdbcCoordinator().getLogicalConnection().getConnection();
      work.execute(connection);
      session.getTransactionCoordinator().getJdbcCoordinator().afterStatementExecution();
    }
 else {
      session.getTransactionCoordinator().getTransaction().createIsolationDelegate().delegateWork(work,ddlTransactionHandling == TempTableDdlTransactionHandling.ISOLATE_AND_TRANSACT);
    }
  }
  if (afterUseAction == AfterUseAction.CLEAN) {
    PreparedStatement ps=null;
    try {
      final String sql="delete from " + idTableInfo.getQualifiedIdTableName();
      ps=session.getTransactionCoordinator().getJdbcCoordinator().getStatementPreparer().prepareStatement(sql,false);
      session.getTransactionCoordinator().getJdbcCoordinator().getResultSetReturn().executeUpdate(ps);
    }
 catch (    Throwable t) {
      log.unableToCleanupTemporaryIdTable(t);
    }
 finally {
      if (ps != null) {
        try {
          session.getTransactionCoordinator().getJdbcCoordinator().release(ps);
        }
 catch (        Throwable ignore) {
        }
      }
    }
  }
}
