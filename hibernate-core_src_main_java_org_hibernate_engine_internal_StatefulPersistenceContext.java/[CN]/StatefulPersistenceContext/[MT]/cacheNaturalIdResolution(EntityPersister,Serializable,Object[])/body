{
  if (!persister.hasNaturalIdentifier()) {
    throw new IllegalArgumentException("Entity did not define a natural-id");
  }
  if (persister.getNaturalIdentifierProperties().length != naturalIdValues.length) {
    throw new IllegalArgumentException("Mismatch between expected number of natural-id values and found.");
  }
  NaturalIdResolutionCache entityNaturalIdResolutionCache=naturalIdResolutionCacheMap.get(persister);
  if (entityNaturalIdResolutionCache == null) {
    entityNaturalIdResolutionCache=new NaturalIdResolutionCache(persister);
    naturalIdResolutionCacheMap.put(persister,entityNaturalIdResolutionCache);
  }
  final NaturalId naturalId=new NaturalId(persister,naturalIdValues);
  entityNaturalIdResolutionCache.pkToNaturalIdMap.put(pk,naturalId);
  entityNaturalIdResolutionCache.naturalIdToPkMap.put(naturalId,pk);
}
