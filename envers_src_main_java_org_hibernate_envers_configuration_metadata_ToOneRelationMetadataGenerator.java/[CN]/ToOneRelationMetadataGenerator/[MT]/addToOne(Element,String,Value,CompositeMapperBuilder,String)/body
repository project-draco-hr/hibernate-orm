{
  String referencedEntityName=((ToOne)value).getReferencedEntityName();
  EntityConfiguration configuration=mainGenerator.getEntitiesConfigurations().get(referencedEntityName);
  if (configuration == null) {
    throw new MappingException("A versioned relation to a non-versioned entity " + referencedEntityName + "!");
  }
  IdMappingData idMapping=configuration.getIdMappingData();
  String lastPropertyPrefix=name + "_";
  IdMapper relMapper=idMapping.getIdMapper().prefixMappedProperties(lastPropertyPrefix);
  mainGenerator.getEntitiesConfigurations().get(entityName).addToOneRelation(name,referencedEntityName,relMapper);
  Element properties=(Element)idMapping.getXmlRelationMapping().clone();
  properties.addAttribute("name",name);
  MetadataTools.prefixNamesInPropertyElement(properties,lastPropertyPrefix,MetadataTools.getColumnNameIterator(value.getColumnIterator()),false);
  parent.add(properties);
  mapper.addComposite(name,new ToOneIdMapper(relMapper,name,referencedEntityName));
}
