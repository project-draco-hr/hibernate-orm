{
  log.debug("fetching initial value: " + sql);
  try {
    PreparedStatement st=session.getBatcher().prepareSelectStatement(sql);
    try {
      ResultSet rs=st.executeQuery();
      try {
        if (rs.next()) {
          next=rs.getLong(1) + 1;
          if (rs.wasNull())           next=1;
        }
 else {
          next=1;
        }
        sql=null;
        log.debug("first free id: " + next);
      }
  finally {
        rs.close();
      }
    }
  finally {
      session.getBatcher().closeStatement(st);
    }
  }
 catch (  SQLException sqle) {
    throw JDBCExceptionHelper.convert(session.getFactory().getSQLExceptionConverter(),sqle,"could not fetch initial value for increment generator",sql);
  }
}
