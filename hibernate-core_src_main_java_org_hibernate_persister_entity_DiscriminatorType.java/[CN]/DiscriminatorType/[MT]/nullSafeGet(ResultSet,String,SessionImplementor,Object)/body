{
  final Object discriminatorValue=underlyingType.nullSafeGet(rs,name,session,owner);
  final String entityName=persister.getSubclassForDiscriminatorValue(discriminatorValue);
  if (entityName == null) {
    throw new HibernateException("Unable to resolve discriminator value [" + discriminatorValue + "] to entity name");
  }
  final EntityPersister entityPersister=session.getEntityPersister(entityName,null);
  if (EntityMode.POJO == entityPersister.getEntityMode()) {
    return entityPersister.getMappedClass();
  }
 else {
    return entityName;
  }
}
