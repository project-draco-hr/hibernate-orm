{
  if (callback.getTenantIdentifier() == null) {
    if (noTenantState == null) {
      noTenantState=new GenerationState(callback,incrementSize);
    }
    return noTenantState;
  }
 else {
    GenerationState state;
    if (tenantSpecificState == null) {
      tenantSpecificState=new ConcurrentHashMap<String,GenerationState>();
      state=new GenerationState(callback,incrementSize);
      tenantSpecificState.put(callback.getTenantIdentifier(),state);
    }
 else {
      state=tenantSpecificState.get(callback.getTenantIdentifier());
      if (state == null) {
        state=new GenerationState(callback,incrementSize);
        tenantSpecificState.put(callback.getTenantIdentifier(),state);
      }
    }
    return state;
  }
}
